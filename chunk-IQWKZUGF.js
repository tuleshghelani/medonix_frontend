import{a as Ce,b as Ve}from"./chunk-R44KSHIC.js";import{b as Qe,c as ge,d as fe}from"./chunk-YS2PS6XL.js";import{$a as se,$b as U,A as Se,Bb as $,C as q,Cb as le,D as te,Da as D,Ea as Ie,Fb as R,Gb as de,H as b,Hb as me,I as v,Ia as I,Ib as G,Ka as F,La as re,Mb as Ae,Na as Fe,Nb as ue,Pb as Ne,Qa as ae,Qb as B,Ra as ie,Rb as Te,S as c,Sa as Q,Sb as N,T as g,Ta as V,Tb as qe,Va as oe,Vb as pe,Wa as ce,Wb as he,Ya as A,Zb as w,_ as f,_b as De,a as ve,aa as l,ca as y,e as xe,f as T,fa as r,ga as a,ha as d,ia as ke,j as Me,ja as we,ka as S,na as P,o as Z,oa as p,q as ye,ta as ne,u as _,ua as o,ub as z,uc as Y,va as x,vb as k,vc as K,wa as O,wb as L,x as Oe,xb as j,xc as H,y as ee,yb as Ee}from"./chunk-EXIQFNRY.js";var W=(()=>{class i{constructor(e){this.http=e,this.apiUrl=`${De.apiUrl}/api/purchase-challans`}searchPurchaseChallans(e){return this.http.post(`${this.apiUrl}/search`,e)}createPurchaseChallan(e){return this.http.post(`${this.apiUrl}/create`,e)}updatePurchaseChallan(e){return this.http.post(`${this.apiUrl}/create`,e)}deletePurchaseChallan(e){return this.http.delete(`${this.apiUrl}/${e}`)}getPurchaseChallanDetails(e){return this.http.post(`${this.apiUrl}/detail`,{id:e})}updateQcPass(e){return this.http.post(`${this.apiUrl}/update-qc-pass`,e)}generatePdf(e){return this.http.post(`${this.apiUrl}/generate-pdf`,{id:e},{responseType:"blob",observe:"response"}).pipe(Me(t=>{let s=t.headers.get("Content-Disposition")?.split("filename=")[1]?.replace(/"/g,"")||"purchase-challan.pdf";return{blob:new Blob([t.body],{type:"application/pdf"}),filename:s}}))}convertToPurchase(e){return this.http.post(`${this.apiUrl}/convert-to-purchase`,{challanId:e})}static{this.\u0275fac=function(t){return new(t||i)(Se(se))}}static{this.\u0275prov=Oe({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Ye=()=>({label:"All Customers",value:""});function Ke(i,u){if(i&1){let e=S();r(0,"div",5)(1,"div",22),d(2,"app-searchable-select",23),r(3,"button",24),P("click",function(){b(e);let n=p();return v(n.refreshCustomers())}),d(4,"i",25),a()()()}if(i&2){let e=p();c(2),l("options",e.customers)("defaultOption",Ie(5,Ye))("searchPlaceholder","Search customers..."),c(),l("disabled",e.isLoadingCustomers),c(),l("ngClass",e.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt")}}function He(i,u){if(i&1){let e=S();r(0,"button",26),P("click",function(){b(e);let n=p();return v(n.clearLocalStorage())}),o(1,"Add Purchase Challan"),a()}}function We(i,u){if(i&1){let e=S();r(0,"button",34),P("click",function(){b(e);let n=p().$implicit,s=p();return v(s.editPurchaseChallan(n.id))}),d(1,"i",35),a()}}function Je(i,u){if(i&1){let e=S();r(0,"button",36),P("click",function(){b(e);let n=p().$implicit,s=p();return v(s.generatePdf(n.id,n.invoiceNumber))}),d(1,"i",37),a()}}function Xe(i,u){if(i&1){let e=S();r(0,"button",38),P("click",function(){b(e);let n=p().$implicit,s=p();return v(s.convertToPurchase(n.id,n.invoiceNumber))}),d(1,"i",39),a()}if(i&2){let e=p(2);l("disabled",e.isLoading)}}function Ze(i,u){if(i&1){let e=S();r(0,"button",40),P("click",function(){b(e);let n=p().$implicit,s=p();return v(s.openQc(n.id))}),d(1,"i",41),a()}}function et(i,u){if(i&1){let e=S();r(0,"button",42),P("click",function(){b(e);let n=p().$implicit,s=p();return v(s.deletePurchaseChallan(n.id))}),d(1,"i",43),a()}}function tt(i,u){if(i&1&&(r(0,"tr")(1,"td"),o(2),a(),r(3,"td"),o(4),a(),r(5,"td"),o(6),a(),r(7,"td"),o(8),I(9,"date"),a(),r(10,"td"),o(11),a(),r(12,"td")(13,"span",27),o(14),a()(),r(15,"td",28),f(16,We,2,0,"button",29)(17,Je,2,0,"button",30)(18,Xe,2,1,"button",31)(19,Ze,2,0,"button",32)(20,et,2,0,"button",33),a()()),i&2){let e,t=u.$implicit,n=u.index,s=p();c(2),x(s.startIndex+n+1),c(2),x(t.invoiceNumber),c(2),x(t.customerName),c(2),x(F(9,15,t.challanDate,"dd-MM-yyyy")),c(3),x((e=t.totalChallanAmount)!==null&&e!==void 0?e:0),c(2),y("pass",t.isQcPass)("pending",!t.isQcPass),c(),O(" ",t.isQcPass?"Pass":"Pending"," "),c(2),l("ngIf",s.canManagePurchaseChallans),c(),l("ngIf",s.canManagePurchaseChallans),c(),l("ngIf",s.canManagePurchaseChallans),c(),l("ngIf",s.canManagePurchaseChallans),c(),l("ngIf",s.canManagePurchaseChallans)}}function nt(i,u){if(i&1){let e=S();r(0,"app-pagination",44),P("pageChange",function(n){b(e);let s=p();return v(s.onPageChange(n))})("pageSizeChange",function(n){b(e);let s=p();return v(s.onPageSizeChange(n))}),a()}if(i&2){let e=p();l("currentPage",e.currentPage)("pageSize",e.pageSize)("totalElements",e.totalElements)("pageSizeOptions",e.pageSizeOptions)}}var _e=(()=>{class i{constructor(e,t,n,s,m,C,h,M){this.purchaseChallanService=e,this.customerService=t,this.fb=n,this.snackbar=s,this.dateUtils=m,this.encryptionService=C,this.router=h,this.authService=M,this.purchaseChallans=[],this.isLoading=!1,this.currentPage=0,this.pageSize=10,this.pageSizeOptions=[5,10,25,50,100],this.totalPages=0,this.totalElements=0,this.startIndex=0,this.endIndex=0,this.products=[],this.isLoadingProducts=!1,this.customers=[],this.isLoadingCustomers=!1,this.canManagePurchaseChallans=!1,this.destroy$=new T,this.initializeForm()}ngOnInit(){this.canManagePurchaseChallans=this.authService.isAdmin()||this.authService.isStaffAdmin(),this.loadPurchaseChallans(),this.canManagePurchaseChallans&&this.loadCustomers()}initializeForm(){this.searchForm=this.fb.group({search:[""],customerId:[""],startDate:[""],endDate:[""],batchNumber:[""]})}loadPurchaseChallans(){this.isLoading=!0;let e=ve({currentPage:this.currentPage,perPageRecord:this.pageSize,startDate:this.searchForm.value.startDate?this.dateUtils.formatDate(this.searchForm.value.startDate):"",endDate:this.searchForm.value.endDate?this.dateUtils.formatDate(this.searchForm.value.endDate):""},this.searchForm.value);this.purchaseChallanService.searchPurchaseChallans(e).pipe(_(this.destroy$)).subscribe({next:t=>{this.purchaseChallans=t.content,this.totalPages=t.totalPages,this.totalElements=t.totalElements,this.startIndex=this.currentPage*this.pageSize,this.endIndex=Math.min((this.currentPage+1)*this.pageSize,this.totalElements),this.isLoading=!1},error:t=>{this.snackbar.error(t.message||"Failed to load purchase challans"),this.isLoading=!1}})}onSearch(){this.currentPage=0,this.loadPurchaseChallans()}onPageChange(e){this.currentPage=e,this.loadPurchaseChallans()}onPageSizeChange(e){this.pageSize=e,this.currentPage=0,this.loadPurchaseChallans()}deletePurchaseChallan(e){confirm("Are you sure you want to delete this purchase challan? This action cannot be undone.")&&(this.isLoading=!0,this.purchaseChallanService.deletePurchaseChallan(e).pipe(_(this.destroy$)).subscribe({next:()=>{this.snackbar.success("Purchase Challan deleted successfully"),this.loadPurchaseChallans()},error:t=>{this.snackbar.error(t?.error?.message||"Failed to delete purchase challan"),this.isLoading=!1}}))}loadCustomers(){this.canManagePurchaseChallans&&(this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(_(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data),this.isLoadingCustomers=!1},error:e=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}}))}refreshCustomers(){this.canManagePurchaseChallans&&(this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(_(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:e=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}}))}resetForm(){this.searchForm.reset(),this.currentPage=0,this.loadPurchaseChallans()}editPurchaseChallan(e){localStorage.setItem("purchaseChallanId",this.encryptionService.encrypt(e.toString())),this.router.navigate(["/purchase-challan/create"])}clearLocalStorage(){localStorage.removeItem("purchaseChallanId"),this.router.navigate(["/purchase-challan/create"])}openQc(e){let t=this.encryptionService.encrypt(e.toString());this.router.navigate(["/purchase-challan/qc",t])}generatePdf(e,t){this.purchaseChallanService.generatePdf(e).pipe(_(this.destroy$)).subscribe({next:({blob:n,filename:s})=>{let m="purchase-challan-"+(t?`${t}.pdf`:s),C=window.URL.createObjectURL(n),h=document.createElement("a");h.href=C,h.download=m,document.body.appendChild(h),h.click(),document.body.removeChild(h),window.URL.revokeObjectURL(C),this.snackbar.success("PDF downloaded successfully")},error:n=>{this.snackbar.error(n?.error?.message||"Failed to generate PDF")}})}convertToPurchase(e,t){confirm(`Are you sure you want to convert Purchase Challan ${t||e} to Purchase? This action cannot be undone.`)&&(this.isLoading=!0,this.purchaseChallanService.convertToPurchase(e).pipe(_(this.destroy$)).subscribe({next:n=>{n?.success?(this.snackbar.success(n.message||"Purchase Challan converted to Purchase successfully"),this.loadPurchaseChallans(),n?.data?.purchaseId&&(localStorage.setItem("purchaseId",this.encryptionService.encrypt(n.data.purchaseId.toString())),this.router.navigate(["/purchase/create"]))):(this.snackbar.error(n?.message||"Failed to convert purchase challan"),this.isLoading=!1)},error:n=>{this.snackbar.error(n?.error?.message||"Failed to convert purchase challan to purchase"),this.isLoading=!1}}))}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(t){return new(t||i)(g(W),g(Ce),g(B),g(Y),g(Ve),g(U),g(pe),g(Qe))}}static{this.\u0275cmp=q({type:i,selectors:[["app-purchase-challan"]],standalone:!0,features:[D],decls:47,vars:6,consts:[[1,"purchase-container"],[3,"show"],[1,"search-section","card"],[3,"ngSubmit","formGroup"],[1,"search-controls"],[1,"form-group"],["type","text","formControlName","search","placeholder","Search by challan number...",1,"form-control"],["type","text","formControlName","batchNumber","placeholder","Search by Batch Number...",1,"form-control"],["class","form-group",4,"ngIf"],["type","date","formControlName","startDate","placeholder","Start Date",1,"form-control"],["type","date","formControlName","endDate","placeholder","End Date",1,"form-control"],[1,"button-group"],["type","submit",1,"search-btn","btn","btn-sm","btn-primary"],[1,"fas","fa-search"],["type","button",1,"search-btn","btn","btn-sm","btn-secondary",3,"click"],[1,"fas","fa-undo"],["class","btn btn-sm btn-primary mb-2",3,"click",4,"ngIf"],[1,"purchases-list","card"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],[3,"currentPage","pageSize","totalElements","pageSizeOptions","pageChange","pageSizeChange",4,"ngIf"],[1,"product-select-group"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],[1,"fas",3,"ngClass"],[1,"btn","btn-sm","btn-primary","mb-2",3,"click"],[1,"status-chip"],[1,"actions"],["class","btn-icon edit","title","Edit Purchase Challan",3,"click",4,"ngIf"],["class","btn-icon pdf","title","Export PDF",3,"click",4,"ngIf"],["class","btn-icon convert","title","Convert to Purchase",3,"disabled","click",4,"ngIf"],["class","btn-icon qc","title","Purchase Challan QC",3,"click",4,"ngIf"],["class","btn-icon delete","title","Delete Purchase Challan",3,"click",4,"ngIf"],["title","Edit Purchase Challan",1,"btn-icon","edit",3,"click"],[1,"fas","fa-eye"],["title","Export PDF",1,"btn-icon","pdf",3,"click"],[1,"fas","fa-file-pdf"],["title","Convert to Purchase",1,"btn-icon","convert",3,"click","disabled"],[1,"fas","fa-exchange-alt"],["title","Purchase Challan QC",1,"btn-icon","qc",3,"click"],[1,"fas","fa-clipboard-check"],["title","Delete Purchase Challan",1,"btn-icon","delete",3,"click"],[1,"fas","fa-trash"],[3,"pageChange","pageSizeChange","currentPage","pageSize","totalElements","pageSizeOptions"]],template:function(t,n){t&1&&(r(0,"div",0),d(1,"app-loader",1),r(2,"div",2)(3,"h2"),o(4,"Search Purchase Challans"),a(),r(5,"form",3),P("ngSubmit",function(){return n.onSearch()}),r(6,"div",4)(7,"div",5),d(8,"input",6)(9,"input",7),a(),f(10,Ke,5,6,"div",8),r(11,"div",5),d(12,"input",9),a(),r(13,"div",5),d(14,"input",10),a(),r(15,"div",11)(16,"button",12),d(17,"i",13),o(18," Search "),a(),r(19,"button",14),P("click",function(){return n.resetForm()}),d(20,"i",15),o(21," Reset "),a()()()()(),f(22,He,2,0,"button",16),r(23,"div",17)(24,"h2"),o(25,"Purchase Challans"),a(),r(26,"div",18)(27,"table",19)(28,"thead")(29,"tr")(30,"th"),o(31,"No"),a(),r(32,"th"),o(33,"Challan No."),a(),r(34,"th"),o(35,"Customer Name"),a(),r(36,"th"),o(37,"Challan Date"),a(),r(38,"th"),o(39,"Total Challan Amount"),a(),r(40,"th"),o(41,"QC Status"),a(),r(42,"th"),o(43,"Actions"),a()()(),r(44,"tbody"),f(45,tt,21,18,"tr",20),a()()(),f(46,nt,1,4,"app-pagination",21),a()()),t&2&&(c(),l("show",n.isLoading),c(4),l("formGroup",n.searchForm),c(5),l("ngIf",n.canManagePurchaseChallans),c(12),l("ngIf",n.canManagePurchaseChallans),c(23),l("ngForOf",n.purchaseChallans),c(),l("ngIf",n.totalPages>0))},dependencies:[A,ie,Q,V,oe,N,$,z,L,j,R,G,Te,w,K,H,ge],styles:[".purchase-container[_ngcontent-%COMP%]{padding:2rem;position:relative;min-height:200px;background-color:var(--background)}.purchase-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fff;border-radius:0;box-shadow:0 2px 4px #0000001a;margin-bottom:20px;padding:20px}.purchase-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-primary);font-size:1.5rem}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;align-items:flex-start}@media (max-width: 768px){.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{grid-template-columns:1fr}}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin:0}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:40px}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{width:42px;padding:0;display:flex;align-items:center;justify-content:center;border:1px solid var(--border-color);border-radius:var(--border-radius);background:var(--primary)}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary)}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}@media (max-width: 768px){.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{grid-column:1/-1}}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;height:42px;display:flex;align-items:center;justify-content:center;gap:.5rem}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.purchase-container[_ngcontent-%COMP%]   .purchases-list[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.purchase-container[_ngcontent-%COMP%]   .purchases-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.purchase-container[_ngcontent-%COMP%]   .purchases-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-secondary);white-space:nowrap}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{width:auto;min-width:80px;padding:.5rem;margin-bottom:0}@media (max-width: 768px){.purchase-container[_ngcontent-%COMP%]{padding:1rem}.purchase-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.purchase-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .purchase-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (max-width: 576px){.table-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:flex-start}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{width:100%}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{flex:1}}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-start}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.actions[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]{color:var(--primary);background-color:#1458811a}.actions[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.actions[_ngcontent-%COMP%]   .btn-icon.pdf[_ngcontent-%COMP%]{color:#dc3545;background-color:#dc35451a}.actions[_ngcontent-%COMP%]   .btn-icon.pdf[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#dc3545;color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.pdf[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.actions[_ngcontent-%COMP%]   .btn-icon.convert[_ngcontent-%COMP%]{color:#9c27b0;background-color:#9c27b01a}.actions[_ngcontent-%COMP%]   .btn-icon.convert[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#9c27b0;color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.convert[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed;opacity:.6}.actions[_ngcontent-%COMP%]   .btn-icon.qc[_ngcontent-%COMP%]{color:#28a745;background-color:#28a7451a}.actions[_ngcontent-%COMP%]   .btn-icon.qc[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#28a745;color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.qc[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]{color:#dc3545;background-color:#dc35451a}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]:hover{background-color:#dc3545;color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:active{transform:translateY(0)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{padding:6px}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}}.status-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;padding:.25rem .75rem;border-radius:999px;font-size:.8rem;font-weight:600;letter-spacing:.02em;text-transform:uppercase;white-space:nowrap}.status-chip.pass[_ngcontent-%COMP%]{background-color:#28a74526;color:#28a745}.status-chip.pending[_ngcontent-%COMP%]{background-color:#ffc10726;color:#ffc107}  .custom-snackbar.success{background-color:var(--accent2)}  .custom-snackbar.error{background-color:#dc3545}  .custom-snackbar .snackbar-message{display:flex;align-items:center;gap:.5rem;color:#fff}  .custom-snackbar .snackbar-message i{font-size:1.2rem}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:var(--primary)}.product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:flex-start}.product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{background-color:var(--background);color:#fff;margin-top:3px;width:42px;height:42px;border-radius:6px;transition:all .2s ease}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:active{transform:translateY(0)}"]})}}return i})();function at(i,u){i&1&&(r(0,"div",45),o(1," Customer is required "),a())}function it(i,u){i&1&&(r(0,"div",45),o(1," Challan date is required "),a())}function ot(i,u){i&1&&(r(0,"div",45),o(1," Challan number is required "),a())}function ct(i,u){i&1&&(r(0,"div",45),o(1," Packaging and forwarding charges is required and must be 0 or greater "),a())}function st(i,u){i&1&&(r(0,"div",45),o(1," Please select a product "),a())}function lt(i,u){i&1&&(r(0,"div",45),o(1," Quantity must be 1 or greater "),a())}function dt(i,u){i&1&&(r(0,"div",45),o(1," Double quotes are not allowed "),a())}function mt(i,u){i&1&&(r(0,"div",45),o(1," Unit price must be greater than 0 "),a())}function ut(i,u){if(i&1){let e=S();r(0,"tr",46)(1,"td")(2,"div",47)(3,"div",14),d(4,"app-searchable-select",48),r(5,"button",49),P("click",function(){b(e);let n=p();return v(n.refreshProducts())}),d(6,"i",17),a()(),f(7,st,2,0,"div",18),a()(),r(8,"td")(9,"div",47),d(10,"input",50),f(11,lt,2,0,"div",18),a()(),r(12,"td")(13,"div",47),d(14,"input",51),f(15,dt,2,0,"div",18),a()(),r(16,"td")(17,"div",47)(18,"div",26),d(19,"input",52),a(),f(20,mt,2,0,"div",18),a()(),r(21,"td")(22,"div",26),d(23,"input",53),a()(),r(24,"td")(25,"div",26),d(26,"input",54),a()(),r(27,"td")(28,"div",47),d(29,"input",55),a()(),r(30,"td")(31,"button",56),P("click",function(){let n=b(e).index,s=p();return v(s.removeProduct(n))}),d(32,"i",57),a()()()}if(i&2){let e,t=u.index,n=p();l("formGroupName",t),c(4),y("is-invalid",n.isProductFieldInvalid(t,"productId")),l("focusWidthPx",600)("options",n.products)("placeholder","Select Product")("searchPlaceholder","Search products..."),c(),l("disabled",n.isLoadingProducts),c(),l("ngClass",n.isLoadingProducts?"fa-spinner fa-spin":"fa-sync-alt"),c(),l("ngIf",n.isProductFieldInvalid(t,"productId")),c(3),y("is-invalid",n.isProductFieldInvalid(t,"quantity")),c(),l("ngIf",n.isProductFieldInvalid(t,"quantity")),c(3),y("is-invalid",n.isProductFieldInvalid(t,"batchNumber")),c(),l("ngIf",(e=n.productsFormArray.at(t).get("batchNumber"))==null||e.errors==null?null:e.errors.doubleQuotes),c(4),y("is-invalid",n.isProductFieldInvalid(t,"unitPrice")),c(),l("ngIf",n.isProductFieldInvalid(t,"unitPrice")),c(3),l("value",n.getFormattedPrice(t)),c(3),l("value",n.getFormattedTaxAmount(t)),c(5),l("disabled",n.productsFormArray.length===1)}}function pt(i,u){i&1&&d(0,"app-loader")}var X=(()=>{class i{get productsFormArray(){return this.purchaseChallanForm.get("products")}trackByProductIndex(e,t){return t}constructor(e,t,n,s,m,C,h,M,E){this.fb=e,this.productService=t,this.customerService=n,this.purchaseChallanService=s,this.snackbar=m,this.http=C,this.router=h,this.encryptionService=M,this.cdr=E,this.products=[],this.customers=[],this.loading=!1,this.isLoadingProducts=!1,this.isLoadingCustomers=!1,this.isEdit=!1,this.destroy$=new T,this.productSubscriptions=[],this.productMap=new Map,this.totalAmount=0,this.totalTaxAmount=0,this.grandTotal=0,this.initForm()}ngOnInit(){this.loadProducts(),this.loadCustomers();let e=localStorage.getItem("purchaseChallanId");if(e){let t=this.encryptionService.decrypt(e);t&&this.fetchPurchaseChallanDetails(Number(t))}}ngOnDestroy(){this.productSubscriptions.forEach(e=>{e&&!e.closed&&e.unsubscribe()}),this.productSubscriptions=[],this.destroy$.next(),this.destroy$.complete(),this.products=[],this.customers=[],this.purchaseChallanForm.reset(),this.productMap.clear()}initForm(){this.purchaseChallanForm=this.fb.group({id:[null],customerId:["",k.required],challanDate:[ae(new Date,"yyyy-MM-dd","en"),k.required],invoiceNumber:["",k.required],packagingAndForwadingCharges:[0,[k.required,k.min(0)]],products:this.fb.array([])}),this.purchaseChallanForm.get("packagingAndForwadingCharges")?.valueChanges.pipe(_(this.destroy$),Z(300)).subscribe(()=>{this.calculateTotalAmount(),this.cdr.markForCheck()}),this.addProduct()}createProductFormGroup(){return this.fb.group({id:[null],productId:["",k.required],quantity:["",[k.required,k.min(1)]],batchNumber:["",[this.noDoubleQuotesValidator()]],unitPrice:["",[k.required,k.min(.01)]],price:[{value:0,disabled:!0}],taxPercentage:[{value:0,disabled:!0}],taxAmount:[{value:0,disabled:!0}],remarks:[null,[]]})}addProduct(){let e=this.createProductFormGroup(),t=this.setupProductCalculations(e);this.productSubscriptions.push(t),this.productsFormArray.push(e)}removeProduct(e){this.productsFormArray.length!==1&&(this.productSubscriptions[e]&&(this.productSubscriptions[e].unsubscribe(),this.productSubscriptions.splice(e,1)),this.productsFormArray.removeAt(e),this.calculateTotalAmount(),this.cdr.markForCheck())}buildProductMap(){this.productMap.clear();for(let e of this.products)this.productMap.set(e.id,e)}setupProductCalculations(e){let t=new xe,n=e.get("productId")?.valueChanges.pipe(_(this.destroy$),Z(150),ye()).subscribe(m=>{if(m){let C=this.productMap.get(m);if(C){let h=C.taxPercentage||0,M=C.purchaseAmount||0;e.patchValue({taxPercentage:h,unitPrice:M},{emitEvent:!1}),this.calculateProductPrice(e)}}});n&&t.add(n);let s=e.valueChanges.pipe(_(this.destroy$),Z(150)).subscribe(()=>{this.calculateProductPrice(e)});return t.add(s),t}calculateProductPrice(e){if(!e)return;let t=Number(e.get("quantity")?.value||0),n=Number(e.get("unitPrice")?.value||0),s=Number(e.get("taxPercentage")?.value||0),m=Number((t*n).toFixed(2)),C=Number((m*s/100).toFixed(2));e.patchValue({price:m,taxAmount:C},{emitEvent:!1}),this.calculateTotalAmount(),this.cdr.markForCheck()}getTotalAmount(){return this.productsFormArray.controls.reduce((e,t)=>e+(t.get("price").value||0),0)}getTotalTaxAmount(){return this.productsFormArray.controls.reduce((e,t)=>e+(t.get("taxAmount").value||0),0)}getGrandTotal(){let e=Number(this.purchaseChallanForm.get("packagingAndForwadingCharges")?.value||0);return this.getTotalAmount()+this.getTotalTaxAmount()+e}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(_(this.destroy$)).subscribe({next:e=>{e.success&&(this.products=e.data,this.buildProductMap()),this.isLoadingProducts=!1,this.cdr.markForCheck()},error:e=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1,this.cdr.markForCheck()}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(_(this.destroy$)).subscribe({next:e=>{e.success&&(this.products=e.data,this.buildProductMap(),this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1,this.cdr.markForCheck()},error:e=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1,this.cdr.markForCheck()}})}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(_(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data),this.isLoadingCustomers=!1,this.cdr.markForCheck()},error:e=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1,this.cdr.markForCheck()}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(_(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data),this.snackbar.success("Customers refreshed successfully"),this.isLoadingCustomers=!1,this.cdr.markForCheck()},error:e=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1,this.cdr.markForCheck()}})}isFieldInvalid(e){let t=this.purchaseChallanForm.get(e);return t?t.invalid&&t.touched:!1}isProductFieldInvalid(e,t){let n=this.productsFormArray.at(e).get(t);if(!n)return!1;if(n.invalid&&(n.dirty||n.touched)){let m=n.errors;if(m&&(m.required||m.min&&t==="quantity"||m.min&&t==="unitPrice"||m.min||m.max||m.min))return!0}return!1}resetForm(){this.isEdit=!1,this.purchaseChallanForm.patchValue({id:null}),this.initForm()}onSubmit(){if(this.markFormGroupTouched(this.purchaseChallanForm),this.purchaseChallanForm.valid){this.loading=!0;let e=this.preparePurchaseChallanData();(this.isEdit?this.purchaseChallanService.updatePurchaseChallan(e):this.purchaseChallanService.createPurchaseChallan(e)).pipe(_(this.destroy$)).subscribe({next:n=>{n?.success&&(this.snackbar.success(`Purchase Challan ${this.isEdit?"updated":"created"} successfully`),localStorage.removeItem("purchaseChallanId"),this.router.navigate(["/purchase-challan"])),this.loading=!1,this.cdr.markForCheck()},error:n=>{this.snackbar.error(n?.error?.message||`Failed to ${this.isEdit?"update":"create"} purchase challan`),this.loading=!1,this.cdr.markForCheck()}})}else{let e=document.querySelector(".is-invalid");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}}preparePurchaseChallanData(){let e=this.purchaseChallanForm.value,t={challanDate:ae(e.challanDate,"dd-MM-yyyy","en"),customerId:e.customerId,invoiceNumber:e.invoiceNumber,price:this.getTotalAmount(),taxAmount:this.getTotalTaxAmount(),packagingAndForwadingCharges:Number(e.packagingAndForwadingCharges||0),products:e.products.map((n,s)=>{let m=this.productsFormArray.at(s).get("id")?.value,C={productId:n.productId,quantity:n.quantity,batchNumber:n.batchNumber,unitPrice:n.unitPrice,price:this.productsFormArray.at(s).get("price")?.value,taxPercentage:this.productsFormArray.at(s).get("taxPercentage")?.value,taxAmount:this.productsFormArray.at(s).get("taxAmount")?.value,remarks:n.remarks};return this.isEdit&&m&&(C.id=m),C})};return this.isEdit&&e.id&&(t.id=e.id),t}markFormGroupTouched(e){Object.values(e.controls).forEach(t=>{t instanceof Ee||t instanceof Ne?this.markFormGroupTouched(t):(t.markAsTouched(),t.markAsDirty())})}calculateTotalAmount(){let e=this.productsFormArray.controls.reduce((s,m)=>s+(m.get("price").value||0),0),t=this.productsFormArray.controls.reduce((s,m)=>s+(m.get("taxAmount").value||0),0),n=Number(this.purchaseChallanForm.get("packagingAndForwadingCharges")?.value||0);this.totalAmount=e,this.totalTaxAmount=t,this.grandTotal=e+t+n,this.purchaseChallanForm.patchValue({price:e,taxAmount:t,totalAmount:this.grandTotal},{emitEvent:!1})}noDoubleQuotesValidator(){return e=>e.value&&e.value.includes('"')?{doubleQuotes:!0}:null}getFormattedPrice(e){let t=this.productsFormArray.at(e).get("price")?.value;return t?t.toFixed(2):"0.00"}getFormattedTaxAmount(e){let t=this.productsFormArray.at(e).get("taxAmount")?.value;return t?t.toFixed(2):"0.00"}fetchPurchaseChallanDetails(e){this.purchaseChallanService.getPurchaseChallanDetails(e).pipe(_(this.destroy$)).subscribe({next:t=>{t.id&&(this.isEdit=!0,this.populateForm(t))},error:t=>{this.snackbar.error(t?.error?.message||"Failed to load purchase challan details")}})}populateForm(e){this.productSubscriptions.forEach(t=>{t&&!t.closed&&t.unsubscribe()}),this.productSubscriptions=[],this.purchaseChallanForm.patchValue({customerId:e.customerId,id:e.id,challanDate:ae(new Date(e.challanDate),"yyyy-MM-dd","en"),invoiceNumber:e.invoiceNumber,packagingAndForwadingCharges:e.packagingAndForwadingCharges||0}),this.productsFormArray.clear(),e.items.forEach(t=>{let n=this.createProductFormGroup(),s=this.setupProductCalculations(n);this.productSubscriptions.push(s),n.patchValue({id:t.id,productId:t.productId,quantity:t.quantity,unitPrice:t.unitPrice,price:t.price,taxPercentage:t.taxPercentage,taxAmount:t.taxAmount,batchNumber:t.batchNumber,remarks:t.remarks},{emitEvent:!1}),this.productsFormArray.push(n)}),this.isEdit=!0}static{this.\u0275fac=function(t){return new(t||i)(g(B),g(fe),g(Ce),g(W),g(Y),g(se),g(pe),g(U),g(Fe))}}static{this.\u0275cmp=q({type:i,selectors:[["app-add-purchase-challan"]],standalone:!0,features:[D],decls:118,vars:42,consts:[[1,"add-purchase-container"],["routerLink","/purchase-challan",1,"btn","btn-sm","btn-secondary","back-btn"],[1,"fas","fa-arrow-left"],[1,"form-card"],[1,"card-header"],[1,"form-title"],[1,"fas","fa-file-invoice"],[1,"purchase-form",3,"ngSubmit","formGroup"],[1,"header-section"],[1,"form-row"],[1,"form-group"],["for","customerId"],[1,"fas","fa-user"],[1,"required"],[1,"select-group"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","placeholder","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",3,"click","disabled"],[1,"fas",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","challanDate"],[1,"fas","fa-calendar"],["type","date","id","challanDate","formControlName","challanDate",1,"form-control"],["for","invoiceNumber"],["type","text","id","invoiceNumber","formControlName","invoiceNumber",1,"form-control"],["for","packagingAndForwadingCharges"],[1,"fas","fa-box"],[1,"input-group"],[1,"input-group-text"],["type","number","id","packagingAndForwadingCharges","formControlName","packagingAndForwadingCharges","min","0","step","0.01","placeholder","Enter packaging and forwarding charges",1,"form-control"],["formArrayName","products",1,"products-section"],[1,"products-header"],[1,"fas","fa-boxes"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"table-responsive"],[1,"table","products-table"],[3,"formGroupName",4,"ngFor","ngForOf","ngForTrackBy"],[1,"purchase-summary"],[1,"summary-item"],[1,"summary-item","total"],[1,"form-actions"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click","disabled"],[1,"fas","fa-undo"],["type","submit",1,"btn","btn-sm","btn-primary",3,"disabled"],[4,"ngIf"],[1,"invalid-feedback"],[3,"formGroupName"],[1,"form-field-container"],["formControlName","productId","labelKey","name","valueKey","id",3,"focusWidthPx","options","placeholder","searchPlaceholder"],["type","button","title","Refresh Products",1,"btn","btn-sm","btn-primary","refresh",3,"click","disabled"],["type","number","formControlName","quantity","placeholder","Qty","min","1",1,"form-control"],["type","text","formControlName","batchNumber","placeholder","Batch Number",1,"form-control"],["type","number","formControlName","unitPrice","placeholder","Price","min","0.01","step","0.01",1,"form-control"],["type","number","formControlName","price","readonly","",1,"form-control",3,"value"],["type","number","formControlName","taxAmount","readonly","",1,"form-control",3,"value"],["type","text","formControlName","remarks","placeholder","Remarks",1,"form-control"],["type","button","title","Remove Product",1,"btn","btn-sm","btn-danger",3,"click","disabled"],[1,"fas","fa-trash"]],template:function(t,n){if(t&1&&(r(0,"div",0)(1,"button",1),d(2,"i",2),o(3," Back to Purchase Challans "),a(),r(4,"div",3)(5,"div",4)(6,"h2",5),d(7,"i",6),o(8," Add New Purchase Challan "),a()(),r(9,"form",7),P("ngSubmit",function(){return n.onSubmit()}),r(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),d(14,"i",12),o(15," Select Customer "),r(16,"span",13),o(17,"*"),a()(),r(18,"div",14),d(19,"app-searchable-select",15),r(20,"button",16),P("click",function(){return n.refreshCustomers()}),d(21,"i",17),a()(),f(22,at,2,0,"div",18),a(),r(23,"div",10)(24,"label",19),d(25,"i",20),o(26," Challan Date "),r(27,"span",13),o(28,"*"),a()(),d(29,"input",21),f(30,it,2,0,"div",18),a(),r(31,"div",10)(32,"label",22),d(33,"i",6),o(34," Challan Number "),r(35,"span",13),o(36,"*"),a()(),d(37,"input",23),f(38,ot,2,0,"div",18),a(),r(39,"div",10)(40,"label",24),d(41,"i",25),o(42," Packaging & Forwarding Charges "),r(43,"span",13),o(44,"*"),a()(),r(45,"div",26)(46,"span",27),o(47,"\u20B9"),a(),d(48,"input",28),a(),f(49,ct,2,0,"div",18),a()()(),r(50,"div",29)(51,"div",30)(52,"h3"),d(53,"i",31),o(54," Products"),a(),r(55,"button",32),P("click",function(){return n.addProduct()}),d(56,"i",33),o(57," Add Product "),a()(),r(58,"div",34)(59,"table",35)(60,"thead")(61,"tr")(62,"th"),o(63,"Product Name"),a(),r(64,"th"),o(65,"Quantity"),a(),r(66,"th"),o(67,"Batch Number"),a(),r(68,"th"),o(69,"Rate"),a(),r(70,"th"),o(71,"Price"),a(),r(72,"th"),o(73,"Tax Amount"),a(),r(74,"th"),o(75,"Remarks"),a(),r(76,"th"),o(77,"Actions"),a()()(),r(78,"tbody"),f(79,ut,33,22,"tr",36),a()()()(),r(80,"div",37)(81,"div",38)(82,"span"),o(83,"Total Products:"),a(),r(84,"strong"),o(85),a()(),r(86,"div",38)(87,"span"),o(88,"Total Price:"),a(),r(89,"strong"),o(90),I(91,"number"),a()(),r(92,"div",38)(93,"span"),o(94,"Total Tax Amount:"),a(),r(95,"strong"),o(96),I(97,"number"),a()(),r(98,"div",38)(99,"span"),o(100,"Packaging & Forwarding Charges:"),a(),r(101,"strong"),o(102),I(103,"number"),a()(),r(104,"div",39)(105,"span"),o(106,"Grand Total:"),a(),r(107,"strong"),o(108),I(109,"number"),a()()(),r(110,"div",40)(111,"button",41),P("click",function(){return n.resetForm()}),d(112,"i",42),o(113," Reset "),a(),r(114,"button",43),d(115,"i",17),o(116),a()()()()(),f(117,pt,1,0,"app-loader",44)),t&2){let s;c(9),l("formGroup",n.purchaseChallanForm),c(10),y("is-invalid",n.isFieldInvalid("customerId")),l("options",n.customers)("placeholder","Select Customer")("searchPlaceholder","Search customers..."),c(),l("disabled",n.isLoadingCustomers),c(),l("ngClass",n.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt"),c(),l("ngIf",n.isFieldInvalid("customerId")),c(7),y("is-invalid",n.isFieldInvalid("challanDate")),c(),l("ngIf",n.isFieldInvalid("challanDate")),c(7),y("is-invalid",n.isFieldInvalid("invoiceNumber")),c(),l("ngIf",n.isFieldInvalid("invoiceNumber")),c(10),y("is-invalid",n.isFieldInvalid("packagingAndForwadingCharges")),c(),l("ngIf",n.isFieldInvalid("packagingAndForwadingCharges")),c(30),l("ngForOf",n.productsFormArray.controls)("ngForTrackBy",n.trackByProductIndex),c(6),x(n.productsFormArray.length),c(5),O("\u20B9",F(91,30,n.totalAmount,"1.2-2"),""),c(6),O("\u20B9",F(97,33,n.totalTaxAmount,"1.2-2"),""),c(6),O("\u20B9",F(103,36,((s=n.purchaseChallanForm.get("packagingAndForwadingCharges"))==null?null:s.value)||0,"1.2-2"),""),c(6),O("\u20B9",F(109,39,n.grandTotal,"1.2-2"),""),c(3),l("disabled",n.loading),c(3),l("disabled",n.purchaseChallanForm.invalid||n.loading),c(),l("ngClass",n.loading?"fa-spinner fa-spin":"fa-save"),c(),O(" ",n.loading?"Saving...":"Save Purchase Challan"," "),c(),l("ngIf",n.loading)}},dependencies:[A,ie,Q,V,ce,N,$,z,le,L,j,ue,R,G,de,me,w,he,K,H],styles:[".add-purchase-container[_ngcontent-%COMP%]{padding:2rem;margin:0 auto}@media (max-width: 768px){.add-purchase-container[_ngcontent-%COMP%]{padding:1rem}}.select-group[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;gap:.5rem;width:100%;overflow:visible}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{display:block;flex:1;position:relative;z-index:100;overflow:visible}.select-group[_ngcontent-%COMP%]   app-searchable-select.custom-width[_ngcontent-%COMP%]{position:absolute;z-index:1000;left:0}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]:focus-within{z-index:1000;position:relative}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]:focus-within     .select-dropdown{z-index:1001!important;position:absolute!important}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]     .select-dropdown{z-index:1001!important;position:absolute!important}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{flex-shrink:0;margin-top:0;height:40px;min-width:40px;display:flex;align-items:center;justify-content:center;position:relative;z-index:1;border:1px solid var(--supporting);border-radius:8px;background:#fff;transition:all .3s ease;color:var(--primary);touch-action:manipulation}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary);color:#fff}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.form-control[_ngcontent-%COMP%]{height:40px}.back-btn[_ngcontent-%COMP%]{margin-bottom:1rem}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:var(--border-radius);box-shadow:var(--card-shadow);overflow:hidden}.card-header[_ngcontent-%COMP%]{background-color:var(--primary);padding:1.5rem}.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:1.5rem;font-weight:500;display:flex;align-items:center;gap:.5rem}.purchase-form[_ngcontent-%COMP%]{padding:2rem}@media (max-width: 768px){.purchase-form[_ngcontent-%COMP%]{padding:1rem}}.header-section[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-bottom:2rem;position:relative}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}@media (max-width: 768px){.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.products-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;border:1px solid var(--primary)}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.25rem;display:flex;align-items:center;gap:.5rem}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem;position:relative}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem;color:var(--text-primary);font-weight:500}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:var(--danger);margin-left:4px}.input-group[_ngcontent-%COMP%]{display:flex;align-items:stretch}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{background-color:var(--background);border:1px solid var(--border-color);border-right:none;border-radius:var(--border-radius) 0 0 var(--border-radius);height:38px;color:var(--text-secondary);min-width:40px;display:flex;align-items:center;justify-content:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:0 var(--border-radius) var(--border-radius) 0;flex:1}.purchase-summary[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;display:flex;justify-content:flex-end;gap:2rem;flex-wrap:wrap}.purchase-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.purchase-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.purchase-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-primary);font-size:1.25rem;font-weight:600}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}@media (max-width: 576px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}.table-responsive[_ngcontent-%COMP%]{margin:0 -1.5rem;padding:0 1.5rem;overflow-x:auto;min-height:400px;-webkit-overflow-scrolling:touch}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{margin:0 -1rem;padding:0 1rem}}.products-table[_ngcontent-%COMP%]{width:100%;margin-bottom:0;background:#fff;border-collapse:separate;border-spacing:0}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--background-light);color:var(--text-primary);font-weight:600;padding:1rem;white-space:nowrap;border-bottom:2px solid var(--border-color)}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{width:30%;min-width:300px}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4){width:10%;max-width:120px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;vertical-align:middle;border-bottom:1px solid var(--border-color)}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{min-width:80px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{width:30%;min-width:300px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child   .form-control[_ngcontent-%COMP%]{min-width:300px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4){width:10%;max-width:120px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(4)   .form-control[_ngcontent-%COMP%]{min-width:100px;max-width:120px}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex-wrap:nowrap}.products-table[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{margin:0 auto}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem}}.form-field-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;overflow:visible}.form-field-container[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%], .form-field-container[_ngcontent-%COMP%]   .input-group.is-invalid[_ngcontent-%COMP%]{border-color:var(--danger);background-image:url(data:image/svg+xml,...)}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-bottom:1.5rem;vertical-align:top}.invalid-feedback[_ngcontent-%COMP%]{color:var(--danger);font-size:.75rem;margin-top:.25rem;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}"],changeDetection:0})}}return i})();function ht(i,u){if(i&1&&(r(0,"div",14)(1,"div",15)(2,"span"),o(3,"Challan"),a(),r(4,"strong"),o(5),a()(),r(6,"div",15)(7,"span"),o(8,"Challan Date"),a(),r(9,"strong"),o(10),I(11,"date"),a()(),r(12,"div",15)(13,"span"),o(14,"Total Amount"),a(),r(15,"strong"),o(16),I(17,"number"),a()()()),i&2){let e=p();c(5),x(e.purchaseChallanDetails.invoiceNumber),c(5),x(F(11,3,e.purchaseChallanDetails.challanDate,"dd-MM-yyyy")),c(6),x(F(17,6,e.purchaseChallanDetails.totalAmount,"1.2-2"))}}function gt(i,u){if(i&1&&(r(0,"div",39),o(1),a()),i&2){let e,t=p().$implicit;c(),O(" QC pass must be between 0 and ",(e=t.get("quantity"))==null?null:e.value," ")}}function ft(i,u){i&1&&(r(0,"span",40),d(1,"i",41),a())}function Ct(i,u){if(i&1){let e=S();r(0,"tr",28)(1,"td"),o(2),a(),r(3,"td")(4,"div",29)(5,"div",30),o(6),a()()(),r(7,"td")(8,"span",31),o(9),a()(),r(10,"td")(11,"span",32),o(12),a()(),r(13,"td")(14,"div",33)(15,"input",34),P("blur",function(){let n=b(e).index,s=p(4);return v(s.onQcPassBlur(n))})("keydown",function(n){let s=b(e).index,m=p(4);return v(m.onQcPassKeydown(n,s))}),a(),f(16,gt,2,1,"div",35),a()(),r(17,"td")(18,"div",36),o(19),a()(),r(20,"td")(21,"div",37)(22,"span",21),o(23),a(),f(24,ft,2,0,"span",38),a()()()}if(i&2){let e,t,n,s,m,C,h=u.$implicit,M=u.index,E=p(4);l("formGroupName",M),c(2),x(M+1),c(4),O(" ",((e=h.get("productName"))==null?null:e.value)||"N/A"," "),c(3),x((t=h.get("quantity"))==null?null:t.value),c(3),x(((n=h.get("batchNumber"))==null?null:n.value)||"-"),c(3),l("max",(s=h.get("quantity"))==null?null:s.value),c(),l("ngIf",E.isQcPassInvalid(M)),c(3),O(" ",((m=h.get("remarks"))==null?null:m.value)||"-"," "),c(3),y("pass",E.isItemQcPassed(h))("pending",!E.isItemQcPassed(h)),c(),O(" ",E.isItemQcPassed(h)?"Pass":"Pending"," "),c(),l("ngIf",E.savingItemId===((C=h.get("challanItemId"))==null?null:C.value))}}function _t(i,u){if(i&1&&(r(0,"div",24)(1,"div",25)(2,"table",26)(3,"thead")(4,"tr")(5,"th"),o(6,"No"),a(),r(7,"th"),o(8,"Product Name"),a(),r(9,"th"),o(10,"Quantity"),a(),r(11,"th"),o(12,"Batch Number"),a(),r(13,"th"),o(14,"QC Pass"),a(),r(15,"th"),o(16,"Remarks"),a(),r(17,"th"),o(18,"Status"),a()()(),r(19,"tbody"),f(20,Ct,25,14,"tr",27),a()()()()),i&2){let e=p(3);c(20),l("ngForOf",e.itemsFormArray.controls)}}function Pt(i,u){i&1&&(r(0,"div",42),d(1,"i",43),r(2,"p"),o(3,"No items found for this purchase challan."),a()())}function bt(i,u){if(i&1){let e=S();r(0,"div",17)(1,"div",18)(2,"div",19)(3,"div",20)(4,"span"),o(5,"Total Items"),a(),r(6,"strong"),o(7),a()(),r(8,"div",20)(9,"span"),o(10,"QC Status"),a(),r(11,"span",21),o(12),a()()()(),r(13,"form",22),P("ngSubmit",function(n){b(e);let s=p(2);return v(s.onFormSubmit(n))}),f(14,_t,21,1,"div",23)(15,Pt,4,0,"ng-template",null,2,re),a()()}if(i&2){let e=ne(16),t=p(2);c(7),x(t.itemsFormArray.length),c(4),y("pass",t.isAllQcPassed)("pending",!t.isAllQcPassed),c(),O(" ",t.isAllQcPassed?"All Passed":"Pending"," "),c(),l("formGroup",t.qcForm),c(),l("ngIf",t.itemsFormArray.length>0)("ngIfElse",e)}}function vt(i,u){if(i&1&&(ke(0),f(1,bt,17,9,"div",16),we()),i&2){let e=p(),t=ne(17);c(),l("ngIf",e.purchaseChallanDetails)("ngIfElse",t)}}function xt(i,u){i&1&&(r(0,"div",44),d(1,"i",41),r(2,"span"),o(3,"Loading purchase challan details..."),a()())}function Mt(i,u){i&1&&(r(0,"div",42),d(1,"i",45),r(2,"p"),o(3,"Purchase challan details not available."),a()())}var Pe=(()=>{class i{constructor(e,t,n,s,m,C){this.fb=e,this.route=t,this.purchaseChallanService=n,this.productService=s,this.snackbar=m,this.encryptionService=C,this.isLoading=!1,this.isSaving=!1,this.products=[],this.savingItemId=null,this.destroy$=new T,this.qcForm=this.fb.group({items:this.fb.array([])})}get itemsFormArray(){return this.qcForm.get("items")}ngOnInit(){let e=this.route.snapshot.paramMap.get("id");if(!e){this.snackbar.error("Invalid purchase challan id");return}let t=this.encryptionService.decrypt(e),n=t?Number(t):NaN;if(!n||isNaN(n)){this.snackbar.error("Invalid purchase challan id");return}this.loadProducts(),this.loadPurchaseChallanDetails(n)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadProducts(){this.productService.getProducts({status:"A"}).pipe(_(this.destroy$)).subscribe({next:e=>{e?.success&&e.data&&(this.products=e.data.content||e.data),this.mapProductNames()},error:()=>{this.snackbar.error("Failed to load products")}})}loadPurchaseChallanDetails(e){this.isLoading=!0,this.purchaseChallanService.getPurchaseChallanDetails(e).pipe(_(this.destroy$)).subscribe({next:t=>{this.purchaseChallanDetails=t;let n=t.items||[];this.buildItemsForm(n),this.isLoading=!1},error:t=>{this.snackbar.error(t?.error?.message||"Failed to load purchase challan details"),this.isLoading=!1}})}buildItemsForm(e){this.itemsFormArray.clear(),e.forEach(t=>{let n=this.fb.group({challanItemId:[t.id],productId:[t.productId],productName:[null],quantity:[t.quantity],batchNumber:[t.batchNumber],qcPass:[t.qcPass,[k.min(0),k.max(t.quantity)]],remarks:[t.remarks]});this.itemsFormArray.push(n)}),this.mapProductNames()}mapProductNames(){!this.products||this.products.length===0||this.itemsFormArray.controls.forEach(e=>{let t=e.get("productId")?.value;if(t){let n=this.products.find(s=>s.id===t);n&&e.get("productName")?.setValue(n.name,{emitEvent:!1})}})}get isAllQcPassed(){return!this.itemsFormArray||this.itemsFormArray.length===0?!1:this.itemsFormArray.controls.every(e=>{let t=Number(e.get("quantity")?.value||0),s=e.get("qcPass")?.value;if(s===null||s==="")return!1;let m=Number(s);return!isNaN(m)&&m<=t})}isItemQcPassed(e){if(!e)return!1;let t=Number(e.get("quantity")?.value||0),s=e.get("qcPass")?.value;if(s===null||s==="")return!1;let m=Number(s);return!isNaN(m)&&m<=t}isQcPassInvalid(e){let t=this.itemsFormArray.at(e).get("qcPass");return!!(t&&t.invalid&&(t.dirty||t.touched))}onQcPassBlur(e){this.updateQcPass(e)}onQcPassKeydown(e,t){e.key==="Enter"&&(e.preventDefault(),this.updateQcPass(t))}onFormSubmit(e){e.preventDefault()}updateQcPass(e){let t=this.itemsFormArray.at(e),n=t.get("challanItemId")?.value,s=Number(t.get("quantity")?.value||0),m=t.get("qcPass"),C=m?.value;if(C===null||C==="")return;let h=Number(C);if(!n){this.snackbar.error("challanItemId is required");return}if(isNaN(h)||h<0){this.snackbar.error("QC pass quantity cannot be negative"),m?.setValue(0);return}if(h>s){this.snackbar.error("QC pass quantity cannot exceed ordered quantity"),m?.setValue(s);return}this.savingItemId!==n&&(this.isSaving=!0,this.savingItemId=n,this.purchaseChallanService.updateQcPass({challanItemId:n,qcPass:h}).pipe(_(this.destroy$)).subscribe({next:M=>{M?.success?this.snackbar.success(M.message||"QC pass updated successfully"):this.snackbar.error(M?.message||"Failed to update QC pass"),this.isSaving=!1,this.savingItemId=null},error:M=>{let E=M?.error?.message||"Failed to update QC pass";this.snackbar.error(E),this.isSaving=!1,this.savingItemId=null}}))}static{this.\u0275fac=function(t){return new(t||i)(g(B),g(qe),g(W),g(fe),g(Y),g(U))}}static{this.\u0275cmp=q({type:i,selectors:[["app-qc-purchase-challan"]],standalone:!0,features:[D],decls:18,vars:8,consts:[["loadingTpl",""],["emptyPurchaseTpl",""],["noItemsTpl",""],[1,"qc-purchase-container"],["routerLink","/purchase-challan",1,"btn","btn-sm","btn-secondary","back-btn"],[1,"fas","fa-arrow-left"],[1,"form-card"],[1,"card-header"],[1,"header-main"],[1,"form-title"],[1,"fas","fa-clipboard-check"],[1,"status-chip","header-status"],["class","purchase-meta",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"purchase-meta"],[1,"meta-item"],["class","qc-content",4,"ngIf","ngIfElse"],[1,"qc-content"],[1,"qc-summary"],[1,"summary-row"],[1,"summary-item"],[1,"status-chip"],["novalidate","",1,"qc-form",3,"ngSubmit","formGroup"],["class","products-section","formArrayName","items",4,"ngIf","ngIfElse"],["formArrayName","items",1,"products-section"],[1,"table-responsive"],[1,"table","products-table"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],[1,"product-cell"],[1,"product-name"],[1,"quantity"],[1,"batch"],[1,"form-field-container"],["type","number","formControlName","qcPass","min","0","step","0.01","inputmode","decimal",1,"form-control",3,"blur","keydown","max"],["class","invalid-feedback",4,"ngIf"],[1,"remarks-cell"],[1,"status-cell"],["class","saving-indicator",4,"ngIf"],[1,"invalid-feedback"],[1,"saving-indicator"],[1,"fas","fa-spinner","fa-spin"],[1,"empty-state"],[1,"fas","fa-box-open"],[1,"loading-state"],[1,"fas","fa-file-invoice"]],template:function(t,n){if(t&1&&(r(0,"div",3)(1,"button",4),d(2,"i",5),o(3," Back to Purchase Challans "),a(),r(4,"div",6)(5,"div",7)(6,"div",8)(7,"h2",9),d(8,"i",10),o(9," Purchase Challan QC "),a(),r(10,"span",11),o(11),a()(),f(12,ht,18,9,"div",12),a(),f(13,vt,2,2,"ng-container",13),a()(),f(14,xt,4,0,"ng-template",null,0,re)(16,Mt,4,0,"ng-template",null,1,re)),t&2){let s=ne(15);c(10),y("pass",n.isAllQcPassed)("pending",!n.isAllQcPassed),c(),O(" ",n.isAllQcPassed?"All Passed":"Pending"," "),c(),l("ngIf",n.purchaseChallanDetails),c(),l("ngIf",!n.isLoading)("ngIfElse",s)}},dependencies:[A,Q,V,ce,oe,N,$,z,le,L,j,ue,Ae,R,G,de,me,w,he],styles:[".qc-purchase-container[_ngcontent-%COMP%]{padding:2rem;margin:0 auto}@media (max-width: 768px){.qc-purchase-container[_ngcontent-%COMP%]{padding:1rem}}.back-btn[_ngcontent-%COMP%]{margin-bottom:1rem}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:var(--border-radius);box-shadow:var(--card-shadow);overflow:hidden}.card-header[_ngcontent-%COMP%]{background-color:var(--primary);padding:1.5rem;display:flex;flex-direction:column;gap:.75rem}.card-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:1rem}.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:1.5rem;font-weight:500;display:flex;align-items:center;gap:.5rem}.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.card-header[_ngcontent-%COMP%]   .purchase-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem}.card-header[_ngcontent-%COMP%]   .purchase-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.card-header[_ngcontent-%COMP%]   .purchase-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fffc;font-size:.85rem}.card-header[_ngcontent-%COMP%]   .purchase-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#fff;font-size:1rem}.qc-content[_ngcontent-%COMP%]{padding:1.5rem 2rem 2rem}@media (max-width: 768px){.qc-content[_ngcontent-%COMP%]{padding:1rem}}.qc-summary[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1rem 1.5rem;margin-bottom:1.5rem}.qc-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1.5rem;align-items:center}.qc-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.qc-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{color:var(--text-secondary);font-size:.9rem}.qc-summary[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-primary);font-size:1.1rem;font-weight:600}.status-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;padding:.25rem .75rem;border-radius:999px;font-size:.8rem;font-weight:600;letter-spacing:.02em;text-transform:uppercase}.status-chip.header-status[_ngcontent-%COMP%]{background-color:#ffffff26;color:#fff}.status-chip.pass[_ngcontent-%COMP%]{background-color:#28a74526;color:#28a745}.status-chip.pending[_ngcontent-%COMP%]{background-color:#ffc10726;color:#ffc107}.qc-form[_ngcontent-%COMP%]{width:100%}.products-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:var(--border-radius);padding:1.5rem 1.5rem 1rem;border:1px solid var(--primary)}.table-responsive[_ngcontent-%COMP%]{margin:0 -1.5rem;padding:0 1.5rem;overflow-x:auto;min-height:300px;-webkit-overflow-scrolling:touch}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{margin:0 -1rem;padding:0 1rem}}.products-table[_ngcontent-%COMP%]{width:100%;margin-bottom:0;background:#fff;border-collapse:separate;border-spacing:0}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--background-light);color:var(--text-primary);font-weight:600;padding:.75rem 1rem;white-space:nowrap;border-bottom:2px solid var(--border-color)}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;vertical-align:middle;border-bottom:1px solid var(--border-color)}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{white-space:nowrap;width:1%}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem}}.product-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.15rem}.product-cell[_ngcontent-%COMP%]   .product-name[_ngcontent-%COMP%]{font-weight:500;color:var(--text-primary)}.product-cell[_ngcontent-%COMP%]   .product-id[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary)}.quantity[_ngcontent-%COMP%], .batch[_ngcontent-%COMP%]{font-weight:500;color:var(--text-primary)}.remarks-cell[_ngcontent-%COMP%]{max-width:220px;font-size:.9rem;color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.form-field-container[_ngcontent-%COMP%]{position:relative}.form-field-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:40px;min-width:120px}.form-field-container[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%]{color:var(--danger);font-size:.75rem;margin-top:.25rem}.status-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.status-cell[_ngcontent-%COMP%]   .saving-indicator[_ngcontent-%COMP%]{color:var(--primary);font-size:.9rem}.loading-state[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{padding:2rem;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.75rem;color:var(--text-secondary);text-align:center}.loading-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:var(--primary)}@media (max-width: 576px){.card-header[_ngcontent-%COMP%]{padding:1.25rem}.card-header[_ngcontent-%COMP%]   .header-main[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.5rem}.products-section[_ngcontent-%COMP%]{padding:1rem 1rem .75rem}.form-field-container[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{min-width:100px}}"]})}}return i})();var yt=[{path:"",component:_e},{path:"create",component:X},{path:"edit/:id",component:X},{path:"qc/:id",component:Pe}],Ge=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=te({type:i})}static{this.\u0275inj=ee({imports:[w.forChild(yt),w]})}}return i})();var hn=(()=>{class i{static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=te({type:i})}static{this.\u0275inj=ee({imports:[A,N,w,Ge,K,H,ge,_e,X,Pe]})}}return i})();export{hn as PurchaseChallanModule};
