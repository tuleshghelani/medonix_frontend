import{$a as y,$b as v,A as p,Aa as V,Ab as Q,Ba as L,C as N,Cb as X,Da as U,H as R,I as z,Jb as Z,Kb as ee,L as k,La as K,Lb as te,Mb as ne,Nb as ie,Rb as oe,S as a,Sa as G,Ta as Y,Vb as ae,Ya as B,_ as O,_a as W,_b as _,aa as s,ca as D,fa as r,g as M,ga as c,h as I,ha as f,i as S,ia as E,ja as T,ka as j,n as A,na as l,oa as P,ta as F,ua as d,ub as q,v as m,wa as w,wb as J,wc as re,x as b,ya as $,za as H}from"./chunk-LKYSYCMW.js";function se(i,h){if(i&1&&(r(0,"option",19),d(1),c()),i&2){let e=h.$implicit;s("value",e),a(),w(" ",e," ")}}function ge(i,h){if(i&1){let e=j();E(0),r(1,"button",21),l("click",function(){R(e);let t=P().$implicit,o=P();return z(o.loadPage(t-1))}),d(2),c(),T()}if(i&2){let e=P().$implicit,n=P();a(),D("active",e===n.currentPage+1),a(),w(" ",e," ")}}function le(i,h){i&1&&(r(0,"span",22),d(1,"..."),c())}function pe(i,h){if(i&1&&(E(0),O(1,ge,3,3,"ng-container",20)(2,le,2,0,"ng-template",null,0,K),T()),i&2){let e=h.$implicit,n=F(3);a(),s("ngIf",e!==-1)("ngIfElse",n)}}var be=(()=>{class i{constructor(){this.currentPage=0,this.pageSize=5,this.totalElements=0,this.pageSizeOptions=[5,10,50,100],this.pageChange=new k,this.pageSizeChange=new k,this.goToPageInput=""}get totalPages(){return Math.ceil(this.totalElements/this.pageSize)}get startIndex(){return this.currentPage*this.pageSize}get endIndex(){return Math.min(this.startIndex+this.pageSize,this.totalElements)}onPageSizeChange(e){this.pageSizeChange.emit(e)}loadPage(e){e>=0&&e<this.totalPages&&this.pageChange.emit(e)}getVisiblePages(){let e=this.totalPages,n=this.currentPage+1,t=[],o=2,g=Math.max(n-o,1),C=Math.min(n+o,e);C-g+1<5&&(n<e-o?C=Math.min(g+4,e):g=Math.max(C-4,1));for(let x=g;x<=C;x++)t.push(x);return t}goToPage(){let e=parseInt(this.goToPageInput,10);!isNaN(e)&&e>0&&e<=this.totalPages&&(this.loadPage(e-1),this.goToPageInput="")}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=N({type:i,selectors:[["app-pagination"]],inputs:{currentPage:"currentPage",pageSize:"pageSize",totalElements:"totalElements",pageSizeOptions:"pageSizeOptions"},outputs:{pageChange:"pageChange",pageSizeChange:"pageSizeChange"},standalone:!0,features:[U],decls:22,vars:13,consts:[["ellipsis",""],[1,"pagination-container"],[1,"page-size-selector"],[1,"form-control","mb-0","text-center",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"pagination-info"],[1,"pagination"],["title","First Page",1,"btn-page",3,"click","disabled"],[1,"fas","fa-angle-double-left"],["title","Previous Page",1,"btn-page",3,"click","disabled"],[1,"fas","fa-angle-left"],[4,"ngFor","ngForOf"],["title","Next Page",1,"btn-page",3,"click","disabled"],[1,"fas","fa-angle-right"],["title","Last Page",1,"btn-page",3,"click","disabled"],[1,"fas","fa-angle-double-right"],[1,"go-to-page"],["type","number","placeholder","Page","min","1",1,"form-control","mb-0","text-center",3,"ngModelChange","keyup.enter","ngModel","max"],["title","Go to page",1,"btn-page",3,"click","disabled"],[3,"value"],[4,"ngIf","ngIfElse"],[1,"btn-page",3,"click"],[1,"ellipsis"]],template:function(n,t){n&1&&(r(0,"div",1)(1,"div",2)(2,"label"),d(3,"Show entries:"),c(),r(4,"select",3),l("ngModelChange",function(g){return t.onPageSizeChange(g)}),O(5,se,2,2,"option",4),c()(),r(6,"div",5),d(7),c(),r(8,"div",6)(9,"button",7),l("click",function(){return t.loadPage(0)}),f(10,"i",8),c(),r(11,"button",9),l("click",function(){return t.loadPage(t.currentPage-1)}),f(12,"i",10),c(),O(13,pe,4,2,"ng-container",11),r(14,"button",12),l("click",function(){return t.loadPage(t.currentPage+1)}),f(15,"i",13),c(),r(16,"button",14),l("click",function(){return t.loadPage(t.totalPages-1)}),f(17,"i",15),c(),r(18,"div",16)(19,"input",17),L("ngModelChange",function(g){return V(t.goToPageInput,g)||(t.goToPageInput=g),g}),l("keyup.enter",function(){return t.goToPage()}),c(),r(20,"button",18),l("click",function(){return t.goToPage()}),d(21," Go "),c()()()()),n&2&&(a(4),s("ngModel",t.pageSize),a(),s("ngForOf",t.pageSizeOptions),a(2),$(" Showing ",t.startIndex+1," to ",t.endIndex," of ",t.totalElements," entries "),a(2),s("disabled",t.currentPage===0),a(2),s("disabled",t.currentPage===0),a(2),s("ngForOf",t.getVisiblePages()),a(),s("disabled",t.currentPage===t.totalPages-1),a(2),s("disabled",t.currentPage===t.totalPages-1),a(3),H("ngModel",t.goToPageInput),s("max",t.totalPages),a(),s("disabled",!t.goToPageInput))},dependencies:[B,G,Y,oe,ee,te,q,X,Z,J,ie,ne,Q],styles:[".pagination-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-start;gap:.5rem;padding:1rem 0;border-top:1px solid var(--supporting);flex-wrap:nowrap}.pagination-container[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;height:32px;flex-shrink:0}.pagination-container[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{white-space:nowrap;margin-bottom:0;color:var(--text-secondary)}.pagination-container[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{width:auto;min-width:80px;height:32px;padding:.375rem .75rem;border:1px solid var(--supporting);border-radius:4px;background-color:#fff;color:var(--text-primary)}.pagination-container[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none;box-shadow:0 0 0 2px rgba(var(--primary-rgb),.25)}.pagination-container[_ngcontent-%COMP%]   .pagination-info[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.9rem;white-space:nowrap;flex-shrink:0}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;margin-left:auto;flex-shrink:0}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .btn-page[_ngcontent-%COMP%]{min-width:32px;height:32px;padding:0 8px;border:1px solid var(--supporting);background:#fff;color:var(--text-primary);cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:4px;transition:all .2s ease}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .btn-page[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--background);border-color:var(--primary);color:var(--primary)}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .btn-page[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .btn-page.active[_ngcontent-%COMP%]{background-color:var(--primary);border-color:var(--primary);color:#fff}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .btn-page[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .ellipsis[_ngcontent-%COMP%]{padding:6px 12px;color:var(--text-secondary);display:flex;align-items:center}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .go-to-page[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-left:.5rem;height:32px;flex-shrink:0}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .go-to-page[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:70px;padding:3px .75rem;border:1px solid var(--supporting);border-radius:4px;color:var(--text-primary)}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .go-to-page[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:var(--primary);outline:none;box-shadow:0 0 0 2px rgba(var(--primary-rgb),.25)}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .go-to-page[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-inner-spin-button, .pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .go-to-page[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .go-to-page[_ngcontent-%COMP%]   .btn-page[_ngcontent-%COMP%]{min-width:40px;height:32px}@media (max-width: 1200px){.pagination-container[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center;gap:1rem}.pagination-container[_ngcontent-%COMP%]   .pagination-info[_ngcontent-%COMP%]{order:-1;width:100%;text-align:center}.pagination-container[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{order:1}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]{order:2;margin-left:0}}@media (max-width: 768px){.pagination-container[_ngcontent-%COMP%]{flex-direction:column;align-items:center;gap:15px}.pagination-container[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%], .pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]{width:100%;justify-content:center}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]{flex-wrap:wrap;row-gap:.5rem}.pagination-container[_ngcontent-%COMP%]   .pagination[_ngcontent-%COMP%]   .go-to-page[_ngcontent-%COMP%]{margin-left:0}}"]})}}return i})();var u=function(i){return i.ADMIN="ADMIN",i.STAFF_ADMIN="STAFF_ADMIN",i.DISPATCH="DISPATCH",i.SALES_AND_MARKETING="SALES_AND_MARKETING",i.DEALER="DEALER",i.HR="HR",i.REPORTER="REPORTER",i}(u||{}),ke=(()=>{class i{constructor(e,n,t){this.http=e,this.encryptionService=n,this.router=t,this.authStateSubject=new M(this.isAuthenticated()),this.authState$=this.authStateSubject.asObservable(),this.refreshTokenInProgress=!1}login(e){return this.http.post(`${_.apiUrl}/api/auth/login`,e).pipe(m(n=>{localStorage.setItem("token",n.accessToken),localStorage.setItem("user",JSON.stringify({firstName:n.firstName,lastName:n.lastName,email:n.email}));let t=this.encryptionService.encrypt(n.refreshToken);localStorage.setItem("refreshToken",t);let o=this.encryptionService.encrypt(n.roles);localStorage.setItem("userRoles",o),this.authStateSubject.next(!0)}))}hasAnyRole(e){let n=this.getUserRoles();return e.some(t=>n.includes(t))}refreshToken(){if(this.refreshTokenInProgress)return S(()=>new Error("Refresh token request in progress"));this.refreshTokenInProgress=!0;let e=localStorage.getItem("refreshToken");if(!e)return this.handleAuthError(),S(()=>new Error("No refresh token available"));let n=this.encryptionService.decrypt(e);return this.http.post(`${_.apiUrl}/api/refresh-token/new`,{refreshToken:n},{headers:{}}).pipe(m(t=>{if(t.success){localStorage.setItem("token",t.data.token);let o=this.encryptionService.encrypt(t.data.refreshToken);localStorage.setItem("refreshToken",o)}this.refreshTokenInProgress=!1}),A(t=>(this.refreshTokenInProgress=!1,t.status===400&&this.handleAuthError(),S(()=>t))))}handleAuthError(){this.logout(),window.location.href=window.location.origin+"/login?_t="+new Date().getTime()}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("refreshToken"),localStorage.clear(),this.authStateSubject.next(!1)}isAuthenticated(){return!!localStorage.getItem("token")}getToken(){return localStorage.getItem("token")}getUserRoles(){let e=localStorage.getItem("userRoles");return e?this.encryptionService.decrypt(e).replace("[","").replace("]","").split(",").map(t=>t.trim()):[]}hasRole(e){return this.getUserRoles().includes(e)}isAdmin(){return this.hasRole("ADMIN")}isProductManager(){return this.hasRole("STAFF_ADMIN")}isStaffAdmin(){return this.hasRole(u.STAFF_ADMIN)}getDefaultRoute(){let e=this.getUserRoles();return e.includes(u.ADMIN)||e.includes(u.STAFF_ADMIN)||e.includes(u.SALES_AND_MARKETING)?"/category":e.includes(u.HR)?"/employee":e.includes(u.DISPATCH)?"/category":e.includes(u.DEALER)?"/purchase":"/login"}static{this.\u0275fac=function(n){return new(n||i)(p(y),p(v),p(ae))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Re=(()=>{class i{constructor(e,n,t){this.http=e,this.cacheService=n,this.encryptionService=t,this.CACHE_KEY="active_products",this.apiUrl=`${_.apiUrl}/api/products`,this.cachedProducts=null,this.productsSubject=new M([]),this.products$=this.productsSubject.asObservable()}searchProducts(e){return this.http.post(`${this.apiUrl}/search`,e)}getProducts(e){if(e.status==="A"){if(this.cachedProducts)return I({success:!0,data:this.cachedProducts});let n=localStorage.getItem(this.CACHE_KEY);if(n){let t=this.encryptionService.decrypt(n);if(t&&t.data)return this.cachedProducts=t.data,this.productsSubject.next(this.cachedProducts),I(t)}}return this.http.post(`${this.apiUrl}/getProducts`,{search:e.search,hsnCode:e.hsnCode,productCode:e.productCode,materialName:e.materialName,categoryId:e.categoryId,status:e.status}).pipe(m(n=>{if(e.status==="A"&&n.success){this.cachedProducts=n.data,this.productsSubject.next(this.cachedProducts);let t=this.encryptionService.encrypt(n);localStorage.setItem(this.CACHE_KEY,t)}}))}refreshProducts(){return this.cachedProducts=null,localStorage.removeItem(this.CACHE_KEY),this.getProducts({status:"A"})}createProduct(e){return this.http.post(`${this.apiUrl}`,e)}updateProduct(e,n){return this.http.put(`${this.apiUrl}/${e}`,n)}deleteProduct(e){return this.http.delete(`${this.apiUrl}/${e}`)}exportProducts(e){let n=new W({Accept:"application/pdf"});return this.http.post(`${this.apiUrl}/export-pdf`,e,{headers:n,responseType:"blob"})}static{this.\u0275fac=function(n){return new(n||i)(p(y),p(re),p(v))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{u as a,ke as b,be as c,Re as d};
