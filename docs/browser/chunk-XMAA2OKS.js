import{a as ze}from"./chunk-OKT5BBT6.js";import{b as De,c as pe,d as me}from"./chunk-CFF6OH4N.js";import{$ as xe,$a as ce,$b as K,A as ve,Bb as q,C as D,Cb as Fe,D as oe,Da as L,Ea as ee,Fb as R,Gb as Ee,H as P,Hb as Ae,I as C,Ia as I,Ib as B,Ka as k,Nb as Te,P as ye,Pb as Ne,Qa as ae,Qb as U,Ra as z,Rb as le,S as c,Sa as j,Sb as T,T as O,Ta as $,Va as Se,Vb as Y,Wa as se,Wb as Ve,Ya as A,Zb as F,_ as y,_b as ue,a as ne,aa as l,b as be,ca as w,e as Pe,f as V,fa as n,fb as Ie,ga as i,ha as u,hb as ke,j as Ce,ka as x,na as _,oa as m,u as v,ua as a,ub as de,uc as H,va as M,vb as E,vc as W,wa as S,wb as G,x as Oe,xb as Q,xc as N,y as ie,ya as Me,yb as we,yc as J,zc as Le}from"./chunk-5AXVVETM.js";var X=(()=>{class s{constructor(e){this.http=e,this.apiUrl=`${ue.apiUrl}/api/purchase-orders`}searchPurchaseOrders(e){return this.http.post(`${this.apiUrl}/search`,e)}createPurchaseOrder(e){return this.http.post(`${this.apiUrl}/create`,e)}updatePurchaseOrder(e){return this.http.post(`${this.apiUrl}/create`,e)}deletePurchaseOrder(e){return this.http.delete(`${this.apiUrl}/${e}`)}getPurchaseOrderDetails(e){return this.http.post(`${this.apiUrl}/detail`,{id:e})}generatePdf(e){return this.http.post(`${this.apiUrl}/generate-pdf`,{id:e},{responseType:"blob",observe:"response"}).pipe(Ce(r=>{let o=r.headers.get("Content-Disposition")?.split("filename=")[1]?.replace(/"/g,"")||"purchase-order.pdf";return{blob:new Blob([r.body],{type:"application/pdf"}),filename:o}}))}convertToPurchase(e){return this.http.post(`${this.apiUrl}/convert-to-purchase`,e)}updatePurchaseOrderItemGetQuantity(e){return this.http.put(`${ue.apiUrl}/api/purchase-order-items/update-get-quantity`,e)}searchPendingPurchaseOrderItems(e){return this.http.post(`${ue.apiUrl}/api/purchase-order-items/pending-item/search`,e)}static{this.\u0275fac=function(r){return new(r||s)(ve(ce))}}static{this.\u0275prov=Oe({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var Ye=()=>({label:"All Customers",value:""});function Ke(s,f){if(s&1){let e=x();n(0,"div",5)(1,"div",22),u(2,"app-searchable-select",23),n(3,"button",24),_("click",function(){P(e);let t=m();return C(t.refreshCustomers())})("touchstart",function(t){return P(e),C(t.preventDefault())}),u(4,"i",25),i()()()}if(s&2){let e=m();c(2),l("options",e.customers)("defaultOption",ee(5,Ye))("searchPlaceholder","Search customers..."),c(),l("disabled",e.isLoadingCustomers),c(),l("ngClass",e.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt")}}function He(s,f){if(s&1){let e=x();n(0,"button",30),_("click",function(){P(e);let t=m().$implicit,o=m();return C(o.editPurchaseOrder(t.id))})("touchstart",function(t){return P(e),C(t.preventDefault())}),u(1,"i",31),i()}}function We(s,f){if(s&1){let e=x();n(0,"button",32),_("click",function(){P(e);let t=m().$implicit,o=m();return C(o.generatePdf(t.id,t.invoiceNumber))})("touchstart",function(t){return P(e),C(t.preventDefault())}),u(1,"i",33),i()}}function Je(s,f){if(s&1){let e=x();n(0,"button",34),_("click",function(){P(e);let t=m().$implicit,o=m();return C(o.deletePurchaseOrder(t.id))})("touchstart",function(t){return P(e),C(t.preventDefault())}),u(1,"i",35),i()}}function Xe(s,f){if(s&1&&(n(0,"tr")(1,"td"),a(2),i(),n(3,"td"),a(4),i(),n(5,"td"),a(6),i(),n(7,"td"),a(8),I(9,"date"),i(),n(10,"td"),a(11),i(),n(12,"td",26),y(13,He,2,0,"button",27)(14,We,2,0,"button",28)(15,Je,2,0,"button",29),i()()),s&2){let e,r=f.$implicit,t=f.index,o=m();c(2),M(o.startIndex+t+1),c(2),M(r.invoiceNumber),c(2),M(r.customerName),c(2),M(k(9,8,r.orderDate,"dd-MM-yyyy")),c(3),M((e=r.totalOrderAmount)!==null&&e!==void 0?e:0),c(2),l("ngIf",o.canManagePurchaseOrders),c(),l("ngIf",o.canManagePurchaseOrders),c(),l("ngIf",o.canManagePurchaseOrders)}}function Ze(s,f){if(s&1){let e=x();n(0,"app-pagination",36),_("pageChange",function(t){P(e);let o=m();return C(o.onPageChange(t))})("pageSizeChange",function(t){P(e);let o=m();return C(o.onPageSizeChange(t))}),i()}if(s&2){let e=m();l("currentPage",e.currentPage)("pageSize",e.pageSize)("totalElements",e.totalElements)("pageSizeOptions",e.pageSizeOptions)}}var ge=(()=>{class s{constructor(e,r,t,o,d,h,g,b){this.purchaseOrderService=e,this.customerService=r,this.fb=t,this.snackbar=o,this.dateUtils=d,this.encryptionService=h,this.router=g,this.authService=b,this.purchaseOrders=[],this.isLoading=!1,this.currentPage=0,this.pageSize=10,this.pageSizeOptions=[5,10,25,50,100],this.totalPages=0,this.totalElements=0,this.startIndex=0,this.endIndex=0,this.products=[],this.isLoadingProducts=!1,this.customers=[],this.isLoadingCustomers=!1,this.canManagePurchaseOrders=!1,this.destroy$=new V,this.initializeForm()}ngOnInit(){this.canManagePurchaseOrders=this.authService.isAdmin()||this.authService.isStaffAdmin(),this.loadPurchaseOrders(),this.canManagePurchaseOrders&&this.loadCustomers()}initializeForm(){this.searchForm=this.fb.group({search:[""],customerId:[""],startDate:[""],endDate:[""],batchNumber:[""]})}loadPurchaseOrders(){this.isLoading=!0;let e=ne({currentPage:this.currentPage,perPageRecord:this.pageSize,startDate:this.searchForm.value.startDate?this.dateUtils.formatDate(this.searchForm.value.startDate):"",endDate:this.searchForm.value.endDate?this.dateUtils.formatDate(this.searchForm.value.endDate):""},this.searchForm.value);this.purchaseOrderService.searchPurchaseOrders(e).pipe(v(this.destroy$)).subscribe({next:r=>{this.purchaseOrders=r.content,this.totalPages=r.totalPages,this.totalElements=r.totalElements,this.startIndex=this.currentPage*this.pageSize,this.endIndex=Math.min((this.currentPage+1)*this.pageSize,this.totalElements),this.isLoading=!1},error:r=>{this.snackbar.error(r.message||"Failed to load purchase orders"),this.isLoading=!1}})}onSearch(){this.currentPage=0,this.loadPurchaseOrders()}onPageChange(e){this.currentPage=e,this.loadPurchaseOrders()}onPageSizeChange(e){this.pageSize=e,this.currentPage=0,this.loadPurchaseOrders()}deletePurchaseOrder(e){confirm("Are you sure you want to delete this purchase order? This action cannot be undone.")&&(this.isLoading=!0,this.purchaseOrderService.deletePurchaseOrder(e).pipe(v(this.destroy$)).subscribe({next:()=>{this.snackbar.success("Purchase Order deleted successfully"),this.loadPurchaseOrders()},error:r=>{this.snackbar.error(r?.error?.message||"Failed to delete purchase order"),this.isLoading=!1}}))}loadCustomers(){this.canManagePurchaseOrders&&(this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data),this.isLoadingCustomers=!1},error:e=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}}))}refreshCustomers(){this.canManagePurchaseOrders&&(this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:e=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}}))}resetForm(){this.searchForm.reset(),this.currentPage=0,this.loadPurchaseOrders()}editPurchaseOrder(e){localStorage.setItem("purchaseOrderId",this.encryptionService.encrypt(e.toString())),this.router.navigate(["/purchase-order/create"])}clearLocalStorage(){localStorage.removeItem("purchaseOrderId"),this.router.navigate(["/purchase-order/create"])}generatePdf(e,r){this.purchaseOrderService.generatePdf(e).pipe(v(this.destroy$)).subscribe({next:({blob:t,filename:o})=>{let d="purchase-order-"+(r?`${r}.pdf`:o),h=window.URL.createObjectURL(t),g=document.createElement("a");g.href=h,g.download=d,document.body.appendChild(g),g.click(),document.body.removeChild(g),window.URL.revokeObjectURL(h),this.snackbar.success("PDF downloaded successfully")},error:t=>{this.snackbar.error(t?.error?.message||"Failed to generate PDF")}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(r){return new(r||s)(O(X),O(J),O(U),O(H),O(Le),O(K),O(Y),O(De))}}static{this.\u0275cmp=D({type:s,selectors:[["app-purchase-order"]],standalone:!0,features:[L],decls:46,vars:5,consts:[[1,"purchase-container"],[3,"show"],[1,"search-section","card"],[3,"ngSubmit","formGroup"],[1,"search-controls"],[1,"form-group"],["type","text","formControlName","search","placeholder","Search by order number...",1,"form-control"],["type","text","formControlName","batchNumber","placeholder","Search by Batch Number...",1,"form-control"],["class","form-group",4,"ngIf"],["type","date","formControlName","startDate","placeholder","Start Date",1,"form-control"],["type","date","formControlName","endDate","placeholder","End Date",1,"form-control"],[1,"button-group"],["type","submit",1,"search-btn","btn","btn-sm","btn-primary"],[1,"fas","fa-search"],["type","button",1,"search-btn","btn","btn-sm","btn-secondary",3,"click"],[1,"fas","fa-undo"],[1,"btn","btn-sm","btn-primary","mb-2",3,"click"],[1,"purchases-list","card"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],[3,"currentPage","pageSize","totalElements","pageSizeOptions","pageChange","pageSizeChange",4,"ngIf"],[1,"product-select-group"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","touchstart","disabled"],[1,"fas",3,"ngClass"],[1,"actions"],["class","btn-icon edit","title","Edit Purchase Order",3,"click","touchstart",4,"ngIf"],["class","btn-icon pdf","title","Export PDF",3,"click","touchstart",4,"ngIf"],["class","btn-icon delete","title","Delete Purchase Order",3,"click","touchstart",4,"ngIf"],["title","Edit Purchase Order",1,"btn-icon","edit",3,"click","touchstart"],[1,"fas","fa-eye"],["title","Export PDF",1,"btn-icon","pdf",3,"click","touchstart"],[1,"fas","fa-file-pdf"],["title","Delete Purchase Order",1,"btn-icon","delete",3,"click","touchstart"],[1,"fas","fa-trash"],[3,"pageChange","pageSizeChange","currentPage","pageSize","totalElements","pageSizeOptions"]],template:function(r,t){r&1&&(n(0,"div",0),u(1,"app-loader",1),n(2,"div",2)(3,"h2"),a(4,"Search Purchase Orders"),i(),n(5,"form",3),_("ngSubmit",function(){return t.onSearch()}),n(6,"div",4)(7,"div",5),u(8,"input",6)(9,"input",7),i(),y(10,Ke,5,6,"div",8),n(11,"div",5),u(12,"input",9),i(),n(13,"div",5),u(14,"input",10),i(),n(15,"div",11)(16,"button",12),u(17,"i",13),a(18," Search "),i(),n(19,"button",14),_("click",function(){return t.resetForm()}),u(20,"i",15),a(21," Reset "),i()()()()(),n(22,"button",16),_("click",function(){return t.clearLocalStorage()}),a(23,"Add Purchase Order"),i(),n(24,"div",17)(25,"h2"),a(26,"Purchase Orders"),i(),n(27,"div",18)(28,"table",19)(29,"thead")(30,"tr")(31,"th"),a(32,"No"),i(),n(33,"th"),a(34,"Order No."),i(),n(35,"th"),a(36,"Customer Name"),i(),n(37,"th"),a(38,"Order Date"),i(),n(39,"th"),a(40,"Total Order Amount"),i(),n(41,"th"),a(42,"Actions"),i()()(),n(43,"tbody"),y(44,Xe,16,11,"tr",20),i()()(),y(45,Ze,1,4,"app-pagination",21),i()()),r&2&&(c(),l("show",t.isLoading),c(4),l("formGroup",t.searchForm),c(5),l("ngIf",t.canManagePurchaseOrders),c(34),l("ngForOf",t.purchaseOrders),c(),l("ngIf",t.totalPages>0))},dependencies:[A,z,j,$,Se,T,q,de,G,Q,R,B,le,F,W,N,pe],styles:[".purchase-container[_ngcontent-%COMP%]{padding:2rem;position:relative;min-height:200px;background-color:var(--background)}.purchase-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fff;border-radius:0;box-shadow:0 2px 4px #0000001a;margin-bottom:20px;padding:20px}.purchase-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-primary);font-size:1.5rem}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;align-items:flex-start}@media (max-width: 768px){.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{grid-template-columns:1fr}}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin:0}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:40px}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{width:42px;padding:0;display:flex;align-items:center;justify-content:center;border:1px solid var(--border-color);border-radius:var(--border-radius);background:var(--primary)}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary)}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem}@media (max-width: 768px){.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{grid-column:1/-1}}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;height:42px;display:flex;align-items:center;justify-content:center;gap:.5rem}.purchase-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.purchase-container[_ngcontent-%COMP%]   .purchases-list[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.purchase-container[_ngcontent-%COMP%]   .purchases-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.purchase-container[_ngcontent-%COMP%]   .purchases-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-secondary);white-space:nowrap}.purchase-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{width:auto;min-width:80px;padding:.5rem;margin-bottom:0}@media (max-width: 768px){.purchase-container[_ngcontent-%COMP%]{padding:1rem}.purchase-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.purchase-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .purchase-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (max-width: 576px){.table-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:flex-start}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{width:100%}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{flex:1}}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-start}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.actions[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]{color:var(--primary);background-color:#1458811a}.actions[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.actions[_ngcontent-%COMP%]   .btn-icon.pdf[_ngcontent-%COMP%]{color:#dc3545;background-color:#dc35451a}.actions[_ngcontent-%COMP%]   .btn-icon.pdf[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#dc3545;color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.pdf[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.actions[_ngcontent-%COMP%]   .btn-icon.convert[_ngcontent-%COMP%]{color:#9c27b0;background-color:#9c27b01a}.actions[_ngcontent-%COMP%]   .btn-icon.convert[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#9c27b0;color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.convert[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed;opacity:.6}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]{color:#dc3545;background-color:#dc35451a}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]:hover{background-color:#dc3545;color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:active{transform:translateY(0)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{padding:6px}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}}  .custom-snackbar.success{background-color:var(--accent2)}  .custom-snackbar.error{background-color:#dc3545}  .custom-snackbar .snackbar-message{display:flex;align-items:center;gap:.5rem;color:#fff}  .custom-snackbar .snackbar-message i{font-size:1.2rem}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:var(--primary)}.product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:flex-start}.product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{background-color:var(--background);color:#fff;margin-top:3px;width:42px;height:42px;border-radius:6px;transition:all .2s ease}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:active{transform:translateY(0)}"]})}}return s})();function tt(s,f){s&1&&(n(0,"div",51),a(1," Customer is required "),i())}function rt(s,f){s&1&&(n(0,"div",51),a(1," Order date is required "),i())}function nt(s,f){s&1&&(n(0,"div",51),a(1," Order number is required "),i())}function it(s,f){s&1&&(n(0,"div",51),a(1," Packaging and forwarding charges is required and must be 0 or greater "),i())}function ot(s,f){if(s&1){let e=x();n(0,"button",52),_("click",function(){P(e);let t=m();return C(t.convertToPurchase())}),u(1,"i",53),a(2," Convert to Purchase "),i()}}function at(s,f){s&1&&(n(0,"th",54),a(1,"Select"),i())}function st(s,f){if(s&1){let e=x();n(0,"div")(1,"input",67),_("change",function(t){P(e);let o=m(2).index,d=m();return C(d.toggleSelection(o,t))}),i()()}if(s&2){let e=m(2).index,r=m();c(),l("checked",r.isSelected(e)),xe("aria-label","Select item "+(e+1)+" for purchase conversion")}}function ct(s,f){if(s&1&&(n(0,"td",54),y(1,st,2,2,"div",49),i()),s&2){let e,r=m().index,t=m();c(),l("ngIf",t.isEdit&&((e=t.productsFormArray.at(r).get("id"))==null?null:e.value)&&!((e=t.productsFormArray.at(r).get("purchaseId"))!=null&&e.value))}}function dt(s,f){s&1&&(n(0,"div",51),a(1," Please select a product "),i())}function lt(s,f){s&1&&(n(0,"div",51),a(1," Quantity must be 1 or greater "),i())}function ut(s,f){s&1&&(n(0,"div",51),a(1," Get Quantity cannot exceed Quantity "),i())}function pt(s,f){s&1&&(n(0,"div",51),a(1," Get Quantity must be 0 or greater "),i())}function mt(s,f){s&1&&(n(0,"div",51),a(1," Unit price must be greater than 0 "),i())}function gt(s,f){if(s&1){let e=x();n(0,"tr",55),y(1,ct,2,1,"td",38),n(2,"td",39)(3,"div",56)(4,"div",14),u(5,"app-searchable-select",57),n(6,"button",58),_("click",function(){P(e);let t=m();return C(t.refreshProducts())})("touchstart",function(t){return P(e),C(t.preventDefault())}),u(7,"i",17),i()(),y(8,dt,2,0,"div",18),i()(),n(9,"td")(10,"div",56),u(11,"input",59),y(12,lt,2,0,"div",18),i()(),n(13,"td")(14,"div",56)(15,"input",60),_("focus",function(){let t=P(e).index,o=m();return C(o.onGetQuantityFocus(t))})("change",function(t){let o=P(e).index,d=m();return C(d.onGetQuantityChange(o,t))}),i(),y(16,ut,2,0,"div",18)(17,pt,2,0,"div",18),i()(),n(18,"td",40)(19,"div",56)(20,"div",26),u(21,"input",61),i(),y(22,mt,2,0,"div",18),i()(),n(23,"td")(24,"div",26),u(25,"input",62),i()(),n(26,"td")(27,"div",26),u(28,"input",63),i()(),n(29,"td")(30,"div",56),u(31,"input",64),i()(),n(32,"td")(33,"button",65),_("click",function(){let t=P(e).index,o=m();return C(o.removeProduct(t))}),u(34,"i",66),i()()()}if(s&2){let e,r,t,o,d,h,g,b=f.index,p=m();l("formGroupName",b),c(),l("ngIf",!p.purchaseId),c(4),w("is-invalid",p.isProductFieldInvalid(b,"productId")),l("focusWidthPx",600)("options",p.products)("placeholder","Select Product")("searchPlaceholder","Search products...")("disabled",!!p.purchaseId||!!((e=p.productsFormArray.at(b).get("purchaseId"))!=null&&e.value)),c(),l("disabled",p.isLoadingProducts),c(),l("ngClass",p.isLoadingProducts?"fa-spinner fa-spin":"fa-sync-alt"),c(),l("ngIf",p.isProductFieldInvalid(b,"productId")),c(3),w("is-invalid",p.isProductFieldInvalid(b,"quantity")),l("readonly",!!p.purchaseId||!!((r=p.productsFormArray.at(b).get("purchaseId"))!=null&&r.value)),c(),l("ngIf",p.isProductFieldInvalid(b,"quantity")),c(3),w("is-invalid",p.isProductFieldInvalid(b,"getQuantity")),l("readonly",!1),c(),l("ngIf",(t=p.productsFormArray.at(b).get("getQuantity"))==null||t.errors==null?null:t.errors.maxQuantity),c(),l("ngIf",(o=p.productsFormArray.at(b).get("getQuantity"))==null||o.errors==null?null:o.errors.min),c(4),w("is-invalid",p.isProductFieldInvalid(b,"unitPrice")),l("readonly",!!p.purchaseId||!!((d=p.productsFormArray.at(b).get("purchaseId"))!=null&&d.value)),c(),l("ngIf",p.isProductFieldInvalid(b,"unitPrice")),c(3),l("value",p.getFormattedPrice(b)),c(3),l("value",p.getFormattedTaxAmount(b)),c(3),l("readonly",!!p.purchaseId||!!((h=p.productsFormArray.at(b).get("purchaseId"))!=null&&h.value)),c(2),l("disabled",p.productsFormArray.length===1||!!p.purchaseId||!!((g=p.productsFormArray.at(b).get("purchaseId"))!=null&&g.value))}}function ht(s,f){s&1&&u(0,"app-loader")}var re=(()=>{class s{get productsFormArray(){return this.purchaseOrderForm.get("products")}constructor(e,r,t,o,d,h,g,b){this.fb=e,this.productService=r,this.customerService=t,this.purchaseOrderService=o,this.snackbar=d,this.http=h,this.router=g,this.encryptionService=b,this.products=[],this.customers=[],this.loading=!1,this.isLoadingProducts=!1,this.isLoadingCustomers=!1,this.isEdit=!1,this.destroy$=new V,this.productSubscriptions=[],this.selectedItemIds=new Set,this.showPackagingChargesModal=!1,this.initForm()}ngOnInit(){this.loadProducts(),this.loadCustomers();let e=localStorage.getItem("purchaseOrderId");if(e){let r=this.encryptionService.decrypt(e);r&&this.fetchPurchaseOrderDetails(Number(r))}}ngOnDestroy(){this.productSubscriptions.forEach(e=>{e&&!e.closed&&e.unsubscribe()}),this.productSubscriptions=[],this.destroy$.next(),this.destroy$.complete(),this.products=[],this.customers=[],this.selectedItemIds.clear(),this.purchaseOrderForm&&this.purchaseOrderForm.reset()}initForm(){this.purchaseOrderForm=this.fb.group({id:[null],customerId:["",E.required],orderDate:[ae(new Date,"yyyy-MM-dd","en"),E.required],invoiceNumber:[null],packagingAndForwadingCharges:[0,[E.required,E.min(0)]],products:this.fb.array([])}),this.addProduct()}createProductFormGroup(){return this.fb.group({id:[null],productId:["",E.required],quantity:["",[E.required,E.min(1)]],getQuantity:[null,[this.getQuantityValidator()]],unitPrice:["",[E.required,E.min(.01)]],price:[{value:0,disabled:!0}],taxPercentage:[{value:0,disabled:!0}],taxAmount:[{value:0,disabled:!0}],remarks:[null,[]],purchaseId:[null]})}addProduct(){let e=this.createProductFormGroup();this.setupProductCalculations(e,this.productsFormArray.length),this.productsFormArray.push(e)}removeProduct(e){this.productsFormArray.length!==1&&(this.productSubscriptions[e]&&(this.productSubscriptions[e].unsubscribe(),this.productSubscriptions.splice(e,1)),this.productsFormArray.removeAt(e),this.productsFormArray.controls.forEach((r,t)=>{this.productSubscriptions[t]&&this.productSubscriptions[t].unsubscribe(),this.setupProductCalculations(r,t)}),this.calculateTotalAmount())}setupProductCalculations(e,r){let t=e.get("productId")?.valueChanges.pipe(v(this.destroy$)).subscribe(b=>{if(b){let p=this.products.find(Z=>Z.id===b);if(p){let Z=p.taxPercentage||0,fe=p.purchaseAmount||0;e.patchValue({taxPercentage:Z,unitPrice:fe},{emitEvent:!1}),this.calculateProductPrice(r)}}}),d=e.get("quantity")?.valueChanges.pipe(v(this.destroy$)).subscribe(()=>{e.get("getQuantity")?.updateValueAndValidity({emitEvent:!1})}),h=e.valueChanges.pipe(v(this.destroy$)).subscribe(()=>{this.calculateProductPrice(r)}),g=new Pe;t&&g.add(t),d&&g.add(d),g.add(h),this.productSubscriptions[r]=g}calculateProductPrice(e){let r=this.productsFormArray.at(e);if(!r)return;let t=Number(r.get("quantity")?.value||0),o=Number(r.get("unitPrice")?.value||0),d=Number(r.get("taxPercentage")?.value||0),h=Number((t*o).toFixed(2)),g=Number((h*d/100).toFixed(2));r.patchValue({price:h,taxAmount:g},{emitEvent:!1}),this.calculateTotalAmount()}getTotalAmount(){return this.productsFormArray.controls.reduce((e,r)=>e+(r.get("price").value||0),0)}getTotalTaxAmount(){return this.productsFormArray.controls.reduce((e,r)=>e+(r.get("taxAmount").value||0),0)}getGrandTotal(){let e=Number(this.purchaseOrderForm.get("packagingAndForwadingCharges")?.value||0);return this.getTotalAmount()+this.getTotalTaxAmount()+e}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.products=e.data),this.isLoadingProducts=!1},error:e=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.products=e.data,this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1},error:e=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1}})}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data),this.isLoadingCustomers=!1},error:e=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data),this.snackbar.success("Customers refreshed successfully"),this.isLoadingCustomers=!1},error:e=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}})}isFieldInvalid(e){let r=this.purchaseOrderForm.get(e);return r?r.invalid&&r.touched:!1}isProductFieldInvalid(e,r){let t=this.productsFormArray.at(e).get(r);if(!t)return!1;if(t.invalid&&(t.dirty||t.touched)){let d=t.errors;if(d&&(d.required||d.min&&r==="quantity"||d.min&&r==="unitPrice"||d.min||d.max||d.maxQuantity||d.min))return!0}return!1}resetForm(){this.isEdit=!1,this.purchaseOrderForm.patchValue({id:null}),this.initForm()}onSubmit(){if(this.markFormGroupTouched(this.purchaseOrderForm),this.purchaseOrderForm.valid){this.loading=!0;let e=this.preparePurchaseOrderData();(this.isEdit?this.purchaseOrderService.updatePurchaseOrder(e):this.purchaseOrderService.createPurchaseOrder(e)).pipe(v(this.destroy$)).subscribe({next:t=>{t?.success&&(this.snackbar.success(`Purchase Order ${this.isEdit?"updated":"created"} successfully`),localStorage.removeItem("purchaseOrderId"),this.router.navigate(["/purchase-order"])),this.loading=!1},error:t=>{this.snackbar.error(t?.error?.message||`Failed to ${this.isEdit?"update":"create"} purchase order`),this.loading=!1}})}else{let e=document.querySelector(".is-invalid");e&&e.scrollIntoView({behavior:"smooth",block:"center"})}}preparePurchaseOrderData(){let e=this.purchaseOrderForm.value,r={orderDate:ae(e.orderDate,"dd-MM-yyyy","en"),customerId:e.customerId,invoiceNumber:e.invoiceNumber,packagingAndForwadingCharges:Number(e.packagingAndForwadingCharges||0),products:e.products.map((t,o)=>{let d=this.productsFormArray.at(o).get("id")?.value,h={productId:Number(t.productId),quantity:Number(t.quantity),unitPrice:Number(t.unitPrice),getQuantity:t.getQuantity===null||t.getQuantity===void 0||t.getQuantity===""?null:Number(t.getQuantity),remarks:t.remarks||""};return this.isEdit&&d&&(h.id=d),h})};return this.isEdit&&e.id&&(r.id=e.id),r}markFormGroupTouched(e){Object.values(e.controls).forEach(r=>{r instanceof we||r instanceof Ne?this.markFormGroupTouched(r):(r.markAsTouched(),r.markAsDirty())})}calculateTotalAmount(){let e=this.productsFormArray.controls.reduce((t,o)=>t+(o.get("price").value||0),0),r=this.productsFormArray.controls.reduce((t,o)=>t+(o.get("taxAmount").value||0),0);this.purchaseOrderForm.patchValue({price:e,taxAmount:r,totalAmount:e+r},{emitEvent:!1})}getFormattedPrice(e){let r=this.productsFormArray.at(e).get("price")?.value;return r?r.toFixed(2):"0.00"}getFormattedTaxAmount(e){let r=this.productsFormArray.at(e).get("taxAmount")?.value;return r?r.toFixed(2):"0.00"}fetchPurchaseOrderDetails(e,r=!1){r&&(this.loading=!0),this.purchaseOrderService.getPurchaseOrderDetails(e).pipe(v(this.destroy$)).subscribe({next:t=>{t.id&&(this.isEdit=!0,t.purchaseId&&(this.purchaseId=t.purchaseId),this.populateForm(t)),r&&(this.loading=!1)},error:t=>{this.snackbar.error(t?.error?.message||"Failed to load purchase order details"),r&&(this.loading=!1)}})}populateForm(e){this.productSubscriptions.forEach(t=>{t&&!t.closed&&t.unsubscribe()}),this.productSubscriptions=[],this.purchaseOrderForm.patchValue({customerId:e.customerId,id:e.id,orderDate:ae(new Date(e.orderDate),"yyyy-MM-dd","en"),invoiceNumber:e.invoiceNumber,packagingAndForwadingCharges:e.packagingAndForwadingCharges||0}),this.productsFormArray.clear(),(e.products||e.items||[]).forEach((t,o)=>{let d=this.createProductFormGroup();this.setupProductCalculations(d,o);let h=Number(t.quantity||0),g=Number(t.unitPrice||0),b=t.price||h*g,p=t.taxPercentage||0,Z=t.taxAmount||b*p/100;d.patchValue({id:t.id,productId:t.productId,quantity:h,getQuantity:t.getQuantity??null,unitPrice:g,price:b,taxPercentage:p,taxAmount:Z,remarks:t.remarks||"",purchaseId:t.purchaseId||null},{emitEvent:!1});let fe=t.purchaseId||null;(this.purchaseId||fe)&&(d.get("productId")?.disable(),d.get("quantity")?.disable(),d.get("unitPrice")?.disable(),d.get("remarks")?.disable()),this.productsFormArray.push(d)}),this.isEdit=!0}getItemIdByIndex(e){let t=this.productsFormArray.at(e)?.get("id")?.value;return typeof t=="number"?t:null}isSelected(e){let r=this.getItemIdByIndex(e);return r?this.selectedItemIds.has(r):!1}toggleSelection(e,r){let t=this.getItemIdByIndex(e);if(!t)return;r.target.checked?this.selectedItemIds.add(t):this.selectedItemIds.delete(t)}hasSelection(){return this.selectedItemIds.size>0}convertToPurchase(){if(!this.purchaseOrderForm.get("id")?.value){this.snackbar.error("Purchase order ID not found");return}if(!this.hasSelection()){this.snackbar.error("Please select at least one item to convert to purchase");return}this.showPackagingChargesModal=!0}onPackagingChargesConfirm(e){this.showPackagingChargesModal=!1;let r=Array.from(this.selectedItemIds);if(r.length===0){this.snackbar.error("Please select at least one item to convert to purchase");return}let t;if(typeof e=="object"&&e.id!==void 0)t=be(ne({},e),{purchaseOrderItemIds:r});else{let o=this.purchaseOrderForm.get("id")?.value,d=this.purchaseOrderForm.get("invoiceNumber")?.value;if(!o){this.snackbar.error("Purchase order ID not found");return}t={id:o,invoiceNumber:d||"",packagingAndForwadingCharges:typeof e=="number"?e:0,purchaseOrderItemIds:r}}if(!t.id){this.snackbar.error("Purchase order ID not found");return}this.loading=!0,this.purchaseOrderService.convertToPurchase(t).pipe(v(this.destroy$)).subscribe({next:o=>{o?.success?(this.snackbar.success(o?.message||"Purchase order converted to purchase successfully"),o?.data?.purchaseId&&(this.purchaseId=o.data.purchaseId),this.selectedItemIds.clear(),this.fetchPurchaseOrderDetails(t.id,!0)):(this.snackbar.error(o?.message||"Failed to convert purchase order to purchase"),this.loading=!1)},error:o=>{this.snackbar.error(o?.error?.message||"Failed to convert purchase order to purchase"),this.loading=!1}})}onPackagingChargesCancel(){this.showPackagingChargesModal=!1}disableProductFormControls(){this.productsFormArray.controls.forEach(e=>{let r=e;r.get("productId")?.disable(),r.get("quantity")?.disable(),r.get("unitPrice")?.disable(),r.get("remarks")?.disable()})}onGetQuantityFocus(e){let r=this.productsFormArray.at(e).get("getQuantity");r&&r.value===null&&r.setValue("",{emitEvent:!1})}onGetQuantityChange(e,r){let t=this.productsFormArray.at(e).get("getQuantity"),o=Number(this.productsFormArray.at(e).get("quantity")?.value||0),h=r.target.value;if(!h){t?.setValue(null,{emitEvent:!1}),t?.updateValueAndValidity(),this.syncGetQuantityToServer(e,null);return}let g=Number(h);if(isNaN(g)||g<0){t?.setValue(0,{emitEvent:!1}),t?.updateValueAndValidity(),this.syncGetQuantityToServer(e,0);return}if(g>o){t?.setValue(o,{emitEvent:!1}),t?.updateValueAndValidity(),this.snackbar.warning("Get Quantity cannot exceed Quantity"),this.syncGetQuantityToServer(e,o);return}t?.setValue(g,{emitEvent:!1}),t?.updateValueAndValidity(),this.syncGetQuantityToServer(e,g)}syncGetQuantityToServer(e,r){let t=this.productsFormArray.at(e);if(!this.isEdit)return;let o=t.get("id")?.value;o&&this.purchaseOrderService.updatePurchaseOrderItemGetQuantity({id:o,getQuantity:r===null?null:Number(r)}).pipe(v(this.destroy$)).subscribe({next:d=>{d?.success===!1&&this.snackbar.error(d?.message||"Failed to update Get Quantity")},error:()=>{this.snackbar.error("Failed to update Get Quantity")}})}getQuantityValidator(){return e=>{let r=e.value;if(r==null||r==="")return null;let t=Number(r);if(isNaN(t)||t<0)return{min:!0};let d=e.parent?.get("quantity")?.value,h=d==null||d===""?null:Number(d);return h!==null&&!isNaN(h)&&t>h?{maxQuantity:!0}:null}}static{this.\u0275fac=function(r){return new(r||s)(O(U),O(me),O(J),O(X),O(H),O(ce),O(Y),O(K))}}static{this.\u0275cmp=D({type:s,selectors:[["app-add-purchase-order"]],standalone:!0,features:[L],decls:122,vars:48,consts:[[1,"add-purchase-container"],["routerLink","/purchase-order",1,"btn","btn-sm","btn-secondary","back-btn"],[1,"fas","fa-arrow-left"],[1,"form-card"],[1,"card-header"],[1,"form-title"],[1,"fas","fa-file-invoice"],[1,"purchase-form",3,"ngSubmit","formGroup"],[1,"header-section"],[1,"form-row"],[1,"form-group"],["for","customerId"],[1,"fas","fa-user"],[1,"required"],[1,"select-group"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","placeholder","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",3,"click","touchstart","disabled"],[1,"fas",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","orderDate"],[1,"fas","fa-calendar"],["type","date","id","orderDate","formControlName","orderDate",1,"form-control"],["for","invoiceNumber"],["type","text","id","invoiceNumber","formControlName","invoiceNumber","readonly","",1,"form-control"],["for","packagingAndForwadingCharges"],[1,"fas","fa-box"],[1,"input-group"],[1,"input-group-text"],["type","number","id","packagingAndForwadingCharges","formControlName","packagingAndForwadingCharges","min","0","step","0.01","placeholder","Enter packaging and forwarding charges",1,"form-control"],["formArrayName","products","aria-labelledby","products-heading",1,"products-section"],[1,"products-header"],["id","products-heading"],["aria-hidden","true",1,"fas","fa-boxes"],["type","button","class","btn btn-success me-2",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary",3,"click","disabled"],[1,"fas","fa-plus"],[1,"table-responsive"],[1,"table","products-table"],["class","select-col",4,"ngIf"],[1,"product-name-col"],[1,"rate-col"],[3,"formGroupName",4,"ngFor","ngForOf"],["aria-label","Purchase Order Summary",1,"purchase-summary"],[1,"summary-item"],[1,"summary-item","total"],[1,"form-actions"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click","disabled"],[1,"fas","fa-undo"],["type","submit",1,"btn","btn-sm","btn-primary",3,"disabled"],[4,"ngIf"],[3,"confirm","cancel","show","defaultCharges","requireInvoiceNumber","orderId"],[1,"invalid-feedback"],["type","button",1,"btn","btn-success","me-2",3,"click"],[1,"fa-solid","fa-shopping-cart"],[1,"select-col"],[3,"formGroupName"],[1,"form-field-container"],["formControlName","productId","labelKey","name","valueKey","id",3,"focusWidthPx","options","placeholder","searchPlaceholder","disabled"],["type","button","title","Refresh Products",1,"btn","btn-sm","btn-primary","refresh",3,"click","touchstart","disabled"],["type","number","formControlName","quantity","placeholder","Qty","min","1",1,"form-control",3,"readonly"],["type","number","formControlName","getQuantity","placeholder","Get Qty","min","0","step","1",1,"form-control",3,"focus","change","readonly"],["type","number","formControlName","unitPrice","placeholder","Price","min","0.01","step","0.01",1,"form-control",3,"readonly"],["type","number","formControlName","price","readonly","",1,"form-control",3,"value"],["type","number","formControlName","taxAmount","readonly","",1,"form-control",3,"value"],["type","text","formControlName","remarks","placeholder","Remarks",1,"form-control",3,"readonly"],["type","button","title","Remove Product",1,"btn","btn-sm","btn-danger",3,"click","disabled"],[1,"fas","fa-trash"],["type","checkbox","title","Select for purchase conversion",3,"change","checked"]],template:function(r,t){if(r&1&&(n(0,"div",0)(1,"button",1),u(2,"i",2),a(3," Back to Purchase Orders "),i(),n(4,"div",3)(5,"div",4)(6,"h2",5),u(7,"i",6),a(8," Add New Purchase Order "),i()(),n(9,"form",7),_("ngSubmit",function(){return t.onSubmit()}),n(10,"div",8)(11,"div",9)(12,"div",10)(13,"label",11),u(14,"i",12),a(15," Select Customer "),n(16,"span",13),a(17,"*"),i()(),n(18,"div",14),u(19,"app-searchable-select",15),n(20,"button",16),_("click",function(){return t.refreshCustomers()})("touchstart",function(d){return d.preventDefault()}),u(21,"i",17),i()(),y(22,tt,2,0,"div",18),i(),n(23,"div",10)(24,"label",19),u(25,"i",20),a(26," Order Date "),n(27,"span",13),a(28,"*"),i()(),u(29,"input",21),y(30,rt,2,0,"div",18),i(),n(31,"div",10)(32,"label",22),u(33,"i",6),a(34," Order Number "),n(35,"span",13),a(36,"*"),i()(),u(37,"input",23),y(38,nt,2,0,"div",18),i(),n(39,"div",10)(40,"label",24),u(41,"i",25),a(42," Packaging & Forwarding Charges "),n(43,"span",13),a(44,"*"),i()(),n(45,"div",26)(46,"span",27),a(47,"\u20B9"),i(),u(48,"input",28),i(),y(49,it,2,0,"div",18),i()()(),n(50,"section",29)(51,"div",30)(52,"h3",31),u(53,"i",32),a(54," Products"),i(),n(55,"div"),y(56,ot,3,0,"button",33),n(57,"button",34),_("click",function(){return t.addProduct()}),u(58,"i",35),a(59," Add Product "),i()()(),n(60,"div",36)(61,"table",37)(62,"thead")(63,"tr"),y(64,at,2,0,"th",38),n(65,"th",39),a(66,"Product Name"),i(),n(67,"th"),a(68,"Quantity"),i(),n(69,"th"),a(70,"Get Quantity"),i(),n(71,"th",40),a(72,"Rate"),i(),n(73,"th"),a(74,"Price"),i(),n(75,"th"),a(76,"Tax Amount"),i(),n(77,"th"),a(78,"Remarks"),i(),n(79,"th"),a(80,"Actions"),i()()(),n(81,"tbody"),y(82,gt,35,29,"tr",41),i()()()(),n(83,"section",42)(84,"div",43)(85,"span"),a(86,"Total Products:"),i(),n(87,"strong"),a(88),i()(),n(89,"div",43)(90,"span"),a(91,"Total Price:"),i(),n(92,"strong"),a(93),I(94,"number"),i()(),n(95,"div",43)(96,"span"),a(97,"Total Tax Amount:"),i(),n(98,"strong"),a(99),I(100,"number"),i()(),n(101,"div",43)(102,"span"),a(103,"Packaging & Forwarding Charges:"),i(),n(104,"strong"),a(105),I(106,"number"),i()(),n(107,"div",44)(108,"span"),a(109,"Grand Total:"),i(),n(110,"strong"),a(111),I(112,"number"),i()()(),n(113,"div",45)(114,"button",46),_("click",function(){return t.resetForm()}),u(115,"i",47),a(116," Reset "),i(),n(117,"button",48),u(118,"i",17),a(119),i()()()()(),y(120,ht,1,0,"app-loader",49),n(121,"app-packaging-charges-modal",50),_("confirm",function(d){return t.onPackagingChargesConfirm(d)})("cancel",function(){return t.onPackagingChargesCancel()}),i()),r&2){let o,d,h,g;c(9),l("formGroup",t.purchaseOrderForm),c(10),w("is-invalid",t.isFieldInvalid("customerId")),l("options",t.customers)("placeholder","Select Customer")("searchPlaceholder","Search customers..."),c(),l("disabled",t.isLoadingCustomers),c(),l("ngClass",t.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt"),c(),l("ngIf",t.isFieldInvalid("customerId")),c(7),w("is-invalid",t.isFieldInvalid("orderDate")),c(),l("ngIf",t.isFieldInvalid("orderDate")),c(7),w("is-invalid",t.isFieldInvalid("invoiceNumber")),c(),l("ngIf",t.isFieldInvalid("invoiceNumber")),c(10),w("is-invalid",t.isFieldInvalid("packagingAndForwadingCharges")),c(),l("ngIf",t.isFieldInvalid("packagingAndForwadingCharges")),c(7),l("ngIf",t.isEdit&&((o=t.purchaseOrderForm.get("id"))==null?null:o.value)&&!t.purchaseId),c(),l("disabled",!!t.purchaseId),c(7),l("ngIf",!t.purchaseId),c(18),l("ngForOf",t.productsFormArray.controls),c(6),M(t.productsFormArray.length),c(5),S("\u20B9",k(94,36,t.getTotalAmount(),"1.2-2"),""),c(6),S("\u20B9",k(100,39,t.getTotalTaxAmount(),"1.2-2"),""),c(6),S("\u20B9",k(106,42,((d=t.purchaseOrderForm.get("packagingAndForwadingCharges"))==null?null:d.value)||0,"1.2-2"),""),c(6),S("\u20B9",k(112,45,t.getGrandTotal(),"1.2-2"),""),c(3),l("disabled",t.loading),c(3),l("disabled",t.purchaseOrderForm.invalid||t.loading),c(),l("ngClass",t.loading?"fa-spinner fa-spin":"fa-save"),c(),S(" ",t.loading?"Saving...":"Save Purchase Order"," "),c(),l("ngIf",t.loading),c(),l("show",t.showPackagingChargesModal)("defaultCharges",((h=t.purchaseOrderForm.get("packagingAndForwadingCharges"))==null?null:h.value)||0)("requireInvoiceNumber",!0)("orderId",(g=t.purchaseOrderForm.get("id"))==null?null:g.value)}},dependencies:[A,z,j,$,se,T,q,de,Fe,G,Q,Te,R,B,Ee,Ae,F,Ve,W,N,ze],styles:[".add-purchase-container[_ngcontent-%COMP%]{padding:2rem;margin:0 auto}@media (max-width: 768px){.add-purchase-container[_ngcontent-%COMP%]{padding:1rem}}.select-group[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;gap:.5rem;width:100%;overflow:visible}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{display:block;flex:1;position:relative;z-index:100;overflow:visible}.select-group[_ngcontent-%COMP%]   app-searchable-select.custom-width[_ngcontent-%COMP%]{position:absolute;z-index:1000;left:0}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]:focus-within{z-index:1000;position:relative}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]:focus-within     .select-dropdown{z-index:1001!important;position:absolute!important}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]     .select-dropdown{z-index:1001!important;position:absolute!important}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{flex-shrink:0;margin-top:0;height:40px;min-width:40px;display:flex;align-items:center;justify-content:center;position:relative;z-index:1;border:1px solid var(--supporting);border-radius:8px;background:#fff;transition:all .3s ease;color:var(--primary);touch-action:manipulation}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary);color:#fff}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.form-control[_ngcontent-%COMP%]{height:40px}.back-btn[_ngcontent-%COMP%]{margin-bottom:1rem}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:var(--border-radius);box-shadow:var(--card-shadow);overflow:hidden}.card-header[_ngcontent-%COMP%]{background-color:var(--primary);padding:1.5rem}.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:1.5rem;font-weight:500;display:flex;align-items:center;gap:.5rem}.purchase-form[_ngcontent-%COMP%]{padding:2rem}@media (max-width: 768px){.purchase-form[_ngcontent-%COMP%]{padding:1rem}}.header-section[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-bottom:2rem;position:relative}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:1.5rem}@media (max-width: 768px){.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.products-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;border:1px solid var(--primary)}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.25rem;display:flex;align-items:center;gap:.5rem}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem;position:relative}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem;color:var(--text-primary);font-weight:500}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:var(--danger);margin-left:4px}.input-group[_ngcontent-%COMP%]{display:flex;align-items:stretch}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{background-color:var(--background);border:1px solid var(--border-color);border-right:none;border-radius:var(--border-radius) 0 0 var(--border-radius);height:38px;color:var(--text-secondary);min-width:40px;display:flex;align-items:center;justify-content:center}.input-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{border-radius:0 var(--border-radius) var(--border-radius) 0;flex:1}.purchase-summary[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;display:flex;justify-content:flex-end;gap:2rem;flex-wrap:wrap}.purchase-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.purchase-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.purchase-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-primary);font-size:1.25rem;font-weight:600}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:1rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}@media (max-width: 576px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}.table-responsive[_ngcontent-%COMP%]{margin:0 -1.5rem;padding:0 1.5rem;overflow-x:auto;min-height:400px;-webkit-overflow-scrolling:touch}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{margin:0 -1rem;padding:0 1rem}}.products-table[_ngcontent-%COMP%]{width:100%;margin-bottom:0;background:#fff;border-collapse:separate;border-spacing:0}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--background-light);color:var(--text-primary);font-weight:600;padding:1rem;white-space:nowrap;border-bottom:2px solid var(--border-color)}.products-table[_ngcontent-%COMP%]   th.select-col[_ngcontent-%COMP%]{width:60px;max-width:60px;min-width:60px;text-align:center;padding:1rem .5rem}.products-table[_ngcontent-%COMP%]   th.product-name-col[_ngcontent-%COMP%]{width:30%;min-width:300px}.products-table[_ngcontent-%COMP%]   th.rate-col[_ngcontent-%COMP%]{width:10%;max-width:120px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;vertical-align:middle;border-bottom:1px solid var(--border-color)}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{min-width:80px}.products-table[_ngcontent-%COMP%]   td.select-col[_ngcontent-%COMP%]{width:60px;max-width:60px;min-width:60px;text-align:center;padding:.75rem .5rem}.products-table[_ngcontent-%COMP%]   td.product-name-col[_ngcontent-%COMP%]{width:30%;min-width:300px}.products-table[_ngcontent-%COMP%]   td.product-name-col[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{min-width:300px}.products-table[_ngcontent-%COMP%]   td.rate-col[_ngcontent-%COMP%]{width:10%;max-width:120px}.products-table[_ngcontent-%COMP%]   td.rate-col[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{min-width:100px;max-width:120px}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex-wrap:nowrap}.products-table[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{margin:0 auto}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem}}.form-field-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;overflow:visible}.form-field-container[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%], .form-field-container[_ngcontent-%COMP%]   .input-group.is-invalid[_ngcontent-%COMP%]{border-color:var(--danger);background-image:url(data:image/svg+xml,...)}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-bottom:1.5rem;vertical-align:top}.invalid-feedback[_ngcontent-%COMP%]{color:var(--danger);font-size:.75rem;margin-top:.25rem;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}"]})}}return s})();var ft=()=>({label:"All Products",value:""}),_t=()=>({label:"All Customers",value:""});function bt(s,f){if(s&1){let e=x();n(0,"tr"),u(1,"td",27),n(2,"td"),a(3),i(),n(4,"td"),a(5),i(),n(6,"td"),a(7),i(),n(8,"td"),a(9),I(10,"number"),i(),n(11,"td"),a(12),I(13,"number"),i(),n(14,"td"),a(15),I(16,"number"),i(),n(17,"td"),a(18),I(19,"number"),i(),n(20,"td")(21,"strong"),a(22),I(23,"number"),i()(),n(24,"td"),a(25),i(),n(26,"td"),a(27),i(),n(28,"td",28)(29,"button",29),_("click",function(){let t=P(e).$implicit,o=m(2);return C(o.editPurchaseOrder(t.orderId))})("touchstart",function(t){return P(e),C(t.preventDefault())}),u(30,"i",30),i()()()}if(s&2){let e,r=f.$implicit,t=m(2);c(),l("innerHTML",t.sanitizeHtml(r.productName),ye),c(2),M(r.quantity),c(2),M((e=r.getQuantity)!==null&&e!==void 0?e:0),c(2),M(r.quantity-(r.getQuantity||0)),c(2),S("\u20B9",k(10,11,r.unitPrice,"1.2-2"),""),c(3),S("\u20B9",k(13,14,r.price,"1.2-2"),""),c(3),S("",k(16,17,r.taxPercentage,"1.0-2"),"%"),c(3),S("\u20B9",k(19,20,r.taxAmount,"1.2-2"),""),c(4),S("\u20B9",k(23,23,r.finalPrice,"1.2-2"),""),c(3),M(r.customerName||"-"),c(2),M(r.remarks||"-")}}function Pt(s,f){if(s&1&&(n(0,"div",25)(1,"table")(2,"thead")(3,"tr")(4,"th"),a(5,"Product"),i(),n(6,"th"),a(7,"Qty"),i(),n(8,"th"),a(9,"Get Qty"),i(),n(10,"th"),a(11,"Pending Qty"),i(),n(12,"th"),a(13,"Unit Price"),i(),n(14,"th"),a(15,"Price"),i(),n(16,"th"),a(17,"Tax %"),i(),n(18,"th"),a(19,"Tax"),i(),n(20,"th"),a(21,"Final"),i(),n(22,"th"),a(23,"Customer"),i(),n(24,"th"),a(25,"Remarks"),i(),n(26,"th"),a(27,"Action"),i()()(),n(28,"tbody"),y(29,bt,31,26,"tr",26),i()()()),s&2){let e=m();c(29),l("ngForOf",e.pendingItems)}}function Ct(s,f){s&1&&(n(0,"div",31)(1,"p"),a(2,"Loading pending purchase items..."),i()())}function Ot(s,f){s&1&&(n(0,"div",32)(1,"p"),a(2,"No pending purchase order items found."),i()())}function vt(s,f){if(s&1){let e=x();n(0,"button",38),_("click",function(){let t=P(e).$implicit,o=m(2);return C(o.onPageChange(t))})("touchstart",function(t){return P(e),C(t.preventDefault())}),a(1),i()}if(s&2){let e=f.$implicit,r=m(2);w("active",e===r.currentPage),c(),S(" ",e+1," ")}}function yt(s,f){if(s&1){let e=x();n(0,"div",33)(1,"div",34),a(2),i(),n(3,"div",35)(4,"button",36),_("click",function(){P(e);let t=m();return C(t.onPageChange(t.currentPage-1))})("touchstart",function(t){return P(e),C(t.preventDefault())}),a(5," Previous "),i(),y(6,vt,2,3,"button",37),n(7,"button",36),_("click",function(){P(e);let t=m();return C(t.onPageChange(t.currentPage+1))})("touchstart",function(t){return P(e),C(t.preventDefault())}),a(8," Next "),i()()()}if(s&2){let e=m();c(2),Me(" Showing ",e.currentPage+1," of ",e.totalPages," pages (",e.totalItems," total items) "),c(2),l("disabled",e.currentPage===0),c(2),l("ngForOf",e.getPageNumbers()),c(),l("disabled",e.currentPage===e.totalPages-1)}}var he=(()=>{class s{constructor(e,r,t,o,d,h,g,b,p){this.fb=e,this.purchaseOrderService=r,this.customerService=t,this.productService=o,this.snackbar=d,this.router=h,this.encryptionService=g,this.sanitizer=b,this.meta=p,this.pendingItems=[],this.currentPage=0,this.totalPages=0,this.totalItems=0,this.perPageRecord=10,this.loading=!1,this.customers=[],this.isLoadingCustomers=!1,this.products=[],this.isLoadingProducts=!1,this.destroy$=new V,this.searchForm=this.fb.group({orderId:[""],productId:[""],customerId:[""]})}ngOnInit(){this.meta.updateTag({name:"description",content:"Pending purchase order items with quantities, pricing, and customer filters."}),this.meta.updateTag({name:"robots",content:"index,follow"}),this.loadPendingItems(),this.loadProducts(),this.loadCustomers()}loadPendingItems(e=0){this.loading=!0,this.currentPage=e;let r=this.searchForm.value,t={id:r.orderId?Number(r.orderId):void 0,productId:r.productId?Number(r.productId):void 0,customerId:r.customerId?Number(r.customerId):void 0,page:e,size:this.perPageRecord};this.purchaseOrderService.searchPendingPurchaseOrderItems(t).pipe(v(this.destroy$)).subscribe({next:o=>{o?.success&&o.data?(this.pendingItems=o.data.content||[],this.totalPages=o.data.totalPages||0,this.totalItems=o.data.totalElements||0):(this.pendingItems=[],this.snackbar.error(o?.message||"Failed to load pending purchase items")),this.loading=!1},error:o=>{console.error("Error loading pending purchase items:",o),this.pendingItems=[],this.loading=!1,this.snackbar.error("Failed to load pending purchase items")}})}onSubmit(e){e&&(e.preventDefault(),e.stopPropagation()),this.loadPendingItems(0)}resetForm(){this.searchForm.reset({orderId:"",productId:"",customerId:""}),this.loadPendingItems(0)}onPageChange(e){e<0||e>this.totalPages-1||this.loadPendingItems(e)}getPageNumbers(){let e=[];if(this.totalPages<=5)for(let t=0;t<this.totalPages;t++)e.push(t);else{let t=Math.max(0,Math.min(this.currentPage-2,this.totalPages-5)),o=Math.min(this.totalPages,t+5);for(let d=t;d<o;d++)e.push(d)}return e}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data),this.isLoadingCustomers=!1},error:()=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}})}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.products=e.data),this.isLoadingProducts=!1},error:()=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.customers=e.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:()=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(v(this.destroy$)).subscribe({next:e=>{e.success&&(this.products=e.data,this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1},error:()=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1}})}editPurchaseOrder(e){e&&(localStorage.setItem("purchaseOrderId",this.encryptionService.encrypt(e.toString())),this.router.navigate(["/purchase-order/create"]))}sanitizeHtml(e){return this.sanitizer.bypassSecurityTrustHtml(e)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.pendingItems=[],this.customers=[],this.products=[]}static{this.\u0275fac=function(r){return new(r||s)(O(U),O(X),O(J),O(me),O(H),O(Y),O(K),O(ke),O(Ie))}}static{this.\u0275cmp=D({type:s,selectors:[["app-purchase-order-item-pending"]],standalone:!0,features:[L],decls:43,vars:19,consts:[[1,"po-pending-container"],[1,"header"],[1,"lede"],["aria-labelledby","filters-heading",1,"search-card"],[1,"search-card-header"],["id","filters-heading"],[1,"muted"],["aria-label","Pending purchase order item filters",1,"search-form",3,"ngSubmit","formGroup"],[1,"form-group"],[1,"product-select-group"],["formControlName","productId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Products",1,"btn","btn-sm","btn-primary","refresh",3,"click","touchstart","disabled"],[1,"fas",3,"ngClass"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","touchstart","disabled"],[1,"buttons"],["type","button",1,"btn","btn-secondary",3,"click","touchstart"],["type","button",1,"btn","btn-primary",3,"click","touchstart","disabled"],["aria-labelledby","results-heading",1,"results-card"],[1,"results-card-header"],["id","results-heading"],["class","table-container",4,"ngIf"],["class","loading",4,"ngIf"],["class","no-results",4,"ngIf"],["class","pagination",4,"ngIf"],[1,"table-container"],[4,"ngFor","ngForOf"],[3,"innerHTML"],[1,"action-cell"],["title","Open purchase order",1,"btn-icon","edit",3,"click","touchstart"],[1,"fas","fa-external-link-alt"],[1,"loading"],[1,"no-results"],[1,"pagination"],[1,"page-info"],[1,"pagination-controls"],[1,"page-button",3,"click","touchstart","disabled"],["class","page-button",3,"active","click","touchstart",4,"ngFor","ngForOf"],[1,"page-button",3,"click","touchstart"]],template:function(r,t){r&1&&(n(0,"section",0)(1,"header",1)(2,"div")(3,"h1"),a(4,"Pending Purchase Order Items"),i(),n(5,"p",2),a(6,"Review and act on items that are still pending across purchase orders."),i()()(),n(7,"section",3)(8,"div",4)(9,"h2",5),a(10,"Filters"),i(),n(11,"p",6),a(12,"Refine by order, product, or customer to focus on what matters."),i()(),n(13,"form",7),_("ngSubmit",function(d){return t.onSubmit(d)}),n(14,"div",8)(15,"label"),a(16,"Product"),i(),n(17,"div",9),u(18,"app-searchable-select",10),n(19,"button",11),_("click",function(){return t.refreshProducts()})("touchstart",function(d){return d.preventDefault()}),u(20,"i",12),i()()(),n(21,"div",8)(22,"label"),a(23,"Customer"),i(),n(24,"div",9),u(25,"app-searchable-select",13),n(26,"button",14),_("click",function(){return t.refreshCustomers()})("touchstart",function(d){return d.preventDefault()}),u(27,"i",12),i()()()(),n(28,"div",15)(29,"button",16),_("click",function(){return t.resetForm()})("touchstart",function(d){return d.preventDefault()}),a(30,"Reset"),i(),n(31,"button",17),_("click",function(d){return t.onSubmit(d)})("touchstart",function(d){return d.preventDefault()}),a(32),i()()(),n(33,"section",18)(34,"div",19)(35,"h2",20),a(36,"Results"),i(),n(37,"p",6),a(38,"Track quantity, fulfillment progress, and amounts for each pending item."),i()(),y(39,Pt,30,1,"div",21)(40,Ct,3,0,"div",22)(41,Ot,3,0,"div",23)(42,yt,9,6,"div",24),i()()),r&2&&(c(13),l("formGroup",t.searchForm),c(5),l("options",t.products)("defaultOption",ee(17,ft))("searchPlaceholder","Search products..."),c(),l("disabled",t.isLoadingProducts),c(),l("ngClass",t.isLoadingProducts?"fa-spinner fa-spin":"fa-sync-alt"),c(5),l("options",t.customers)("defaultOption",ee(18,_t))("searchPlaceholder","Search customers..."),c(),l("disabled",t.isLoadingCustomers),c(),l("ngClass",t.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt"),c(4),l("disabled",t.loading),c(),S(" ",t.loading?"Searching...":"Search"," "),c(7),l("ngIf",!t.loading&&t.pendingItems.length>0),c(),l("ngIf",t.loading),c(),l("ngIf",!t.loading&&t.pendingItems.length===0),c(),l("ngIf",!t.loading&&t.pendingItems.length>0&&t.totalPages>1))},dependencies:[A,z,j,$,se,T,q,G,Q,R,B,le,F,N],styles:["[_ngcontent-%COMP%]:root{--primary: #003a58;--primary-light: #2a5f79;--primary-lighter: #4f7f94;--primary-lightest: #a6c0cd;--primary-dark: #00263a;--secondary: #00999c;--secondary-light: #26b3b5;--secondary-lighter: #6bcfd1;--secondary-lightest: #b9ebec;--secondary-dark: #007275;--neutral-dark: #3b4248;--neutral-medium: #8a949c;--neutral-light: #b3bcc2;--neutral-lighter: #d7dee2;--neutral-lightest: #f4f7f9;--accent: #264b55;--success: #1e9e68;--warning: #c98200;--error: #c23b3b;--info: #2aa6c2;--background: #f4f7f9;--text-primary: #3b4248;--text-secondary: #8a949c;--supporting: #b3bcc2}.po-pending-container[_ngcontent-%COMP%]{padding:2rem;background-color:var(--background);min-height:100vh;display:flex;flex-direction:column;gap:1.25rem}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:.75rem}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.8rem}.header[_ngcontent-%COMP%]   .lede[_ngcontent-%COMP%]{margin:4px 0 0;color:var(--text-muted);font-size:.95rem}.search-card[_ngcontent-%COMP%], .results-card[_ngcontent-%COMP%]{background:#fff;border-radius:0;box-shadow:0 2px 4px #0000001a;padding:20px}.search-card-header[_ngcontent-%COMP%], .results-card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;margin-bottom:12px}.search-card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .results-card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.5rem}.search-card-header[_ngcontent-%COMP%]   .muted[_ngcontent-%COMP%], .results-card-header[_ngcontent-%COMP%]   .muted[_ngcontent-%COMP%]{margin:0;color:var(--text-muted);font-size:.9rem}.search-form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1rem}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary)}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px;border:1px solid var(--supporting);border-radius:4px;font-size:14px;height:40px;transition:border-color .2s ease,box-shadow .2s ease}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px #2980b92e}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{width:42px;height:40px;display:inline-flex;align-items:center;justify-content:center;padding:0;min-width:auto;touch-action:manipulation;-webkit-tap-highlight-color:transparent;border-radius:6px;border:1px solid var(--border-color);background:var(--primary);color:#fff}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary)}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.buttons[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-end}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;transition:all .2s ease;font-weight:600;touch-action:manipulation;-webkit-tap-highlight-color:transparent;min-width:110px;height:42px}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#001f2f}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(1px)}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background-color:var(--secondary);color:#fff}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#007173}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(1px)}.results-card[_ngcontent-%COMP%]{overflow-x:auto}.table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 10px;border-bottom:1px solid var(--supporting);text-align:left;vertical-align:middle}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:700;color:var(--text-primary);background:#00000005;white-space:nowrap}table[_ngcontent-%COMP%]   .subtext[_ngcontent-%COMP%]{color:var(--text-muted);font-size:12px}table[_ngcontent-%COMP%]   .action-cell[_ngcontent-%COMP%]{display:flex;gap:8px}table[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;touch-action:manipulation;-webkit-tap-highlight-color:transparent}table[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]{color:var(--primary);background-color:#1458811a}table[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}table[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.loading[_ngcontent-%COMP%], .no-results[_ngcontent-%COMP%]{padding:12px;color:var(--text-muted)}.pagination[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between;margin-top:12px}.pagination[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{font-size:14px;color:var(--text-muted)}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]{display:flex;gap:6px;flex-wrap:wrap}.pagination[_ngcontent-%COMP%]   .page-button[_ngcontent-%COMP%]{padding:8px 12px;border-radius:6px;border:1px solid var(--supporting);background:#fff;cursor:pointer;transition:all .2s ease;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.pagination[_ngcontent-%COMP%]   .page-button.active[_ngcontent-%COMP%]{background:var(--primary);color:#fff;border-color:var(--primary)}.pagination[_ngcontent-%COMP%]   .page-button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}@media (max-width: 768px){.po-pending-container[_ngcontent-%COMP%]{padding:1rem}.header[_ngcontent-%COMP%]{flex-direction:column}.buttons[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 8px}}"]})}}return s})();var xt=[{path:"",component:ge},{path:"create",component:re},{path:"edit/:id",component:re},{path:"pending-item",component:he}],Be=(()=>{class s{static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275mod=oe({type:s})}static{this.\u0275inj=ie({imports:[F.forChild(xt),F]})}}return s})();var _r=(()=>{class s{static{this.\u0275fac=function(r){return new(r||s)}}static{this.\u0275mod=oe({type:s})}static{this.\u0275inj=ie({imports:[A,T,F,Be,W,N,pe,ge,re,he]})}}return s})();export{_r as PurchaseOrderModule};
