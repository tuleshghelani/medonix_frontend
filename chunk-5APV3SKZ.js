import{a as Wt}from"./chunk-6S4QXFSH.js";import{a as pt,b as mt,c as Ut,d as ct,e as Bt,f as Gt,g as gt,h as Ce,i as Yt}from"./chunk-MW5Z3ZEZ.js";import{a as q,b as nt}from"./chunk-V5ULXMOS.js";import{$ as u,A as ce,Ab as U,Bb as dt,C as V,Ca as L,D as Nt,Da as X,Eb as B,Fb as Mt,G as le,Gb as xt,H as h,Ha as N,Hb as G,I as _,Ib as he,Ja as T,Jb as jt,Kb as Rt,L as ee,Ma as Ot,Mb as ut,Nb as _e,Ob as Y,P as Tt,Pa as F,Pb as ot,Qa as z,Qb as K,R as s,Ra as H,S as C,Sa as $,Tb as J,Ua as Vt,Ub as vt,Va as Lt,Wa as de,Xa as D,Xb as Q,Yb as fe,Z as M,Zb as it,_a as ue,a as ft,b as Et,ba as k,d as Dt,e as Ct,ea as o,f as W,fa as r,ga as d,gb as zt,ha as ne,ia as oe,ja as x,jb as pe,kb as ie,m as bt,ma as g,mb as $t,na as p,o as A,ob as re,q as Pt,sb as me,sc as tt,ta as a,tb as Z,tc as st,u as f,ua as y,ub as P,va as w,vb as j,vc as et,wb as R,wc as rt,x as se,xa as Qt,xb as ge,xc as Kt,y as At}from"./chunk-GXDI7YXY.js";var Ie=()=>({label:"All Status",value:""}),qe=()=>({label:"All Customers",value:""});function Fe(c,b){if(c&1){let t=x();o(0,"div",5)(1,"div",8),d(2,"app-searchable-select",24),o(3,"button",25),g("click",function(){h(t);let e=p();return _(e.refreshCustomers())}),d(4,"i",26),r()()()}if(c&2){let t=p();s(2),u("options",t.customers)("defaultOption",X(5,qe))("searchPlaceholder","Search customers..."),s(),u("disabled",t.isLoadingCustomers),s(),u("ngClass",t.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt")}}function Ee(c,b){if(c&1){let t=x();o(0,"button",27),g("click",function(){h(t);let e=p();return _(e.addQuotation())}),a(1,"Add Quotation"),r()}}function De(c,b){if(c&1){let t=x();o(0,"button",28),g("click",function(){h(t);let e=p();return _(e.addDealerOrder())}),d(1,"i",29),a(2," Place Order "),r()}}function Ae(c,b){if(c&1){let t=x();o(0,"button",41),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.toggleStatusDropdown(e))}),d(1,"i",42),r()}if(c&2){let t=p().$implicit;u("disabled",t.isUpdating)}}function Ne(c,b){if(c&1){let t=x();o(0,"div",45),g("click",function(){let e=h(t).$implicit,i=p(2).$implicit,l=p();return _(l.updateStatus(i,e.value))}),d(1,"i",26),a(2),r()}if(c&2){let t=b.$implicit,n=p(3);k("disabled",t.disabled),s(),u("ngClass",n.getStatusIcon(t.value)),s(),w(" ",t.label," ")}}function Te(c,b){if(c&1&&(o(0,"div",43),M(1,Ne,3,4,"div",44),r()),c&2){let t=p().$implicit,n=p();s(),u("ngForOf",n.getAvailableStatusOptions(t.status))}}function Qe(c,b){if(c&1){let t=x();o(0,"button",46),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.editQuotation(e.id))}),d(1,"i",47),r()}}function Ve(c,b){if(c&1){let t=x();o(0,"button",48),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.dispatchQuotation(e.id))}),d(1,"i",49),r()}}function Le(c,b){if(c&1){let t=x();o(0,"button",50),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.deleteQuotation(e.id))}),d(1,"i",51),r()}}function ze(c,b){if(c&1){let t=x();o(0,"tr")(1,"td"),a(2),r(),o(3,"td"),a(4),r(),o(5,"td"),a(6),o(7,"button",30),g("click",function(){let e=h(t).$implicit,i=p();return _(i.openWhatsApp(e.contactNumber))}),d(8,"i",31),r()(),o(9,"td"),a(10),N(11,"date"),r(),o(12,"td"),a(13),N(14,"date"),r(),o(15,"td"),a(16),N(17,"currency"),r(),o(18,"td")(19,"div",32)(20,"span",33),d(21,"i",26),a(22),r(),M(23,Ae,2,1,"button",34)(24,Te,2,1,"div",35),r()(),o(25,"td",36),M(26,Qe,2,0,"button",37)(27,Ve,2,0,"button",38),o(28,"button",39),g("click",function(){let e=h(t).$implicit,i=p();return _(i.generatePdf(e.id,e))}),d(29,"i",26),r(),M(30,Le,2,0,"button",40),r()()}if(c&2){let t=b.$implicit,n=b.index,e=p();s(2),y(e.startIndex+n+1),s(2),y(t.quoteNumber),s(2),w("",t.customerName," "),s(4),y(T(11,16,t.quoteDate,"dd-MM-yyyy")),s(3),y(T(14,19,t.validUntil,"dd-MM-yyyy")),s(3),y(T(17,22,t.totalAmount,"INR")),s(4),u("ngClass",e.getStatusClass(t.status)),s(),u("ngClass",e.getStatusIcon(t.status)),s(),w(" ",e.getStatusLabel(t.status)," "),s(),u("ngIf",e.canChangeStatus(t.status)&&e.canEditQuotation()),s(),u("ngIf",t.showStatusDropdown&&e.canEditQuotation()),s(2),u("ngIf",e.canEditQuotation()),s(),u("ngIf",e.canDispatchQuotation()),s(),u("disabled",t.isPrinting),s(),u("ngClass",t.isPrinting?"fa-spinner fa-spin":"fa-print"),s(),u("ngIf",e.canEditQuotation()&&(t.status=="D"||t.status=="Q"||t.status=="A"||t.status=="C"||t.status=="PC"))}}function $e(c,b){if(c&1){let t=x();o(0,"app-pagination",52),g("pageChange",function(e){h(t);let i=p();return _(i.onPageChange(e))})("pageSizeChange",function(e){h(t);let i=p();return _(i.onPageSizeChange(e))}),r()}if(c&2){let t=p();u("currentPage",t.currentPage)("pageSize",t.pageSize)("totalElements",t.totalElements)("pageSizeOptions",t.pageSizeOptions)}}var Xt=(()=>{class c{constructor(t,n,e,i,l,m,O,S,v,I){this.quotationService=t,this.customerService=n,this.fb=e,this.snackbar=i,this.dialog=l,this.modalService=m,this.dateUtils=O,this.encryptionService=S,this.router=v,this.authService=I,this.quotations=[],this.isLoading=!1,this.statusOptions=[],this.currentPage=0,this.pageSize=10,this.pageSizeOptions=[5,10,25,50,100],this.totalPages=0,this.totalElements=0,this.startIndex=0,this.endIndex=0,this.selectedQuotation=null,this.products=[],this.isLoadingProducts=!1,this.customers=[],this.isLoadingCustomers=!1,this.destroy$=new W,this.isDealerUser=!1,this.initializeForm(),this.statusOptions=Object.entries(q).map(([E,at])=>({label:at,value:E})),this.setupClickOutsideListener()}ngOnInit(){this.isDealerUser=this.authService.hasRole(pt.DEALER),this.loadQuotations(),this.isDealerUser||this.loadCustomers()}initializeForm(){this.searchForm=this.fb.group({search:[""],customerId:[""],startDate:[""],endDate:[""],status:null})}loadQuotations(){this.isLoading=!0;let t=ft({currentPage:this.currentPage,perPageRecord:this.pageSize,startDate:this.searchForm.value.startDate?this.dateUtils.formatDate(this.searchForm.value.startDate):"",endDate:this.searchForm.value.endDate?this.dateUtils.formatDate(this.searchForm.value.endDate):""},this.searchForm.value);this.quotationService.searchQuotations(t).pipe(f(this.destroy$)).subscribe({next:n=>{this.quotations=n.content.map(e=>Et(ft({},e),{showStatusDropdown:!1})),this.totalPages=n.totalPages,this.totalElements=n.totalElements,this.startIndex=this.currentPage*this.pageSize,this.endIndex=Math.min((this.currentPage+1)*this.pageSize,this.totalElements),this.isLoading=!1},error:n=>{this.snackbar.error(n.message||"Failed to load quotations"),this.isLoading=!1}})}onSearch(){this.currentPage=0,this.loadQuotations()}onPageChange(t){this.currentPage=t,this.loadQuotations()}onPageSizeChange(t){this.pageSize=t,this.currentPage=0,this.loadQuotations()}openSaleModal(t){this.selectedQuotation=t,this.modalService.open("sale")}deleteQuotation(t){confirm("Are you sure you want to delete this quotation? This action cannot be undone.")&&(this.isLoading=!0,this.quotationService.deleteQuotation(t).pipe(f(this.destroy$)).subscribe({next:()=>{this.snackbar.success("Quotation deleted successfully"),this.loadQuotations()},error:n=>{this.snackbar.error(n?.error?.message||"Failed to delete quotation"),this.isLoading=!1}}))}loadCustomers(){this.isDealerUser||(this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}}))}refreshCustomers(){this.isDealerUser||(this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}}))}resetForm(){this.searchForm.reset(),this.currentPage=0,this.loadQuotations()}getStatusLabel(t){return q[t]||t}getStatusClass(t){return{Q:"status-quote",A:"status-accepted",D:"status-declined",R:"status-ready",P:"status-processing",PC:"status-packaging",C:"status-completed",I:"status-invoiced"}[t]||"status-default"}generatePdf(t,n){n&&(n.isPrinting=!0,this.quotationService.generatePdf(t).pipe(f(this.destroy$)).subscribe({next:e=>{let i=window.URL.createObjectURL(e.blob),l=document.createElement("a");l.href=i,l.download="quotation-"+n.customerName+".pdf",l.click(),window.URL.revokeObjectURL(i),n.isPrinting=!1},error:()=>{this.snackbar.error("Failed to generate PDF"),n.isPrinting=!1}}))}generateDispatchPdf(t,n){n&&(n.isPrinting=!0,this.quotationService.generateDispatchPdf(t,null).pipe(f(this.destroy$)).subscribe({next:e=>{let i=window.URL.createObjectURL(e.blob),l=document.createElement("a");l.href=i,l.download="dispatch-slip.pdf",l.click(),window.URL.revokeObjectURL(i),n.isPrinting=!1},error:()=>{this.snackbar.error("Failed to generate PDF"),n.isPrinting=!1}}))}getStatusIcon(t){return{Q:"fa-file-alt",A:"fa-check-circle",D:"fa-times-circle",R:"fa-clock",P:"fa-spinner fa-spin",PC:"fa-spinner fa-spin",C:"fa-check-double",I:"fa-file-invoice"}[t]||"fa-question-circle"}setupClickOutsideListener(){this.clickListener=t=>{document.querySelectorAll(".status-container").forEach(e=>{e.contains(t.target)||this.quotations.forEach(i=>i.showStatusDropdown=!1)})},document.addEventListener("click",this.clickListener)}toggleStatusDropdown(t){event?.stopPropagation(),this.quotations.forEach(n=>{n!==t&&(n.showStatusDropdown=!1)}),t.showStatusDropdown=!t.showStatusDropdown}canChangeStatus(t){return["D","Q","A","P","PC","C"].includes(t)}updateStatus(t,n){!t||t.isUpdating||(t.isUpdating=!0,t.showStatusDropdown=!1,this.quotationService.updateQuotationStatus(t.id,n).pipe(f(this.destroy$)).subscribe({next:()=>{t.status=n,this.snackbar.success("Status updated successfully"),t.isUpdating=!1},error:e=>{this.snackbar.error(e?.error?.message||"Failed to update status"),t.isUpdating=!1}}))}getAvailableStatusOptions(t){switch(t){case"Q":return[{label:q.A,value:"A",disabled:!1},{label:q.D,value:"D",disabled:!1}];case"A":return[{label:q.P,value:"P",disabled:!1},{label:q.D,value:"D",disabled:!1}];case"P":return[{label:q.C,value:"C",disabled:!1}];case"D":return[{label:q.A,value:"A",disabled:!1}];case"C":return[{label:q.I,value:"I",disabled:!1}];case"I":return[];default:return[]}}editQuotation(t){t&&(localStorage.setItem("editQuotationId",this.encryptionService.encrypt(t.toString())),this.router.navigate(["/quotation/create"]))}addQuotation(){localStorage.removeItem("editQuotationId"),this.router.navigate(["/quotation/create"])}addDealerOrder(){this.router.navigate(["/quotation/dealer-order"])}canEditQuotation(){return this.authService.isAdmin()||this.authService.isStaffAdmin()}canDispatchQuotation(){return this.authService.isAdmin()||this.authService.isStaffAdmin()}dispatchQuotation(t){t&&(localStorage.setItem("editQuotationId",this.encryptionService.encrypt(t.toString())),this.router.navigate(["/quotation/dispatch"]))}openWhatsApp(t){let n=String(t??"").replace(/\D/g,"");if(!n)return;let i=`whatsapp://send?phone=${n.length===10?`91${n}`:n}`;try{window.location.href=i}catch{}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.clickListener&&(document.removeEventListener("click",this.clickListener),this.clickListener=null),this.quotations=[],this.products=[],this.customers=[],this.statusOptions=[],this.selectedQuotation=null}static{this.\u0275fac=function(n){return new(n||c)(C(nt),C(rt),C(Y),C(tt),C(Gt),C(Yt),C(Kt),C(it),C(J),C(mt))}}static{this.\u0275cmp=V({type:c,selectors:[["app-quotation"]],standalone:!0,features:[L],decls:52,vars:11,consts:[[1,"quotation-container"],[3,"show"],[1,"search-section","card"],[3,"ngSubmit","formGroup"],[1,"search-controls"],[1,"form-group"],["type","text","formControlName","search","placeholder","Search by invoice number...",1,"form-control"],["class","form-group",4,"ngIf"],[1,"product-select-group"],["formControlName","status","labelKey","label","valueKey","value",3,"options","defaultOption","searchPlaceholder"],["type","date","formControlName","startDate","placeholder","Start Date",1,"form-control"],["type","date","formControlName","endDate","placeholder","End Date",1,"form-control"],[1,"button-group"],["type","submit",1,"search-btn","btn","btn-sm","btn-primary"],[1,"fas","fa-search"],["type","button",1,"search-btn","btn","btn-sm","btn-secondary",3,"click"],[1,"fas","fa-undo"],["class","btn btn-sm btn-primary mb-2",3,"click",4,"ngIf"],["class","btn btn-sm btn-secondary mb-2 ms-2",3,"click",4,"ngIf"],[1,"quotations-list","card"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],[3,"currentPage","pageSize","totalElements","pageSizeOptions","pageChange","pageSizeChange",4,"ngIf"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],[1,"fas",3,"ngClass"],[1,"btn","btn-sm","btn-primary","mb-2",3,"click"],[1,"btn","btn-sm","btn-secondary","mb-2","ms-2",3,"click"],[1,"fas","fa-shopping-cart"],["title","Open WhatsApp",1,"btn-icon","whatsapp",3,"click"],[1,"fab","fa-whatsapp"],[1,"status-container"],[1,"status-badge",3,"ngClass"],["class","btn-icon status-change",3,"disabled","click",4,"ngIf"],["class","status-dropdown",4,"ngIf"],[1,"actions"],["class","btn-icon edit","title","Edit quotation",3,"click",4,"ngIf"],["class","btn-icon edit","title","Dispatch quotation",3,"click",4,"ngIf"],["title","Print quotation",1,"btn-icon","print",3,"click","disabled"],["class","btn-icon delete","title","Delete quotation",3,"click",4,"ngIf"],[1,"btn-icon","status-change",3,"click","disabled"],[1,"fas","fa-chevron-down"],[1,"status-dropdown"],["class","status-option",3,"disabled","click",4,"ngFor","ngForOf"],[1,"status-option",3,"click"],["title","Edit quotation",1,"btn-icon","edit",3,"click"],[1,"fas","fa-edit"],["title","Dispatch quotation",1,"btn-icon","edit",3,"click"],[1,"fas","fa-truck-loading"],["title","Delete quotation",1,"btn-icon","delete",3,"click"],[1,"fas","fa-trash"],[3,"pageChange","pageSizeChange","currentPage","pageSize","totalElements","pageSizeOptions"]],template:function(n,e){n&1&&(o(0,"div",0),d(1,"app-loader",1),o(2,"div",2)(3,"h2"),a(4,"Search Quotation"),r(),o(5,"form",3),g("ngSubmit",function(){return e.onSearch()}),o(6,"div",4)(7,"div",5),d(8,"input",6),r(),M(9,Fe,5,6,"div",7),o(10,"div",5)(11,"div",8),d(12,"app-searchable-select",9),r()(),o(13,"div",5),d(14,"input",10),r(),o(15,"div",5),d(16,"input",11),r(),o(17,"div",12)(18,"button",13),d(19,"i",14),a(20," Search "),r(),o(21,"button",15),g("click",function(){return e.resetForm()}),d(22,"i",16),a(23," Reset "),r()()()()(),M(24,Ee,2,0,"button",17)(25,De,3,0,"button",18),o(26,"div",19)(27,"h2"),a(28,"Quotations"),r(),o(29,"div",20)(30,"table",21)(31,"thead")(32,"tr")(33,"th"),a(34,"No"),r(),o(35,"th"),a(36,"Invoice No."),r(),o(37,"th"),a(38,"Customer Name"),r(),o(39,"th"),a(40,"Quotation Date"),r(),o(41,"th"),a(42,"Valid Until"),r(),o(43,"th"),a(44,"Total Quotation Amount"),r(),o(45,"th"),a(46,"Status"),r(),o(47,"th"),a(48,"Actions"),r()()(),o(49,"tbody"),M(50,ze,31,25,"tr",22),r()()(),M(51,$e,1,4,"app-pagination",23),r()()),n&2&&(s(),u("show",e.isLoading),s(4),u("formGroup",e.searchForm),s(4),u("ngIf",!e.isDealerUser),s(3),u("options",e.statusOptions)("defaultOption",X(10,Ie))("searchPlaceholder","Search status..."),s(12),u("ngIf",e.canEditQuotation()),s(),u("ngIf",e.isDealerUser),s(25),u("ngForOf",e.quotations),s(),u("ngIf",e.totalPages>0))},dependencies:[D,z,H,$,de,Vt,K,U,Z,j,R,B,G,ot,Q,gt,st,et,Ut],styles:[".quotation-container[_ngcontent-%COMP%]{padding:2rem;position:relative;min-height:200px;background-color:var(--background)}.quotation-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fff;border-radius:0;box-shadow:0 2px 4px #0000001a;margin-bottom:20px;padding:20px}.quotation-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-primary);font-size:1.5rem}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;align-items:flex-start}@media (max-width: 768px){.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{grid-template-columns:1fr}}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin:0;height:100%}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:38px;box-sizing:border-box}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;height:100%}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1;height:38px}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]     .dropdown-btn{height:38px;box-sizing:border-box;display:flex;align-items:center}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%], .quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{width:38px;height:38px;padding:0;margin-top:0!important;display:flex;align-items:center;justify-content:center;border:1px solid var(--border-color);border-radius:var(--border-radius);background:var(--primary)}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:hover:not(:disabled), .quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary-dark)}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:disabled, .quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;height:100%}@media (max-width: 768px){.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{grid-column:1/-1}}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;height:38px;display:flex;align-items:center;justify-content:center;gap:.5rem}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:inline-flex;align-items:center;justify-content:center;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]{color:#ff9800;background-color:#ff98001a}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#ff9800;color:#fff;transform:translateY(-1px)}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-secondary);white-space:nowrap}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{width:auto;min-width:80px;padding:.5rem;margin-bottom:0;height:38px}@media (max-width: 768px){.quotation-container[_ngcontent-%COMP%]{padding:1rem}.quotation-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.quotation-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .quotation-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (max-width: 576px){.table-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:flex-start}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{width:100%}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{flex:1}}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding-bottom:20px;justify-content:flex-start}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.actions[_ngcontent-%COMP%]   .btn-icon.sale[_ngcontent-%COMP%]{color:var(--primary);background-color:#fd78231a}.actions[_ngcontent-%COMP%]   .btn-icon.sale[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.sale[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]{color:#dc3545;background-color:#dc35451a}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:active{transform:translateY(0)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{padding:6px}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}}  .custom-snackbar.success{background-color:var(--accent2)}  .custom-snackbar.error{background-color:#dc3545}  .custom-snackbar .snackbar-message{display:flex;align-items:center;gap:.5rem;color:#fff}  .custom-snackbar .snackbar-message i{font-size:1.2rem}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:var(--primary)}.product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:flex-start}.product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{background-color:var(--background);color:#fff;width:42px;height:35px;border-radius:6px;transition:all .2s ease}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:active{transform:translateY(0)}.status-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:var(--border-radius);font-size:.875rem;font-weight:600;text-align:center;display:inline-flex;align-items:center;justify-content:center;min-width:120px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease;gap:.5rem}.status-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.status-badge[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px #00000026}.status-badge.status-quote[_ngcontent-%COMP%]{color:var(--info);border:1px solid var(--info)}.status-badge.status-accepted[_ngcontent-%COMP%]{color:var(--success);border:1px solid var(--success)}.status-badge.status-declined[_ngcontent-%COMP%]{color:var(--danger);border:1px solid var(--danger)}.status-badge.status-ready[_ngcontent-%COMP%]{color:var(--warning);border:1px solid var(--warning)}.status-badge.status-processing[_ngcontent-%COMP%]{color:var(--primary);border:1px solid var(--primary)}.status-badge.status-completed[_ngcontent-%COMP%]{color:var(--success);border:1px solid var(--success)}.status-badge.status-default[_ngcontent-%COMP%]{color:var(--gray);border:1px solid var(--gray)}.status-container[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;gap:.5rem}.status-container[_ngcontent-%COMP%]   .status-change[_ngcontent-%COMP%]{padding:4px 8px;color:var(--text-secondary);border-radius:var(--border-radius);transition:all .2s ease;background:none;border:none;cursor:pointer;z-index:1}.status-container[_ngcontent-%COMP%]   .status-change[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--background);color:var(--text-primary)}.status-container[_ngcontent-%COMP%]   .status-change[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 5px);right:0;background:#fff;border-radius:var(--border-radius);box-shadow:0 2px 8px #00000026;z-index:1000;min-width:150px;border:1px solid var(--border-color);display:block}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]   .status-option[_ngcontent-%COMP%]{padding:.75rem 1rem;display:flex;align-items:center;gap:.75rem;cursor:pointer;transition:all .2s ease}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]   .status-option[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--background-light)}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]   .status-option.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}"]})}}return c})();var kt=function(c){return c.O="Open",c.I="In Progress",c.C="Completed",c.B="Billed",c}(kt||{});var be=(()=>{class c{constructor(t){this.http=t,this.apiUrl=`${fe.apiUrl}/api/price`}getLatestPrices(t){return this.http.post(`${this.apiUrl}/latest`,t)}static{this.\u0275fac=function(n){return new(n||c)(ce(ue))}}static{this.\u0275prov=se({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();function Be(c,b){c&1&&(o(0,"div",66),a(1," Customer name is required "),r())}function Ge(c,b){c&1&&(o(0,"div",66),a(1," Contact Number is required "),r())}function Ye(c,b){c&1&&(o(0,"div",66),a(1," Valid until date is required and must be after quote date "),r())}function Ke(c,b){if(c&1){let t=x();o(0,"button",79),g("click",function(){h(t);let e=p().index,i=p();return _(i.removeItem(e))})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(1,"i",80),r()}}function We(c,b){if(c&1){let t=x();o(0,"tr",67)(1,"td")(2,"div",68)(3,"div",15)(4,"app-searchable-select",69),g("selectionChange",function(e){let i=h(t).index,l=p();return _(l.onProductSelect(i,e))}),r(),o(5,"button",70),g("click",function(){h(t);let e=p();return _(e.refreshProducts())})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(6,"i",6),r()()()(),o(7,"td")(8,"div",48)(9,"input",71),g("input",function(){let e=h(t).index,i=p();return _(i.calculateItemPrice(e))})("touchstart",function(e){return h(t),_(e.preventDefault())}),r()()(),o(10,"td")(11,"div",48)(12,"input",72),g("touchstart",function(e){return h(t),_(e.preventDefault())}),r()()(),o(13,"td"),d(14,"input",73),r(),o(15,"td")(16,"div",48),d(17,"input",74),r()(),o(18,"td")(19,"div",48),d(20,"input",75),r()(),o(21,"td")(22,"div",48),d(23,"input",76),r()(),o(24,"td")(25,"div",48),d(26,"input",77),r()(),o(27,"td"),a(28),r(),o(29,"td"),M(30,Ke,2,0,"button",78),r()()}if(c&2){let t,n,e=b.$implicit,i=b.index,l=p();u("formGroupName",i),s(4),k("is-invalid",l.isItemFieldInvalid(i,"productId")),u("formControlName","productId")("options",l.products)("labelKey","name")("valueKey","id")("placeholder","Select Product")("searchPlaceholder","Search products...")("focusWidthPx",400),s(),u("disabled",l.isLoadingProducts),s(),u("ngClass",l.isLoadingProducts?"fa-spinner fa-spin":"fa-sync-alt"),s(3),k("is-invalid",l.isItemFieldInvalid(i,"quantity")),s(3),k("is-invalid",l.isItemFieldInvalid(i,"unitPrice")),s(16),w(" ",l.getQuotationItemStatusLabel((t=e.get("quotationItemStatus"))==null?null:t.value)," "),s(2),u("ngIf",(e==null||(n=e.get("quotationItemStatus"))==null?null:n.value)!=="B")}}function Xe(c,b){c&1&&d(0,"app-loader")}var Ft=(()=>{class c{get itemsFormArray(){return this.quotationForm.get("items")}constructor(t,n,e,i,l,m,O,S,v,I,E){this.fb=t,this.quotationService=n,this.productService=e,this.customerService=i,this.transportService=l,this.priceService=m,this.snackbar=O,this.encryptionService=S,this.router=v,this.dialog=I,this.cdr=E,this.products=[],this.customers=[],this.transports=[],this.loading=!1,this.isLoadingProducts=!1,this.isLoadingCustomers=!1,this.isLoadingTransports=!1,this.destroy$=new W,this.isLoading=!1,this.isEdit=!1,this.totals={price:0,tax:0,finalPrice:0,taxPercentage:0,afterQuotationDiscount:0,quotationDiscountAmount:0},this.itemSubscriptions=[],this.productPriceCache=new Map,this.isLoadingPrices=!1,this.loadingPriceIndex=null,this.touchStartTime=0,this.touchStartX=0,this.touchStartY=0,this.isTouchScrolling=!1;let at=new Date;this.minValidUntilDate=F(at,"yyyy-MM-dd","en"),this.initForm()}ngOnInit(){this.loadProducts(),this.loadCustomers(),this.loadTransports(),this.setupCustomerNameSync(),this.setupCustomerChangeListener(),this.checkForEdit(),this.setupItemSubscriptions()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.itemSubscriptions.forEach(t=>t?.unsubscribe()),this.itemSubscriptions=[],this.productPriceCache.clear(),this.products=[],this.customers=[],this.transports=[]}initForm(){let t=new Date,n=new Date;n.setDate(t.getDate()+7),this.quotationForm=this.fb.group({customerId:[""],customerName:["",P.required],referenceName:[""],contactNumber:["",P.required],quoteDate:[F(t,"yyyy-MM-dd","en")],validUntil:[F(n,"yyyy-MM-dd","en"),[P.required]],remarks:[""],termsConditions:[""],items:this.fb.array([]),address:[""],quotationDiscountPercentage:[0,[P.required,P.min(0),P.max(100)]],transportMasterId:[null],caseNumber:[""],packagingAndForwadingCharges:[0,[P.required,P.min(0)]]}),this.addItem(!0),this.quotationForm.get("quotationDiscountPercentage")?.valueChanges.pipe(f(this.destroy$),A(100)).subscribe(e=>{console.log("Quotation discount percentage changed to:",e),this.itemsFormArray.controls.forEach((i,l)=>{this.calculateItemPrice(l)}),this.calculateTotalAmount(),this.cdr.detectChanges()}),this.quotationForm.get("packagingAndForwadingCharges")?.valueChanges.pipe(f(this.destroy$),A(100)).subscribe(()=>{this.calculateTotalAmount(),this.cdr.detectChanges()})}createItemFormGroup(t){return this.fb.group({id:[t?.id||""],productId:[t?.productId||"",P.required],productType:[t?.productType||""],quantity:[t?.quantity||1,[P.required,P.min(.001)]],unitPrice:[t?.unitPrice||0,[P.required,P.min(.01)]],quotationItemStatus:[t?.quotationItemStatus||null],remarks:[t?.remarks||""],price:[t?.price||0],taxPercentage:[{value:t?.taxPercentage??18}],taxAmount:[{value:t?.taxAmount||0,disabled:!0}],finalPrice:[{value:t?.finalPrice||0,disabled:!0}],quotationDiscountAmount:[{value:t?.quotationDiscountAmount||0,disabled:!0}],calculations:[t?.calculations||[]]})}feetInchValidator(t){return n=>{if(t==="SQ_FEET"){let e=n.get("feet")?.value||0,i=n.get("inch")?.value;if(e===0&&i===0)return{bothZero:!0}}return t==="MM"&&(n.get("mm")?.value||0)===0?{mmZero:!0}:null}}createCalculationGroup(t,n){return console.log("createCalculationGroup item : ",t),this.fb.group({mm:[t.mm,n==="MM"?P.required:null],feet:[t.feet],nos:[t.nos,P.required],weight:[t.weight,P.required],id:[t?.id],inch:[t.inch],sqFeet:[t.sqFeet,P.required],runningFeet:[t.runningFeet,P.required]},{validators:this.feetInchValidator(n)})}get isCustomerIdSelected(){return this.quotationForm?.get("customerId")?.value}setupCustomerNameSync(){this.quotationForm.get("customerId")?.valueChanges.pipe(f(this.destroy$)).subscribe(t=>{if(t){let n=this.customers.find(e=>e.id===t);n&&(this.quotationForm.patchValue({customerName:n.name}),this.quotationForm.patchValue({address:n.address}),this.quotationForm.patchValue({contactNumber:n.mobile}),this.quotationForm.patchValue({referenceName:n.referenceName}))}})}addItem(t=!1){let n=this.fb.group({id:[null],productId:["",P.required],productType:[""],quantity:[1,[P.required,P.min(.001)]],unitPrice:[0,[P.required,P.min(.01)]],remarks:[""],price:[0],taxPercentage:[18],taxAmount:[0],finalPrice:[0],quotationDiscountAmount:[0],calculations:[[]],quotationItemStatus:null});this.itemsFormArray.push(n);let e=this.itemsFormArray.length-1;this.setupItemCalculations(n,e),this.subscribeToItemChanges(this.itemsFormArray.at(e),e),this.calculateItemPrice(e,t),this.calculateTotalAmount()}removeItem(t){this.itemSubscriptions[t]&&(this.itemSubscriptions[t].unsubscribe(),this.itemSubscriptions.splice(t,1)),this.itemsFormArray.removeAt(t),this.itemsFormArray.controls.forEach((n,e)=>{this.itemSubscriptions[e]&&this.itemSubscriptions[e].unsubscribe(),this.subscribeToItemChanges(n,e)}),this.calculateTotalAmount(),this.cdr.detectChanges()}setupItemCalculations(t,n){t.get("productId")?.valueChanges.pipe(f(this.destroy$),bt(e=>!!e),A(100),Pt()).subscribe(e=>{console.log("Product ID changed to:",e);let i=this.products.find(l=>l.id===e);console.log("selectedProduct >>>",i),i&&(console.log(`Product tax percentage: ${i.taxPercentage!==void 0?i.taxPercentage:"not specified, using default 18"}%`),this.fetchProductPrice(n,i))}),t.get("quantity")?.valueChanges.pipe(f(this.destroy$),A(50)).subscribe(()=>this.calculateItemPrice(n)),t.get("unitPrice")?.valueChanges.pipe(f(this.destroy$),A(50)).subscribe(()=>this.calculateItemPrice(n)),t.get("taxPercentage")?.valueChanges.pipe(f(this.destroy$),A(50)).subscribe(()=>this.calculateItemPrice(n))}calculateItemPrice(t,n=!1){let e=this.itemsFormArray.at(t),i={quantity:Number(Number(e.get("quantity")?.value||0).toFixed(3)),unitPrice:Number(Number(e.get("unitPrice")?.value||0).toFixed(2)),taxPercentage:Number(e.get("taxPercentage")?.value??18)},l=Number(Number(this.quotationForm.get("quotationDiscountPercentage")?.value||0).toFixed(2));console.log(`Tax percentage used for calculation: ${i.taxPercentage}%`),console.log(`Quotation discount percentage on tax only: ${l}%`);let m=Number((i.quantity*i.unitPrice).toFixed(2)),O=Number((m*i.taxPercentage/100).toFixed(2)),S=Number((O*l/100).toFixed(2)),v=Number((O-S).toFixed(2)),I=Math.max(0,v),E=Number((m+I).toFixed(2));e.patchValue({price:m,quotationDiscountAmount:S,taxAmount:I,finalPrice:E},{emitEvent:!1}),console.log(`Item ${t} calculated:`,{quantity:i.quantity,unitPrice:i.unitPrice,basePrice:m,taxPercentage:i.taxPercentage,grossTaxAmount:O,quotationDiscountPercentage:l,quotationDiscountAmount:S,netTaxAmount:I,finalPrice:E}),this.calculateTotalAmount(),n||this.cdr.detectChanges()}getTotalAmount(){let t=this.itemsFormArray.controls.reduce((e,i)=>e+(Number(i.get("finalPrice").value)||0),0),n=Number(this.quotationForm.get("packagingAndForwadingCharges")?.value||0);return Math.round(t+n)}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data),this.isLoadingProducts=!1},error:t=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1}})}loadTransports(){this.isLoadingTransports=!0,this.transportService.getTransports({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t?.success!==!1&&(this.transports=t.data||t.transports||[]),this.isLoadingTransports=!1},error:()=>{this.snackbar.error("Failed to load transports"),this.isLoadingTransports=!1}})}refreshTransports(){this.isLoadingTransports=!0,this.transportService.refreshTransports().pipe(f(this.destroy$)).subscribe({next:t=>{t?.success!==!1&&(this.transports=t.data||t.transports||[],this.snackbar.success("Transports refreshed successfully")),this.isLoadingTransports=!1},error:()=>{this.snackbar.error("Failed to refresh transports"),this.isLoadingTransports=!1}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data,this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1},error:t=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1}})}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}})}calculateTotalAmount(){let t={price:0,tax:0,finalPrice:0,taxAmount:0,taxPercentage:0,quotationDiscountAmount:0};this.itemsFormArray.controls.forEach(l=>{let m=Number(Number(l.get("price")?.value||0).toFixed(2)),O=Number(Number(l.get("finalPrice")?.value||0).toFixed(2)),S=Number(Number(l.get("taxAmount")?.value||0).toFixed(2)),v=Number(l.get("taxPercentage")?.value||18),I=Number(Number(l.get("quotationDiscountAmount")?.value||0).toFixed(2));t.price=Number((t.price+m).toFixed(2)),t.tax=Number((t.tax+S).toFixed(2)),t.finalPrice=Number((t.finalPrice+O).toFixed(2)),t.taxAmount=Number((t.taxAmount+S).toFixed(2)),t.taxPercentage=Number(v),t.quotationDiscountAmount=Number((t.quotationDiscountAmount+I).toFixed(2))});let n=Number(Number(this.quotationForm.get("quotationDiscountPercentage")?.value||0).toFixed(2)),e=Number((t.price-t.quotationDiscountAmount).toFixed(2)),i=Number(this.quotationForm.get("packagingAndForwadingCharges")?.value||0);this.totals={price:Number((t.price+i).toFixed(2)),tax:t.tax,finalPrice:Number((t.finalPrice+i).toFixed(2)),taxPercentage:t.taxPercentage,afterQuotationDiscount:e,quotationDiscountAmount:t.quotationDiscountAmount}}resetForm(){let t=new Date,n=new Date;for(n.setDate(t.getDate()+7),this.quotationForm.reset({quoteDate:F(t,"yyyy-MM-dd","en"),validUntil:F(n,"yyyy-MM-dd","en"),remarks:"",termsConditions:"",quotationDiscountPercentage:0});this.itemsFormArray.length;)this.itemsFormArray.removeAt(0);this.addItem(),this.calculateTotalAmount(),this.cdr.detectChanges()}isFieldInvalid(t){let n=this.quotationForm.get(t);return n?n.invalid&&(n.dirty||n.touched):!1}isItemFieldInvalid(t,n){let e=this.itemsFormArray.at(t).get(n);if(!e)return!1;if(e.invalid&&(e.dirty||e.touched)){let l=e.errors;if(l&&(l.required||l.min&&(n==="quantity"||n==="unitPrice")))return!0}return!1}getFieldError(t){let n=this.quotationForm.get(t);if(n?.errors){if(n.errors.required)return`${t} is required`;if(n.errors.min)return`${t} must be greater than ${n.errors.min.min}`;if(n.errors.max)return`${t} must be less than ${n.errors.max.max}`}return""}markFormGroupTouched(t){Object.values(t.controls).forEach(n=>{n instanceof ge||n instanceof _e?this.markFormGroupTouched(n):(n.markAsTouched(),n.markAsDirty())})}onProductSelect(t,n){let e=this.products.find(m=>m.id===n.value);if(!e){console.warn("No product found with ID:",n.value);return}let i=this.itemsFormArray.at(t),l=this.itemSubscriptions[t];l&&(l.unsubscribe(),this.itemSubscriptions[t]=new Ct),i.patchValue({productId:e.id},{emitEvent:!0}),this.itemSubscriptions[t]||this.subscribeToItemChanges(i,t)}fetchProductPrice(t,n){console.log("Fetching price for product:",n.name);let e=this.itemsFormArray.at(t),i=n.taxPercentage!==void 0?n.taxPercentage:18;console.log(`Setting tax percentage for ${n.name}: ${i}%`),e.patchValue({productType:n.type,taxPercentage:i,quantity:n.quantity||1},{emitEvent:!1});let l=this.quotationForm.get("customerId")?.value;if(l){let m=`${l}-${n.id}`;if(this.productPriceCache.has(m)){e.patchValue({unitPrice:this.productPriceCache.get(m)},{emitEvent:!0}),this.calculateItemPrice(t);return}this.isLoadingPrices=!0,this.loadingPriceIndex=t,e.patchValue({unitPrice:n.saleAmount??n.sale_amount??0},{emitEvent:!0}),this.calculateItemPrice(t)}else e.patchValue({unitPrice:n.saleAmount??n.sale_amount??0},{emitEvent:!0}),this.calculateItemPrice(t)}validateDates(){let t=this.quotationForm.get("quoteDate")?.value,n=this.quotationForm.get("validUntil")?.value;t&&n&&new Date(n)<new Date(t)&&this.quotationForm.get("validUntil")?.setErrors({invalidDate:!0})}checkForEdit(){let t=localStorage.getItem("editQuotationId");if(t)try{let n=this.encryptionService.decrypt(t);if(!n){localStorage.removeItem("editQuotationId");return}this.isLoading=!0,this.quotationService.getQuotationDetail(parseInt(n)).pipe(f(this.destroy$)).subscribe({next:e=>{e&&(this.quotationId=parseInt(n),this.isEdit=!0,console.log("edit response >>",e.data),this.populateForm(e.data)),this.isLoading=!1},error:e=>{console.error("Error loading quotation details:",e),this.snackbar.error("Failed to load quotation details"),this.isLoading=!1,localStorage.removeItem("editQuotationId")}})}catch(n){console.error("Decryption error:",n),localStorage.removeItem("editQuotationId")}}populateForm(t){return Dt(this,null,function*(){if(t){for(console.log("Populating form with data:",t);this.itemsFormArray.length;)this.itemsFormArray.removeAt(0);this.quotationForm.patchValue({customerName:t.customerName,customerId:t.customerId,referenceName:t.referenceName||"",quoteDate:t.quoteDate,validUntil:t.validUntil,remarks:t.remarks||"",termsConditions:t.termsConditions||"",address:t.address,contactNumber:t.contactNumber,quotationDiscountPercentage:t.quotationDiscountPercentage||t.quotationDiscount||0,transportMasterId:t.transportMasterId||null,caseNumber:t.caseNumber||"",packagingAndForwadingCharges:t.packagingAndForwadingCharges??0}),t.items&&Array.isArray(t.items)&&t.items.forEach(n=>{let e=this.products.find(m=>m.id===n.productId),i=e?.taxPercentage!==void 0?e.taxPercentage:n.taxPercentage??18;console.log(`Loaded item ${n.productId} with tax percentage: ${i}%`);let l=this.fb.group({id:[n.id||null],productId:[n.productId||"",P.required],productType:[n.productType||""],quantity:[n.quantity||1,[P.required,P.min(.001)]],unitPrice:[n.unitPrice||0,[P.required,P.min(.01)]],remarks:[n.remarks||""],price:[n.price||0],taxPercentage:[i],taxAmount:[n.taxAmount||0],finalPrice:[n.finalPrice||0],quotationDiscountAmount:[n.quotationDiscountAmount||0],calculations:[n.calculations||[]],quotationItemStatus:[n.quotationItemStatus||null]});this.setupItemCalculations(l,this.itemsFormArray.length),this.itemsFormArray.push(l),this.subscribeToItemChanges(l,this.itemsFormArray.length-1)}),this.itemsFormArray.controls.forEach((n,e)=>{this.calculateItemPrice(e)}),this.calculateTotalAmount(),this.cdr.detectChanges()}})}onSubmit(){if(this.quotationForm.valid){this.isLoading=!0;let t=this.prepareFormData();(this.isEdit?this.quotationService.updateQuotation(this.quotationId,t):this.quotationService.createQuotation(t)).pipe(f(this.destroy$)).subscribe({next:e=>{e.success&&(this.snackbar.success(`Quotation ${this.isEdit?"updated":"created"} successfully`),this.quotationForm.reset(),this.router.navigate(["/quotation"])),this.isLoading=!1},error:e=>{this.snackbar.error(e?.error?.message||`Failed to ${this.isEdit?"update":"create"} quotation`),this.isLoading=!1}})}}prepareFormData(){let t=this.quotationForm.value,n=this.quotationForm.get("quotationDiscountPercentage"),e=Number(n?.value||0);console.log("Explicitly getting quotationDiscountPercentage:",e);let i=this.itemsFormArray.controls.map(m=>({id:m.get("id")?.value,productId:m.get("productId")?.value,productType:m.get("productType")?.value,quantity:m.get("quantity")?.value,unitPrice:m.get("unitPrice")?.value,remarks:m.get("remarks")?.value,price:m.get("price")?.value,taxPercentage:m.get("taxPercentage")?.value,taxAmount:m.get("taxAmount")?.value,finalPrice:m.get("finalPrice")?.value,quotationDiscountAmount:m.get("quotationDiscountAmount")?.value,calculations:m.get("calculations")?.value||[],quotationItemStatus:m.get("quotationItemStatus")?.value})),l={customerId:t.customerId,customerName:t.customerName,referenceName:t.referenceName,contactNumber:t.contactNumber,quoteDate:F(t.quoteDate,"yyyy-MM-dd","en"),validUntil:F(t.validUntil,"yyyy-MM-dd","en"),remarks:t.remarks,termsConditions:t.termsConditions,address:t.address,quotationDiscountPercentage:e,transportMasterId:t.transportMasterId,caseNumber:t.caseNumber,packagingAndForwadingCharges:Number(t.packagingAndForwadingCharges||0),items:i};return console.log("Final form data to be submitted:",l),l}setupItemSubscriptions(){this.itemsFormArray.controls.forEach((t,n)=>{this.subscribeToItemChanges(t,n)})}subscribeToItemChanges(t,n){this.itemSubscriptions[n]&&this.itemSubscriptions[n].unsubscribe();let e=t.valueChanges.pipe(f(this.destroy$),A(100)).subscribe(()=>{this.calculateItemPrice(n)});this.itemSubscriptions[n]=e}setupCustomerChangeListener(){this.quotationForm.get("customerId")?.valueChanges.pipe(f(this.destroy$)).subscribe(()=>{this.productPriceCache.clear()})}onQuotationDiscountPercentageChange(t){console.log("Quotation discount percentage changed to:",t.target.value);let n=Number(t.target.value||0);this.quotationForm.get("quotationDiscountPercentage")?.setValue(n,{emitEvent:!1}),this.itemsFormArray.controls.forEach((e,i)=>{this.calculateItemPrice(i)}),this.calculateTotalAmount(),this.cdr.detectChanges()}getQuotationItemStatusLabel(t){return t?{O:kt.O,I:kt.I,C:kt.C,B:kt.B}[t]||String(t):""}handleTouchStart(t){this.touchStartTime=Date.now(),this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY,this.isTouchScrolling=!1}handleTouchMove(t){let n=t.touches[0].clientX,e=t.touches[0].clientY,i=Math.abs(n-this.touchStartX),l=Math.abs(e-this.touchStartY);(i>10||l>10)&&(this.isTouchScrolling=!0)}handleTouchEnd(t){Date.now()-this.touchStartTime<200&&!this.isTouchScrolling&&t.preventDefault()}static{this.\u0275fac=function(n){return new(n||c)(C(Y),C(nt),C(ct),C(rt),C(Wt),C(be),C(tt),C(it),C(J),C(Bt),C(Ot))}}static{this.\u0275cmp=V({type:c,selectors:[["app-add-quotation"]],standalone:!0,features:[L],decls:179,vars:39,consts:[[1,"add-quotation-container"],["routerLink","/quotation",1,"btn","btn-sm","btn-secondary","back-btn"],[1,"fas","fa-arrow-left"],[1,"form-card"],[1,"card-header"],[1,"form-title"],[1,"fas",3,"ngClass"],[1,"quotation-form",3,"ngSubmit","keydown.enter","touchstart","touchmove","touchend","formGroup"],[1,"create-quotation-section"],[1,"create-quotation-header"],[1,"fa-solid","fa-receipt"],[1,"header-section"],[1,"form-row"],[1,"form-group"],[1,"fas","fa-user"],[1,"select-group"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","placeholder","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],[1,"fas","fa-user-tag"],[1,"required"],["type","text","formControlName","customerName","placeholder","Enter customer name",1,"form-control",3,"readonly"],["class","invalid-feedback",4,"ngIf"],[1,"fas","fa-id-card"],["type","text","formControlName","referenceName","placeholder","Optional reference name",1,"form-control"],[1,"fa-solid","fa-phone"],["type","text","formControlName","contactNumber","placeholder","Enter contact number",1,"form-control"],[1,"fa-solid","fa-location-dot"],["formControlName","address","rows","3","placeholder","Write customer address details...",1,"form-control"],[1,"fas","fa-calendar"],["type","date","formControlName","quoteDate","readonly","",1,"form-control"],[1,"fas","fa-calendar-check"],["type","date","formControlName","validUntil",1,"form-control",3,"min"],[1,"fas","fa-truck"],["formControlName","transportMasterId","labelKey","name","valueKey","id",3,"options","placeholder","searchPlaceholder"],["type","button","title","Refresh Transports",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],[1,"fas","fa-briefcase"],["type","text","formControlName","caseNumber","placeholder","Enter case number",1,"form-control"],["formArrayName","items",1,"products-section"],[1,"products-header"],[1,"fas","fa-boxes"],[1,"quotation-discount-wrapper"],["type","button",1,"btn","btn-sm","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"table-responsive"],[1,"table","products-table"],[3,"formGroupName",4,"ngFor","ngForOf"],["colspan","1",1,"text-end"],["colspan","1"],[1,"input-group"],["type","number","readonly","",1,"form-control",3,"value"],["colspan","2"],[1,"d-flex","mt-3"],[1,"form-group","w-50"],[1,"fas","fa-comment"],["formControlName","remarks","rows","3","placeholder","Optional remarks",1,"form-control"],[1,"fas","fa-file-contract"],["formControlName","termsConditions","rows","3","placeholder","Optional terms and conditions",1,"form-control"],[1,"fas","fa-box"],["type","number","formControlName","packagingAndForwadingCharges","min","0","step","0.01",1,"form-control"],[1,"quotation-summary"],[1,"summary-item"],[1,"form-actions"],["type","button",1,"btn","btn-sm","btn-secondary",3,"click","disabled"],[1,"fas","fa-undo"],["type","submit",1,"btn","btn-sm","btn-primary",3,"disabled"],[4,"ngIf"],[1,"invalid-feedback"],[3,"formGroupName"],[1,"form-field-container"],[3,"selectionChange","formControlName","options","labelKey","valueKey","placeholder","searchPlaceholder","focusWidthPx"],["type","button","title","Refresh Products",1,"btn","btn-sm","btn-primary","refresh",3,"click","touchstart","disabled"],["type","number","formControlName","quantity","min","0.001","step","0.001",1,"form-control",3,"input","touchstart"],["type","number","formControlName","unitPrice","min","0.01","step","0.01",1,"form-control",3,"touchstart"],["type","text","formControlName","remarks","placeholder","Remarks",1,"form-control"],["type","number","formControlName","price","readonly","",1,"form-control"],["type","number","formControlName","quotationDiscountAmount","readonly","",1,"form-control"],["type","number","formControlName","taxAmount","readonly","",1,"form-control"],["type","number","formControlName","finalPrice","readonly","",1,"form-control"],["type","button","class","btn btn-sm btn-danger",3,"click","touchstart",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-danger",3,"click","touchstart"],[1,"fa-solid","fa-trash"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"button",1),d(2,"i",2),a(3," Back to Quotations "),r(),o(4,"div",3)(5,"div",4)(6,"h2",5),d(7,"i",6),a(8),r()(),o(9,"form",7),g("ngSubmit",function(){return e.onSubmit()})("keydown.enter",function(l){return l.preventDefault()})("touchstart",function(l){return e.handleTouchStart(l)})("touchmove",function(l){return e.handleTouchMove(l)})("touchend",function(l){return e.handleTouchEnd(l)}),o(10,"div",8)(11,"div",9)(12,"h3"),d(13,"i",10),a(14," Create Quotation "),r()(),o(15,"div",11)(16,"div",12)(17,"div",13)(18,"label"),d(19,"i",14),a(20," Select Customer "),r(),o(21,"div",15),d(22,"app-searchable-select",16),o(23,"button",17),g("click",function(){return e.refreshCustomers()}),d(24,"i",6),r()()(),o(25,"div",13)(26,"label"),d(27,"i",18),a(28," Customer Name "),o(29,"span",19),a(30,"*"),r()(),d(31,"input",20),M(32,Be,2,0,"div",21),r(),o(33,"div",13)(34,"label"),d(35,"i",22),a(36," Reference Name "),r(),d(37,"input",23),r(),o(38,"div",13)(39,"label"),d(40,"i",24),a(41," Contact Number "),o(42,"span",19),a(43,"*"),r()(),d(44,"input",25),M(45,Ge,2,0,"div",21),r(),o(46,"div",13)(47,"label"),d(48,"i",26),a(49," Address "),r(),d(50,"textarea",27),r(),o(51,"div",13)(52,"label"),d(53,"i",28),a(54," Quote Date "),r(),d(55,"input",29),r(),o(56,"div",13)(57,"label"),d(58,"i",30),a(59," Valid Until "),o(60,"span",19),a(61,"*"),r()(),d(62,"input",31),M(63,Ye,2,0,"div",21),r(),o(64,"div",13)(65,"label"),d(66,"i",32),a(67," Transport "),r(),o(68,"div",15),d(69,"app-searchable-select",33),o(70,"button",34),g("click",function(){return e.refreshTransports()}),d(71,"i",6),r()()(),o(72,"div",13)(73,"label"),d(74,"i",35),a(75," Case Number "),r(),d(76,"input",36),r()()()(),o(77,"div",37)(78,"div",38)(79,"h3"),d(80,"i",39),a(81," Products"),r(),o(82,"div",40)(83,"button",41),g("click",function(){return e.addItem()}),d(84,"i",42),a(85," Add Product "),r()()(),o(86,"div",43)(87,"table",44)(88,"thead")(89,"tr")(90,"th"),a(91,"Product"),r(),o(92,"th"),a(93,"Quantity"),r(),o(94,"th"),a(95,"Unit Price"),r(),o(96,"th"),a(97,"Remarks"),r(),o(98,"th"),a(99,"Item Price"),r(),o(100,"th"),a(101,"Quotation Dis."),r(),o(102,"th"),a(103,"Tax (%)"),r(),o(104,"th"),a(105,"Final Price"),r(),o(106,"th"),a(107,"Status"),r(),o(108,"th"),a(109,"Actions"),r()()(),o(110,"tbody"),M(111,We,31,18,"tr",45),r(),o(112,"tfoot")(113,"tr")(114,"td",46)(115,"strong"),a(116,"Total:"),r()(),o(117,"td",46)(118,"strong"),a(119,"item price:"),r()(),o(120,"td",47)(121,"div",48),d(122,"input",49),r()(),o(123,"td",46)(124,"strong"),a(125,"dis.:"),r()(),o(126,"td",47)(127,"div",48),d(128,"input",49),r()(),o(129,"td",46)(130,"strong"),a(131,"tax price:"),r()(),o(132,"td",47)(133,"div",48),d(134,"input",49),r()(),o(135,"td",46)(136,"strong"),a(137,"final price:"),r()(),o(138,"td",50)(139,"div",48),d(140,"input",49),r()(),d(141,"td"),r()()()()(),o(142,"div",51)(143,"div",52)(144,"label"),d(145,"i",53),a(146," Remarks "),r(),d(147,"textarea",54),r(),o(148,"div",52)(149,"label"),d(150,"i",55),a(151," Terms & Conditions "),r(),d(152,"textarea",56),r()(),o(153,"div",51)(154,"div",52)(155,"label"),d(156,"i",57),a(157," Packaging & Forwarding Charges "),r(),d(158,"input",58),r()(),o(159,"div",59)(160,"div",60)(161,"span"),a(162,"Total Products:"),r(),o(163,"strong"),a(164),r()(),o(165,"div",60)(166,"span"),a(167,"Total Amount:"),r(),o(168,"strong"),a(169),N(170,"number"),r()()(),o(171,"div",61)(172,"button",62),g("click",function(){return e.resetForm()}),d(173,"i",63),a(174," Reset "),r(),o(175,"button",64),d(176,"i",6),a(177),r()()()()(),M(178,Xe,1,0,"app-loader",65)),n&2&&(s(7),u("ngClass",e.isEdit?"fa-edit":"fa-plus"),s(),w(" ",e.isEdit?"Edit":"Create New"," Quotation "),s(),u("formGroup",e.quotationForm),s(13),u("options",e.customers)("placeholder","Select Customer")("searchPlaceholder","Search customers..."),s(),u("disabled",e.isLoadingCustomers),s(),u("ngClass",e.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt"),s(7),k("is-invalid",e.isFieldInvalid("customerName")),u("readonly",e.isCustomerIdSelected),s(),u("ngIf",e.isFieldInvalid("customerName")),s(12),k("is-invalid",e.isFieldInvalid("contactNumber")),s(),u("ngIf",e.isFieldInvalid("contactNumber")),s(17),k("is-invalid",e.isFieldInvalid("validUntil")),u("min",e.minValidUntilDate),s(),u("ngIf",e.isFieldInvalid("validUntil")),s(6),u("options",e.transports)("placeholder","Select Transport")("searchPlaceholder","Search transports..."),s(),u("disabled",e.isLoadingTransports),s(),u("ngClass",e.isLoadingTransports?"fa-spinner fa-spin":"fa-sync-alt"),s(40),u("ngForOf",e.itemsFormArray.controls),s(11),u("value",e.totals.price),s(6),u("value",e.totals.quotationDiscountAmount),s(6),u("value",e.totals.tax),s(6),u("value",e.totals.finalPrice),s(24),y(e.itemsFormArray.length),s(5),y(T(170,36,e.getTotalAmount(),"1.2-2")),s(3),u("disabled",e.loading),s(3),u("disabled",e.quotationForm.invalid||e.loading),s(),u("ngClass",e.loading?"fa-spinner fa-spin":"fa-save"),s(),w(" ",e.isEdit?e.loading?"Updating...":"Update Quotation":e.loading?"Saving...":"Save Quotation"," "),s(),u("ngIf",e.loading))},dependencies:[et,D,z,H,$,Lt,K,U,Z,dt,j,R,ut,B,G,Mt,xt,ot,Q,vt,gt,st],styles:[".btn[_ngcontent-%COMP%]{padding:8px;border:none;border-radius:4px;cursor:pointer;transition:all .3s ease;font-weight:500;touch-action:manipulation}@media (max-width: 768px){.btn[_ngcontent-%COMP%]{min-height:44px;min-width:44px}}.add-quotation-container[_ngcontent-%COMP%]{padding:2rem;margin:0 auto;-webkit-overflow-scrolling:touch;touch-action:pan-y}@media (max-width: 768px){.add-quotation-container[_ngcontent-%COMP%]{padding:1rem;overflow-x:hidden}}.back-btn[_ngcontent-%COMP%]{margin-bottom:1rem}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:var(--border-radius);box-shadow:var(--card-shadow);overflow:hidden}.card-header[_ngcontent-%COMP%]{background-color:var(--primary);padding:1.5rem}.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:1.5rem;font-weight:500;display:flex;align-items:center;gap:.5rem}.quotation-form[_ngcontent-%COMP%]{padding:2rem}@media (max-width: 768px){.quotation-form[_ngcontent-%COMP%]{padding:1rem}}.header-section[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);margin-bottom:2rem}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:0px 10px}@media (max-width: 768px){.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.quotation-row[_ngcontent-%COMP%]{display:flex}.quotation-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{width:60%;height:90px;margin-bottom:0}.quotation-row[_ngcontent-%COMP%]   .product-delete-btn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.quotation-product[_ngcontent-%COMP%]{border:1px solid var(--primary);padding:20px}.dialog-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:1000}.dialog[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border-radius:12px;min-width:400px;max-width:90%;width:900px;z-index:1001;box-shadow:0 8px 32px #0000001a;margin:1rem}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid var(--border-color, #e0e0e0);background-color:var(--background);border-radius:12px 12px 0 0}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:var(--text-primary);display:flex;align-items:center;gap:.5rem}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary);font-size:1.1em}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-secondary);font-size:1.5rem;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;padding:0;margin:-.5rem -.5rem -.5rem 0}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background-color:#0000000d;color:var(--text-primary)}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:active{background-color:#0000001a}.table-container[_ngcontent-%COMP%]{width:90%;margin:30px auto;padding:20px;background-color:#f0f8ff;border-radius:10px;box-shadow:0 4px 8px #0000001a}.custom-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border:1px solid #ddd}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:center;border:1px solid #ddd}.custom-table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:85%}.custom-table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .custom-table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.custom-table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield;appearance:textfield}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#09c;color:#fff;font-size:1.1rem;font-weight:700}.custom-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#e6f7ff}.custom-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}.form-input[_ngcontent-%COMP%]{width:100%;padding:8px;border-radius:5px;border:1px solid #ccc;text-align:center}@media (max-width: 768px){.table-container[_ngcontent-%COMP%]{width:95%}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:.9rem}}.create-quotation-section[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;border:1px solid var(--primary)}.create-quotation-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%], .create-quotation-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.create-quotation-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .create-quotation-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.25rem;display:flex;align-items:center;gap:.5rem}.create-quotation-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .create-quotation-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.product-item[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-bottom:1rem;position:relative}.product-item[_ngcontent-%COMP%]   .product-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr 1fr 1fr 1fr 1fr auto;gap:1rem;align-items:start}@media (max-width: 1200px){.product-item[_ngcontent-%COMP%]   .product-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 768px){.product-item[_ngcontent-%COMP%]   .product-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]{background-color:var(--danger-light);color:var(--danger);border:none;width:36px;height:36px;border-radius:var(--border-radius);display:flex;align-items:center;justify-content:center;transition:all .3s ease}.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--danger);color:#fff;transform:translateY(-1px)}.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}@media (max-width: 768px){.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem}}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem;color:var(--text-primary);font-weight:500}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:var(--danger);margin-left:4px}.input-group[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:0 .25rem .25rem 0;border-left:none}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;width:1%;min-width:0;margin-bottom:0}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.quotation-summary[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;display:flex;justify-content:flex-end;gap:2rem;flex-wrap:wrap}.quotation-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.quotation-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.quotation-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-primary);font-size:1.25rem;font-weight:600}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}@media (max-width: 576px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}.table-responsive[_ngcontent-%COMP%]{margin:0 -1.5rem;padding:0 1.5rem;overflow-x:auto;min-height:500px;-webkit-overflow-scrolling:touch;touch-action:pan-x}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar{height:8px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{margin:0 -1rem;padding:0 1rem}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]{font-size:.875rem}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .25rem;min-width:80px}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:.875rem;padding:.25rem}}.products-table[_ngcontent-%COMP%]{width:100%;margin-bottom:0;background:#fff;border-collapse:separate;border-spacing:0}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--background-light);color:var(--text-primary);font-weight:200;padding:1rem;white-space:nowrap;border-bottom:2px solid var(--border-color)}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:var(--background-light);padding:.75rem .5rem;font-size:.8rem}}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;vertical-align:middle;border-bottom:1px solid var(--border-color)}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{min-height:40px;font-size:16px}}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:38px}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex-wrap:nowrap}.products-table[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{margin:0 auto}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem .25rem}}.form-field-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;min-width:250px}.form-field-container[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%], .form-field-container[_ngcontent-%COMP%]   .input-group.is-invalid[_ngcontent-%COMP%]{border-color:var(--danger);background-image:url(data:image/svg+xml,...)}.form-field-container-brand[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;min-width:200px}.form-field-container-brand[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%], .form-field-container-brand[_ngcontent-%COMP%]   .input-group.is-invalid[_ngcontent-%COMP%]{border-color:var(--danger);background-image:url(data:image/svg+xml,...)}.calc-type-col[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%]{min-width:130px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-bottom:1.5rem;vertical-align:top}.invalid-feedback[_ngcontent-%COMP%]{color:var(--danger);font-size:.75rem;margin-top:.25rem;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.select-group[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.5rem;width:100%;position:relative}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1;z-index:100}@media (max-width: 768px){.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{position:relative}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]     .dropdown-menu{position:fixed!important;top:auto!important;left:1rem!important;right:1rem!important;width:calc(100vw - 2rem)!important;max-width:none!important;z-index:1000!important;box-shadow:0 4px 20px #00000026!important;border-radius:8px!important;max-height:50vh!important;overflow-y:auto!important}}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{padding:.75rem;height:35px;width:35px;display:flex;align-items:center;justify-content:center;border:1px solid var(--supporting);border-radius:8px;background:#fff;transition:all .3s ease;color:var(--primary);touch-action:manipulation}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary);color:#fff}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}@media (max-width: 768px){.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{height:44px;width:44px}}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.totals-row[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:700}.totals-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:2px solid #dee2e6}.totals-row[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#fff}.search-input[_ngcontent-%COMP%]{height:43px!important}.products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.25rem;display:flex;align-items:center;gap:.5rem}.products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:1rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]{margin-bottom:0}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;white-space:nowrap}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;align-items:center}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:38px;min-width:80px}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{height:38px;display:flex;align-items:center;background-color:var(--background-light);border-color:var(--border-color)}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%]{position:absolute;font-size:.75rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:38px;display:flex;align-items:center;justify-content:center;gap:.5rem;white-space:nowrap}@media (max-width: 768px){.products-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]{width:100%;margin-top:.75rem;flex-direction:column;align-items:stretch}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap;min-width:100px}}.quotation-discount-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:15px;flex-wrap:wrap}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{min-width:150px;margin-bottom:0}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:3px;color:#555;font-weight:500}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex-wrap:nowrap}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:right;width:100px}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap;padding:.5rem}@media (max-width: 768px){.quotation-discount-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{margin-bottom:10px}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}}@media (max-width: 768px){.products-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]{width:100%;margin-top:.75rem;flex-direction:column;align-items:stretch}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:16px;height:44px}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;height:44px;font-size:16px}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap;min-width:80px;font-size:.875rem}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1), .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1){min-width:150px}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:16px!important;padding:.5rem!important;min-height:40px!important}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px!important;min-height:44px!important;padding:.75rem!important}.form-actions[_ngcontent-%COMP%]{gap:.75rem}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{height:44px;font-size:16px}}@media (max-width: 768px){.quotation-discount-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{margin-bottom:10px}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:16px;height:44px}.add-quotation-container[_ngcontent-%COMP%]{overflow-x:hidden;touch-action:pan-y}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{gap:1rem}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1rem}}"]})}}return c})();var Pe=()=>({label:"All Statuses",value:""}),Ze=()=>({label:"All Products",value:""}),Je=()=>({label:"All Customers",value:""});function tn(c,b){if(c&1){let t=x();o(0,"div",33)(1,"button",34),g("click",function(){h(t);let e=p().$implicit,i=p(2);return _(i.openWhatsApp(e.contactNumber))}),d(2,"i",35),r(),o(3,"button",36),g("click",function(){h(t);let e=p().$implicit,i=p(2);return _(i.makeCall(e.contactNumber))}),d(4,"i",37),r()()}}function en(c,b){if(c&1){let t=x();o(0,"select",38),g("change",function(e){h(t);let i=p().index,l=p(2);return _(l.updateQuotationItemStatus(i,e.target.value))}),o(1,"option",39),a(2,"Open"),r(),o(3,"option",40),a(4,"In Process"),r(),o(5,"option",41),a(6,"Completed"),r(),o(7,"option",42),a(8,"Billed"),r()()}if(c&2){let t=p().$implicit;u("value",t.quotationItemStatus)("disabled",!t.id)}}function nn(c,b){if(c&1){let t=x();o(0,"tr"),d(1,"td",27),o(2,"td"),a(3),r(),o(4,"td"),a(5),r(),o(6,"td"),M(7,tn,5,0,"div",28),r(),o(8,"td"),a(9),r(),o(10,"td"),a(11),r(),o(12,"td"),M(13,en,9,2,"select",29),r(),o(14,"td",30)(15,"button",31),g("click",function(){let e=h(t).$implicit,i=p(2);return _(i.editQuotation(e.quotationId))}),d(16,"i",32),r()()()}if(c&2){let t=b.$implicit,n=p(2);s(),u("innerHTML",n.sanitizeHtml(t.productName),Tt),s(2),y(t.quantity),s(2),y(t.customerName),s(2),u("ngIf",t.contactNumber),s(2),y(t.contactNumber),s(2),y(t.itemRemarks),s(2),u("ngIf",t.isProduction)}}function on(c,b){if(c&1&&(o(0,"div",25)(1,"table")(2,"thead")(3,"tr")(4,"th"),a(5,"Product Name"),r(),o(6,"th"),a(7,"Quantity"),r(),o(8,"th"),a(9,"Customer"),r(),d(10,"th"),o(11,"th"),a(12,"Contact"),r(),o(13,"th"),a(14,"Remarks"),r(),o(15,"th"),a(16,"Status"),r(),o(17,"th"),a(18,"Action"),r()()(),o(19,"tbody"),M(20,nn,17,7,"tr",26),r()()()),c&2){let t=p();s(20),u("ngForOf",t.quotationItems)}}function rn(c,b){c&1&&(o(0,"div",43)(1,"p"),a(2,"Loading quotation orders..."),r()())}function an(c,b){c&1&&(o(0,"div",44)(1,"p"),a(2,"No quotation orders found."),r()())}function sn(c,b){if(c&1){let t=x();o(0,"button",50),g("click",function(){let e=h(t).$implicit,i=p(2);return _(i.onPageChange(e))}),a(1),r()}if(c&2){let t=b.$implicit,n=p(2);k("active",t===n.currentPage),s(),w(" ",t+1," ")}}function cn(c,b){if(c&1){let t=x();o(0,"div",45)(1,"div",46),a(2),r(),o(3,"div",47)(4,"button",48),g("click",function(){h(t);let e=p();return _(e.onPageChange(e.currentPage-1))}),a(5," Previous "),r(),M(6,sn,2,3,"button",49),o(7,"button",48),g("click",function(){h(t);let e=p();return _(e.onPageChange(e.currentPage+1))}),a(8," Next "),r()()()}if(c&2){let t=p();s(2),Qt(" Showing ",t.currentPage+1," of ",t.totalPages," pages (",t.totalItems," total items) "),s(2),u("disabled",t.currentPage===0),s(2),u("ngForOf",t.getPageNumbers()),s(),u("disabled",t.currentPage===t.totalPages-1)}}var Zt=(()=>{class c{constructor(t,n,e,i,l,m,O,S){this.fb=t,this.quotationService=n,this.customerService=e,this.productService=i,this.encryptionService=l,this.snackbar=m,this.router=O,this.sanitizer=S,this.quotationItems=[],this.currentPage=0,this.totalPages=0,this.totalItems=0,this.perPageRecord=10,this.loading=!1,this.customers=[],this.isLoadingCustomers=!1,this.products=[],this.isLoadingProducts=!1,this.destroy$=new W,this.quotationItemStatusOptions=[{value:"O",label:"Open"},{value:"IP",label:"In Process"},{value:"C",label:"Completed"},{value:"B",label:"Billed"}],this.quotationStatusOptions=[],this.searchForm=this.fb.group({quotationItemStatuses:[["O","IP"]],productId:[""],quotationStatuses:[],customerId:[""],startDate:[""],endDate:[""]}),this.quotationStatusOptions=Object.entries(q).map(([v,I])=>({label:I,value:v}))}ngOnInit(){this.loadQuotationItems(),this.loadCustomers(),this.loadProducts()}loadQuotationItems(t=0){this.loading=!0,this.currentPage=t;let n=this.searchForm.value,e={currentPage:t,perPageRecord:this.perPageRecord,sortBy:"id",sortDir:"desc",quotationItemStatuses:n.quotationItemStatuses&&n.quotationItemStatuses.length>0?n.quotationItemStatuses:void 0,productId:n.productId?Number(n.productId):void 0,isProduction:!0,quotationStatuses:n.quotationStatuses&&n.quotationStatuses.length>0?n.quotationStatuses:void 0,customerId:n.customerId?Number(n.customerId):void 0,startDate:n.startDate||void 0,endDate:n.endDate||void 0};this.quotationService.searchQuotationItemsWithDetails(e).pipe(f(this.destroy$)).subscribe({next:i=>{this.quotationItems=i.content,this.totalPages=i.totalPages,this.totalItems=i.totalItems,this.loading=!1},error:i=>{console.error("Error loading quotation items:",i),this.snackbar.error("Failed to load quotation items"),this.loading=!1}})}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}})}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data),this.isLoadingProducts=!1},error:t=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data,this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1},error:t=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1}})}onSubmit(){this.loadQuotationItems(0)}resetForm(){this.searchForm.reset({quotationItemStatuses:["O","IP"],productId:"",quotationStatuses:[],customerId:"",startDate:"",endDate:""}),this.loadQuotationItems(0)}onPageChange(t){this.loadQuotationItems(t)}getStatusLabel(t){let n=this.quotationItemStatusOptions.find(e=>e.value===t);return n?n.label:t}getQuotationStatusLabel(t){let n=this.quotationStatusOptions.find(e=>e.value===t);return n?n.label:t}editQuotation(t){if(!t)return;let n=this.encryptionService.encrypt(t.toString());this.router.navigate(["/quotation/edit",n])}getPageNumbers(){let t=[];if(this.totalPages<=5)for(let e=0;e<this.totalPages;e++)t.push(e);else{let e=Math.max(0,Math.min(this.currentPage-2,this.totalPages-5)),i=Math.min(this.totalPages,e+5);for(let l=e;l<i;l++)t.push(l)}return t}onQuotationItemStatusChange(t,n){let e=this.searchForm.get("quotationItemStatuses")?.value||[],i=e.indexOf(n);t.target.checked&&i===-1?e.push(n):!t.target.checked&&i!==-1&&e.splice(i,1),this.searchForm.get("quotationItemStatuses")?.setValue(e)}onQuotationStatusChange(t,n){let e=this.searchForm.get("quotationStatuses")?.value||[],i=e.indexOf(n);t.target.checked&&i===-1?e.push(n):!t.target.checked&&i!==-1&&e.splice(i,1),this.searchForm.get("quotationStatuses")?.setValue(e)}updateQuotationItemStatus(t,n){let i=this.quotationItems[t].id;i&&this.quotationService.updateQuotationItemStatus(i,n).pipe(f(this.destroy$)).subscribe({next:l=>{l.success?(this.quotationItems[t].quotationItemStatus=n,this.snackbar.success("Quotation item status updated successfully")):this.snackbar.error(l.message||"Failed to update quotation item status")},error:l=>{console.error("Error updating quotation item status:",l),this.snackbar.error(l?.error?.message||"Failed to update quotation item status")}})}openWhatsApp(t){let n=String(t??"").replace(/\D/g,"");if(!n)return;let i=`whatsapp://send?phone=${n.length===10?`91${n}`:n}`;try{window.location.href=i}catch{}}makeCall(t){let n=String(t??"").replace(/\D/g,"");if(!n)return;let e=`tel:+91${n}`;try{window.location.href=e}catch{}}sanitizeHtml(t){return this.sanitizer.bypassSecurityTrustHtml(t)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.quotationItems=[],this.customers=[],this.products=[],this.quotationStatusOptions=[]}static{this.\u0275fac=function(n){return new(n||c)(C(Y),C(nt),C(rt),C(ct),C(it),C(tt),C(J),C(zt))}}static{this.\u0275cmp=V({type:c,selectors:[["app-order"]],standalone:!0,features:[L],decls:48,vars:29,consts:[[1,"order-container"],[1,"header"],[1,"search-card"],[1,"search-form",3,"ngSubmit","formGroup"],[1,"form-group"],[1,"product-select-group"],["formControlName","quotationItemStatuses","labelKey","label","valueKey","value",3,"options","multiple","defaultOption","searchPlaceholder"],["formControlName","productId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Products",1,"btn","btn-sm","btn-primary","refresh",3,"click","disabled"],[1,"fas",3,"ngClass"],["formControlName","quotationStatuses","labelKey","label","valueKey","value",3,"options","multiple","defaultOption","searchPlaceholder"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],["for","startDate"],["type","date","id","startDate","formControlName","startDate"],["for","endDate"],["type","date","id","endDate","formControlName","endDate"],[1,"buttons"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"click","disabled"],[1,"results-card"],["class","table-container",4,"ngIf"],["class","loading",4,"ngIf"],["class","no-results",4,"ngIf"],["class","pagination",4,"ngIf"],[1,"table-container"],[4,"ngFor","ngForOf"],[3,"innerHTML"],["style","display: flex; gap: 0.5rem;",4,"ngIf"],["class","status-dropdown",3,"value","disabled","change",4,"ngIf"],[1,"action-cell"],["title","Edit quotation",1,"btn-icon","edit",3,"click"],[1,"fas","fa-edit"],[2,"display","flex","gap","0.5rem"],["title","Open WhatsApp",1,"btn-icon","whatsapp",3,"click"],[1,"fab","fa-whatsapp"],["title","Call",1,"btn-icon","call",3,"click"],[1,"fas","fa-phone"],[1,"status-dropdown",3,"change","value","disabled"],["value","O"],["value","IP"],["value","C"],["value","B"],[1,"loading"],[1,"no-results"],[1,"pagination"],[1,"page-info"],[1,"pagination-controls"],[1,"page-button",3,"click","disabled"],["class","page-button",3,"active","click",4,"ngFor","ngForOf"],[1,"page-button",3,"click"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),a(3,"Quotation Orders"),r()(),o(4,"div",2)(5,"form",3),g("ngSubmit",function(){return e.onSubmit()}),o(6,"div",4)(7,"label"),a(8,"Item Status"),r(),o(9,"div",5),d(10,"app-searchable-select",6),r()(),o(11,"div",4)(12,"label"),a(13,"Product"),r(),o(14,"div",5),d(15,"app-searchable-select",7),o(16,"button",8),g("click",function(){return e.refreshProducts()}),d(17,"i",9),r()()(),o(18,"div",4)(19,"label"),a(20,"Quotation Status"),r(),o(21,"div",5),d(22,"app-searchable-select",10),r()(),o(23,"div",4)(24,"label"),a(25,"Customer"),r(),o(26,"div",5),d(27,"app-searchable-select",11),o(28,"button",12),g("click",function(){return e.refreshCustomers()}),d(29,"i",9),r()()(),o(30,"div",4)(31,"label",13),a(32,"Start Date"),r(),d(33,"input",14),r(),o(34,"div",4)(35,"label",15),a(36,"End Date"),r(),d(37,"input",16),r()(),o(38,"div",17)(39,"button",18),g("click",function(){return e.resetForm()}),a(40,"Reset"),r(),o(41,"button",19),g("click",function(){return e.onSubmit()}),a(42),r()()(),o(43,"div",20),M(44,on,21,1,"div",21)(45,rn,3,0,"div",22)(46,an,3,0,"div",23)(47,cn,9,6,"div",24),r()()),n&2&&(s(5),u("formGroup",e.searchForm),s(5),u("options",e.quotationItemStatusOptions)("multiple",!0)("defaultOption",X(25,Pe))("searchPlaceholder","Search statuses..."),s(5),u("options",e.products)("defaultOption",X(26,Ze))("searchPlaceholder","Search products..."),s(),u("disabled",e.isLoadingProducts),s(),u("ngClass",e.isLoadingProducts?"fa-spinner fa-spin":"fa-sync-alt"),s(5),u("options",e.quotationStatusOptions)("multiple",!0)("defaultOption",X(27,Pe))("searchPlaceholder","Search statuses..."),s(5),u("options",e.customers)("defaultOption",X(28,Je))("searchPlaceholder","Search customers..."),s(),u("disabled",e.isLoadingCustomers),s(),u("ngClass",e.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt"),s(12),u("disabled",e.loading),s(),w(" ",e.loading?"Searching...":"Search"," "),s(2),u("ngIf",!e.loading&&e.quotationItems.length>0),s(),u("ngIf",e.loading),s(),u("ngIf",!e.loading&&e.quotationItems.length===0),s(),u("ngIf",!e.loading&&e.quotationItems.length>0&&e.totalPages>1))},dependencies:[D,z,H,$,K,U,jt,Rt,Z,j,R,B,G,ot,Q,et],styles:["[_ngcontent-%COMP%]:root{--primary: #003a58;--primary-light: #2a5f79;--primary-lighter: #4f7f94;--primary-lightest: #a6c0cd;--primary-dark: #00263a;--secondary: #00999c;--secondary-light: #26b3b5;--secondary-lighter: #6bcfd1;--secondary-lightest: #b9ebec;--secondary-dark: #007275;--neutral-dark: #3b4248;--neutral-medium: #8a949c;--neutral-light: #b3bcc2;--neutral-lighter: #d7dee2;--neutral-lightest: #f4f7f9;--accent: #264b55;--success: #1e9e68;--warning: #c98200;--error: #c23b3b;--info: #2aa6c2;--background: #f4f7f9;--text-primary: #3b4248;--text-secondary: #8a949c;--supporting: #b3bcc2}.order-container[_ngcontent-%COMP%]{padding:20px;background-color:var(--background);min-height:100vh}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:10px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary);margin:0}.header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:10px}.search-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:20px;margin-bottom:20px}.search-form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;margin-bottom:20px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:5px;font-weight:500;color:var(--text-primary)}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px;border:1px solid var(--supporting);border-radius:4px;font-size:14px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary)}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]{display:flex;gap:8px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{width:33px;height:33px;display:flex;justify-content:center;align-items:center;padding:0;min-width:auto}.buttons[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;transition:all .3s ease;font-weight:500}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover{background-color:#001825}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background-color:var(--secondary);color:#fff}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#006769}.results-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:20px;overflow-x:auto}.table-container[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1rem;background-color:#fff;box-shadow:0 2px 4px #0000001a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid var(--supporting)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:inline-flex;align-items:center;justify-content:center}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]{color:#25d366;background-color:#25d3661a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:hover:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#25d366;color:#fff;transform:translateY(-1px)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:active, table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:active{transform:translateY(0)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]{color:#007bff;background-color:#007bff1a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:hover:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#007bff;color:#fff;transform:translateY(-1px)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:active, table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:active{transform:translateY(0)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:14px}}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--secondary);color:#fff;font-weight:600}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#aec6cf1a}table[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500;display:inline-block}table[_ngcontent-%COMP%]   .status-badge.status-open[_ngcontent-%COMP%]{background-color:#ffecb3;color:#ff9800}table[_ngcontent-%COMP%]   .status-badge.status-inprocess[_ngcontent-%COMP%]{background-color:#bbdefb;color:#2196f3}table[_ngcontent-%COMP%]   .status-badge.status-completed[_ngcontent-%COMP%]{background-color:#c8e6c9;color:#4caf50}table[_ngcontent-%COMP%]   .status-badge.status-billed[_ngcontent-%COMP%]{background-color:#e1bee7;color:#9c27b0}table[_ngcontent-%COMP%]   .action-cell[_ngcontent-%COMP%]   .edit-link[_ngcontent-%COMP%]{color:var(--primary);text-decoration:none;font-weight:500;cursor:pointer}table[_ngcontent-%COMP%]   .action-cell[_ngcontent-%COMP%]   .edit-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:10px;margin-top:20px;flex-wrap:wrap}.pagination[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary)}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]{display:flex;gap:5px}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--supporting);background-color:#fff;border-radius:4px;cursor:pointer;transition:all .3s ease}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--primary);color:#fff}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button.active[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.loading[_ngcontent-%COMP%]{text-align:center;padding:20px;color:var(--text-secondary)}.no-results[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:var(--text-secondary)}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.status-dropdown[_ngcontent-%COMP%]{margin-top:5px;padding:4px 8px;border:1px solid var(--supporting);border-radius:4px;font-size:12px;background-color:#fff;width:100%;max-width:120px}.status-dropdown[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary)}.status-dropdown[_ngcontent-%COMP%]:disabled{background-color:#f5f5f5;cursor:not-allowed}@media (max-width: 768px){.order-container[_ngcontent-%COMP%]{padding:15px}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-card[_ngcontent-%COMP%]{padding:15px}.buttons[_ngcontent-%COMP%]{flex-direction:column}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.results-card[_ngcontent-%COMP%]{padding:15px}.table-container[_ngcontent-%COMP%]{font-size:14px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 5px}.pagination[_ngcontent-%COMP%]{flex-direction:column;gap:15px}.status-dropdown[_ngcontent-%COMP%]{max-width:100%}}@media (max-width: 576px){.search-form[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-group[_ngcontent-%COMP%]{margin-bottom:10px}.product-select-group[_ngcontent-%COMP%]{flex-direction:column}.product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{align-self:flex-start}}"]})}}return c})();function ln(c,b){if(c&1){let t=x();o(0,"tr",54)(1,"td",20)(2,"div",55)(3,"div",56)(4,"app-searchable-select",57),g("selectionChange",function(e){let i=h(t).index,l=p();return _(l.onProductSelect(i,e))}),r(),o(5,"button",58),g("click",function(){h(t);let e=p();return _(e.refreshProducts())})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(6,"i",52),r()()()(),o(7,"td",21)(8,"div",59)(9,"input",60),g("input",function(){let e=h(t).index,i=p();return _(i.calculateItemPrice(e))})("touchstart",function(e){return h(t),_(e.preventDefault())}),r()()(),o(10,"td",22)(11,"div",61)(12,"span",62),a(13,"\u20B9"),r(),d(14,"input",63),r()(),o(15,"td",23),d(16,"input",64),r(),o(17,"td",24)(18,"div",65)(19,"span",66),a(20,"\u20B9"),r(),o(21,"span",67),a(22),N(23,"number"),r()()(),o(24,"td",24)(25,"div",68)(26,"span",66),a(27,"\u20B9"),r(),o(28,"span",67),a(29),N(30,"number"),r(),o(31,"span",69),a(32),r()()(),o(33,"td",24)(34,"div",70)(35,"span",66),a(36,"\u20B9"),r(),o(37,"span",67),a(38),N(39,"number"),r()()(),o(40,"td",25)(41,"button",71),g("click",function(){let e=h(t).index,i=p();return _(i.removeItem(e))})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(42,"i",72),r()()()}if(c&2){let t,n,e,i,l=b.$implicit,m=b.index,O=p();u("formGroupName",m),s(4),k("is-invalid",O.isItemFieldInvalid(m,"productId")),u("formControlName","productId")("options",O.products)("labelKey","name")("valueKey","id")("placeholder","Select Product")("searchPlaceholder","Search products...")("focusWidthPx",500),s(),u("disabled",O.isLoadingProducts),s(),u("ngClass",O.isLoadingProducts?"fa-spinner fa-spin":"fa-sync-alt"),s(3),k("is-invalid",O.isItemFieldInvalid(m,"quantity")),s(13),y(T(23,19,(t=l.get("price"))==null?null:t.value,"1.2-2")),s(7),y(T(30,22,(n=l.get("taxAmount"))==null?null:n.value,"1.2-2")),s(3),w("(",(e=l.get("taxPercentage"))==null?null:e.value,"%)"),s(6),y(T(39,25,(i=l.get("finalPrice"))==null?null:i.value,"1.2-2")),s(3),u("disabled",O.itemsFormArray.length===1)}}function dn(c,b){c&1&&d(0,"app-loader")}var Jt=(()=>{class c{get itemsFormArray(){return this.quotationForm.get("items")}constructor(t,n,e,i,l,m){this.fb=t,this.quotationService=n,this.productService=e,this.snackbar=i,this.router=l,this.cdr=m,this.products=[],this.loading=!1,this.isLoadingProducts=!1,this.destroy$=new W,this.isLoading=!1,this.totals={price:0,tax:0,finalPrice:0,taxPercentage:0},this.itemSubscriptions=[],this.touchStartTime=0,this.touchStartX=0,this.touchStartY=0,this.isTouchScrolling=!1,this.initForm()}ngOnInit(){this.loadProducts(),this.setupItemSubscriptions()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.itemSubscriptions.forEach(t=>t?.unsubscribe()),this.itemSubscriptions=[],this.products=[]}initForm(){let t=new Date,n=new Date;n.setDate(t.getDate()+7),this.quotationForm=this.fb.group({quoteDate:[F(t,"yyyy-MM-dd","en")],validUntil:[F(n,"yyyy-MM-dd","en")],remarks:[""],items:this.fb.array([])}),this.addItem(!0)}addItem(t=!1){let n=this.fb.group({id:[null],productId:["",P.required],productType:[""],quantity:[1,[P.required,P.min(.001)]],unitPrice:[0],remarks:[""],price:[0],taxPercentage:[5],taxAmount:[0],finalPrice:[0],calculations:[[]]});this.itemsFormArray.push(n);let e=this.itemsFormArray.length-1;this.setupItemCalculations(n,e),this.subscribeToItemChanges(this.itemsFormArray.at(e),e),this.calculateItemPrice(e,t),this.calculateTotalAmount()}removeItem(t){this.itemSubscriptions[t]&&(this.itemSubscriptions[t].unsubscribe(),this.itemSubscriptions.splice(t,1)),this.itemsFormArray.removeAt(t),this.itemsFormArray.controls.forEach((n,e)=>{this.itemSubscriptions[e]&&this.itemSubscriptions[e].unsubscribe(),this.subscribeToItemChanges(n,e)}),this.calculateTotalAmount(),this.cdr.detectChanges()}setupItemCalculations(t,n){t.get("productId")?.valueChanges.pipe(f(this.destroy$),bt(e=>!!e),A(100),Pt()).subscribe(e=>{let i=this.products.find(l=>l.id===e);i&&this.setProductPrice(n,i)}),t.get("quantity")?.valueChanges.pipe(f(this.destroy$),A(50)).subscribe(()=>this.calculateItemPrice(n)),t.get("taxPercentage")?.valueChanges.pipe(f(this.destroy$),A(50)).subscribe(()=>this.calculateItemPrice(n))}setProductPrice(t,n){let e=this.itemsFormArray.at(t),i=n.taxPercentage!==void 0?n.taxPercentage:5,l=n.saleAmount??n.sale_amount??0;e.patchValue({productType:n.type,taxPercentage:i,quantity:n.quantity||1,unitPrice:l},{emitEvent:!1}),this.calculateItemPrice(t)}calculateItemPrice(t,n=!1){let e=this.itemsFormArray.at(t),i={quantity:Number(Number(e.get("quantity")?.value||0).toFixed(3)),unitPrice:Number(Number(e.get("unitPrice")?.value||0).toFixed(2)),taxPercentage:Number(e.get("taxPercentage")?.value??5)},l=Number((i.quantity*i.unitPrice).toFixed(2)),m=Number((l*i.taxPercentage/100).toFixed(2)),O=Number((l+m).toFixed(2));e.patchValue({price:l,taxAmount:m,finalPrice:O},{emitEvent:!1}),this.calculateTotalAmount(),n||this.cdr.detectChanges()}getTotalAmount(){let t=this.itemsFormArray.controls.reduce((n,e)=>n+(Number(e.get("finalPrice").value)||0),0);return Math.round(t)}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data),this.isLoadingProducts=!1},error:()=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data,this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1},error:()=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1}})}calculateTotalAmount(){let t={price:0,tax:0,finalPrice:0,taxPercentage:0};this.itemsFormArray.controls.forEach(n=>{let e=Number(Number(n.get("price")?.value||0).toFixed(2)),i=Number(Number(n.get("finalPrice")?.value||0).toFixed(2)),l=Number(Number(n.get("taxAmount")?.value||0).toFixed(2)),m=Number(n.get("taxPercentage")?.value||5);t.price=Number((t.price+e).toFixed(2)),t.tax=Number((t.tax+l).toFixed(2)),t.finalPrice=Number((t.finalPrice+i).toFixed(2)),t.taxPercentage=Number(m)}),this.totals=t}resetForm(){let t=new Date,n=new Date;for(n.setDate(t.getDate()+7),this.quotationForm.reset({quoteDate:F(t,"yyyy-MM-dd","en"),validUntil:F(n,"yyyy-MM-dd","en"),remarks:""});this.itemsFormArray.length;)this.itemsFormArray.removeAt(0);this.addItem(),this.calculateTotalAmount(),this.cdr.detectChanges()}isItemFieldInvalid(t,n){let e=this.itemsFormArray.at(t).get(n);if(!e)return!1;if(e.invalid&&(e.dirty||e.touched)){let l=e.errors;if(l&&(l.required||l.min&&n==="quantity"))return!0}return!1}onProductSelect(t,n){let e=this.products.find(m=>m.id===n.value);if(!e)return;let i=this.itemsFormArray.at(t),l=this.itemSubscriptions[t];l&&(l.unsubscribe(),this.itemSubscriptions[t]=new Ct),i.patchValue({productId:e.id},{emitEvent:!0}),this.itemSubscriptions[t]||this.subscribeToItemChanges(i,t)}onSubmit(){if(this.quotationForm.valid){this.isLoading=!0;let t=this.prepareFormData();this.quotationService.createQuotation(t).pipe(f(this.destroy$)).subscribe({next:n=>{n.success&&(this.snackbar.success("Dealer order created successfully"),this.quotationForm.reset(),this.router.navigate(["/quotation"])),this.isLoading=!1},error:n=>{this.snackbar.error(n?.error?.message||"Failed to create dealer order"),this.isLoading=!1}})}}prepareFormData(){let t=this.quotationForm.value,n=this.itemsFormArray.controls.map(e=>({id:e.get("id")?.value,productId:e.get("productId")?.value,productType:e.get("productType")?.value,quantity:e.get("quantity")?.value,unitPrice:e.get("unitPrice")?.value,remarks:e.get("remarks")?.value,price:e.get("price")?.value,taxPercentage:e.get("taxPercentage")?.value,taxAmount:e.get("taxAmount")?.value,finalPrice:e.get("finalPrice")?.value,quotationDiscountAmount:0,calculations:e.get("calculations")?.value||[]}));return{quoteDate:F(t.quoteDate,"yyyy-MM-dd","en"),validUntil:F(t.validUntil,"yyyy-MM-dd","en"),remarks:t.remarks,termsConditions:"",quotationDiscountPercentage:0,packagingAndForwadingCharges:0,items:n}}setupItemSubscriptions(){this.itemsFormArray.controls.forEach((t,n)=>{this.subscribeToItemChanges(t,n)})}subscribeToItemChanges(t,n){this.itemSubscriptions[n]&&this.itemSubscriptions[n].unsubscribe();let e=t.valueChanges.pipe(f(this.destroy$),A(100)).subscribe(()=>{this.calculateItemPrice(n)});this.itemSubscriptions[n]=e}handleTouchStart(t){this.touchStartTime=Date.now(),this.touchStartX=t.touches[0].clientX,this.touchStartY=t.touches[0].clientY,this.isTouchScrolling=!1}handleTouchMove(t){let n=t.touches[0].clientX,e=t.touches[0].clientY,i=Math.abs(n-this.touchStartX),l=Math.abs(e-this.touchStartY);(i>10||l>10)&&(this.isTouchScrolling=!0)}handleTouchEnd(t){Date.now()-this.touchStartTime<200&&!this.isTouchScrolling&&t.preventDefault()}static{this.\u0275fac=function(n){return new(n||c)(C(Y),C(nt),C(ct),C(tt),C(J),C(Ot))}}static{this.\u0275cmp=V({type:c,selectors:[["app-dealer-add-quotation"]],standalone:!0,features:[L],decls:105,vars:24,consts:[[1,"dealer-quotation-container"],[1,"form-card"],[1,"card-header"],[1,"header-content"],[1,"title-section"],[1,"fas","fa-shopping-cart"],[1,"form-title"],[1,"header-actions"],["routerLink","/quotation",1,"btn","btn-sm","btn-secondary","back-btn"],[1,"fas","fa-arrow-left"],[1,"dealer-badge"],[1,"fas","fa-store"],[1,"quotation-form",3,"ngSubmit","keydown.enter","touchstart","touchmove","touchend","formGroup"],["formArrayName","items",1,"products-section"],[1,"products-header"],[1,"fas","fa-boxes-stacked"],["type","button",1,"btn","btn-sm","btn-primary","add-product-btn",3,"click"],[1,"fas","fa-plus"],[1,"table-responsive"],[1,"table","products-table"],[1,"product-col"],[1,"qty-col"],[1,"price-col"],[1,"remarks-col"],[1,"calc-col"],[1,"action-col"],["class","product-row",3,"formGroupName",4,"ngFor","ngForOf"],[1,"totals-row"],["colspan","4",1,"totals-label"],[1,"fas","fa-calculator"],[1,"total-value"],[1,"label"],[1,"amount"],[1,"total-value","grand-total"],[1,"bottom-section"],[1,"remarks-wrapper"],[1,"form-group"],[1,"fas","fa-comment"],["formControlName","remarks","rows","2","placeholder","Optional remarks for this order...",1,"form-control"],[1,"summary-actions-wrapper"],[1,"order-summary-inline"],[1,"summary-item"],[1,"fas","fa-box"],[1,"summary-label"],[1,"summary-value"],[1,"summary-divider"],[1,"summary-item","highlight"],[1,"fas","fa-indian-rupee-sign"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"fas","fa-undo"],["type","submit",1,"btn","btn-primary","submit-btn",3,"disabled"],[1,"fas",3,"ngClass"],[4,"ngIf"],[1,"product-row",3,"formGroupName"],[1,"form-field-container"],[1,"select-group"],[3,"selectionChange","formControlName","options","labelKey","valueKey","placeholder","searchPlaceholder","focusWidthPx"],["type","button","title","Refresh Products",1,"btn","btn-sm","btn-icon","refresh",3,"click","touchstart","disabled"],[1,"input-group"],["type","number","formControlName","quantity","min","0.001","step","0.001",1,"form-control",3,"input","touchstart"],[1,"input-group","readonly-field"],[1,"currency-symbol"],["type","number","formControlName","unitPrice","readonly","","title","Fixed dealer price",1,"form-control"],["type","text","formControlName","remarks","placeholder","Optional remarks",1,"form-control"],[1,"calculated-value"],[1,"currency"],[1,"value"],[1,"calculated-value","tax-value"],[1,"percentage"],[1,"calculated-value","final-value"],["type","button","title","Remove product",1,"btn","btn-sm","btn-danger","delete-btn",3,"click","touchstart","disabled"],[1,"fas","fa-trash"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),d(5,"i",5),o(6,"h2",6),a(7,"Dealer Direct Order"),r()(),o(8,"div",7)(9,"button",8),d(10,"i",9),a(11," Back "),r(),o(12,"span",10),d(13,"i",11),a(14," Dealer Portal "),r()()()(),o(15,"form",12),g("ngSubmit",function(){return e.onSubmit()})("keydown.enter",function(l){return l.preventDefault()})("touchstart",function(l){return e.handleTouchStart(l)})("touchmove",function(l){return e.handleTouchMove(l)})("touchend",function(l){return e.handleTouchEnd(l)}),o(16,"div",13)(17,"div",14)(18,"h3"),d(19,"i",15),a(20," Order Products"),r(),o(21,"button",16),g("click",function(){return e.addItem()}),d(22,"i",17),a(23," Add Product "),r()(),o(24,"div",18)(25,"table",19)(26,"thead")(27,"tr")(28,"th",20),a(29,"Product"),r(),o(30,"th",21),a(31,"Quantity"),r(),o(32,"th",22),a(33,"Unit Price"),r(),o(34,"th",23),a(35,"Remarks"),r(),o(36,"th",24),a(37,"Item Price"),r(),o(38,"th",24),a(39,"Tax Amount"),r(),o(40,"th",24),a(41,"Final Price"),r(),o(42,"th",25),a(43,"Actions"),r()()(),o(44,"tbody"),M(45,ln,43,28,"tr",26),r(),o(46,"tfoot")(47,"tr",27)(48,"td",28)(49,"strong"),d(50,"i",29),a(51," Order Totals"),r()(),o(52,"td",24)(53,"div",30)(54,"span",31),a(55,"Subtotal:"),r(),o(56,"span",32),a(57),N(58,"number"),r()()(),o(59,"td",24)(60,"div",30)(61,"span",31),a(62,"Tax:"),r(),o(63,"span",32),a(64),N(65,"number"),r()()(),o(66,"td",24)(67,"div",33)(68,"span",31),a(69,"Grand Total:"),r(),o(70,"span",32),a(71),N(72,"number"),r()()(),d(73,"td"),r()()()()(),o(74,"div",34)(75,"div",35)(76,"div",36)(77,"label"),d(78,"i",37),a(79," Order Remarks "),r(),d(80,"textarea",38),r()(),o(81,"div",39)(82,"div",40)(83,"div",41),d(84,"i",42),o(85,"span",43),a(86,"Products:"),r(),o(87,"strong",44),a(88),r()(),d(89,"div",45),o(90,"div",46),d(91,"i",47),o(92,"span",43),a(93,"Total:"),r(),o(94,"strong",44),a(95),N(96,"number"),r()()(),o(97,"div",48)(98,"button",49),g("click",function(){return e.resetForm()}),d(99,"i",50),a(100," Reset "),r(),o(101,"button",51),d(102,"i",52),a(103),r()()()()()()(),M(104,dn,1,0,"app-loader",53)),n&2&&(s(15),u("formGroup",e.quotationForm),s(30),u("ngForOf",e.itemsFormArray.controls),s(12),w("\u20B9",T(58,12,e.totals.price,"1.2-2"),""),s(7),w("\u20B9",T(65,15,e.totals.tax,"1.2-2"),""),s(7),w("\u20B9",T(72,18,e.totals.finalPrice,"1.2-2"),""),s(17),y(e.itemsFormArray.length),s(7),w("\u20B9",T(96,21,e.getTotalAmount(),"1.2-2"),""),s(3),u("disabled",e.loading),s(3),u("disabled",e.quotationForm.invalid||e.loading),s(),u("ngClass",e.loading?"fa-spinner fa-spin":"fa-paper-plane"),s(),w(" ",e.loading?"Placing Order...":"Place Order"," "),s(),u("ngIf",e.isLoading))},dependencies:[D,z,H,$,Lt,K,U,Z,dt,j,R,ut,B,G,Mt,xt,Q,vt,et,st],styles:["[_ngcontent-%COMP%]:root{--primary: #003a58;--primary-light: #2a5f79;--primary-lighter: #4f7f94;--primary-lightest: #a6c0cd;--primary-dark: #00263a;--secondary: #00999c;--secondary-light: #26b3b5;--secondary-lighter: #6bcfd1;--secondary-lightest: #b9ebec;--secondary-dark: #007275;--neutral-dark: #3b4248;--neutral-medium: #8a949c;--neutral-light: #b3bcc2;--neutral-lighter: #d7dee2;--neutral-lightest: #f4f7f9;--accent: #264b55;--success: #1e9e68;--warning: #c98200;--error: #c23b3b;--info: #2aa6c2;--background: #f4f7f9;--text-primary: #3b4248;--text-secondary: #8a949c;--supporting: #b3bcc2}.btn[_ngcontent-%COMP%]{padding:10px 18px;border:none;border-radius:8px;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);font-weight:500;font-size:14px;display:inline-flex;align-items:center;justify-content:center;gap:8px;touch-action:manipulation}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#003a58,#00263a);color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 15px #003a5866}.btn-secondary[_ngcontent-%COMP%]{background:#ffffff26;color:#fff;border:1px solid rgba(255,255,255,.3);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff40;border-color:#ffffff80}.btn-danger[_ngcontent-%COMP%]{background:#c23b3b1a;color:#c23b3b;border:1px solid rgba(194,59,59,.3)}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#c23b3b;color:#fff;border-color:#c23b3b}.btn-icon[_ngcontent-%COMP%]{width:38px;height:38px;padding:0;border-radius:8px}.btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}@media (max-width: 768px){.btn[_ngcontent-%COMP%]{min-height:44px;padding:12px 20px;font-size:15px}}.dealer-quotation-container[_ngcontent-%COMP%]{width:100%;min-height:100vh;padding:0;margin:0;background:#f4f7f9;-webkit-overflow-scrolling:touch;touch-action:pan-y}.form-card[_ngcontent-%COMP%]{width:100%;min-height:100vh;background:#fff;border-radius:0;box-shadow:none;display:flex;flex-direction:column}.card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#003a58,#00263a);padding:16px 24px;position:sticky;top:0;z-index:100}.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%}@media (max-width: 576px){.card-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex-direction:column;gap:12px;align-items:flex-start}}.card-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.card-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;color:#ffffffe6}.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:1.5rem;font-weight:600;letter-spacing:-.02em}@media (max-width: 576px){.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{font-size:1.25rem}}.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}@media (max-width: 576px){.card-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;justify-content:space-between}}.card-header[_ngcontent-%COMP%]   .back-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}.card-header[_ngcontent-%COMP%]   .dealer-badge[_ngcontent-%COMP%]{background:#00999c;color:#fff;padding:6px 14px;border-radius:20px;font-size:12px;font-weight:500;display:flex;align-items:center;gap:6px;box-shadow:0 2px 8px #00999c4d}.card-header[_ngcontent-%COMP%]   .dealer-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:12px}@media (max-width: 768px){.card-header[_ngcontent-%COMP%]{padding:12px 16px}}.quotation-form[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;padding:20px}@media (max-width: 768px){.quotation-form[_ngcontent-%COMP%]{padding:12px}}.products-section[_ngcontent-%COMP%]{flex:1;background:#f4f7f9;border-radius:12px;padding:20px;border:2px solid #00999c}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;flex-wrap:wrap;gap:12px}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600;color:#3b4248;display:flex;align-items:center;gap:8px}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#00999c;font-size:18px}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .add-product-btn[_ngcontent-%COMP%]{background:#00999c}.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .add-product-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#007275;box-shadow:0 4px 15px #00999c66}@media (max-width: 576px){.products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   .add-product-btn[_ngcontent-%COMP%]{width:100%}}@media (max-width: 768px){.products-section[_ngcontent-%COMP%]{padding:12px}}.table-responsive[_ngcontent-%COMP%]{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;touch-action:pan-x}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar{height:6px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f4f7f9;border-radius:3px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#b3bcc2;border-radius:3px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#8a949c}.products-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;min-width:850px}.products-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:linear-gradient(180deg,#f4f7f9,#d7dee2);color:#3b4248;font-weight:600;font-size:12px;padding:12px 10px;text-align:left;white-space:nowrap;border-bottom:2px solid #d7dee2;text-transform:uppercase;letter-spacing:.03em}.products-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-radius:8px 0 0}.products-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-radius:0 8px 0 0}.products-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .product-row[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.4,0,.2,1)}.products-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .product-row[_ngcontent-%COMP%]:hover{background:#b9ebec4d}.products-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .product-row[_ngcontent-%COMP%]:nth-child(2n){background:#f4f7f980}.products-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .product-row[_ngcontent-%COMP%]:nth-child(2n):hover{background:#b9ebec66}.products-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   .product-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 10px;vertical-align:middle;border-bottom:1px solid #d7dee2}.products-table[_ngcontent-%COMP%]   .product-col[_ngcontent-%COMP%]{min-width:220px}.products-table[_ngcontent-%COMP%]   .qty-col[_ngcontent-%COMP%]{min-width:90px;width:100px}.products-table[_ngcontent-%COMP%]   .price-col[_ngcontent-%COMP%]{min-width:110px;width:120px}.products-table[_ngcontent-%COMP%]   .remarks-col[_ngcontent-%COMP%]{min-width:130px;width:150px}.products-table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]{min-width:110px;width:120px}.products-table[_ngcontent-%COMP%]   .action-col[_ngcontent-%COMP%]{min-width:70px;width:70px;text-align:center}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px 10px;border:1px solid #b3bcc2;border-radius:6px;font-size:14px;margin-bottom:0}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#003a58;box-shadow:0 0 0 2px #003a581a}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:16px;padding:10px}}.products-table[_ngcontent-%COMP%]   .input-group.readonly-field[_ngcontent-%COMP%]{position:relative}.products-table[_ngcontent-%COMP%]   .input-group.readonly-field[_ngcontent-%COMP%]   .currency-symbol[_ngcontent-%COMP%]{position:absolute;left:10px;color:#8a949c;font-weight:500;z-index:1}.products-table[_ngcontent-%COMP%]   .input-group.readonly-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-left:24px;background:#f4f7f9;color:#3b4248;font-weight:500;border-color:#d7dee2}.products-table[_ngcontent-%COMP%]   .calculated-value[_ngcontent-%COMP%]{display:flex;align-items:center;gap:3px;font-weight:500;color:#3b4248;padding:6px 10px;background:#d7dee2;border-radius:6px;white-space:nowrap;font-size:13px}.products-table[_ngcontent-%COMP%]   .calculated-value[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{color:#8a949c;font-size:12px}.products-table[_ngcontent-%COMP%]   .calculated-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:13px}.products-table[_ngcontent-%COMP%]   .calculated-value[_ngcontent-%COMP%]   .percentage[_ngcontent-%COMP%]{font-size:10px;color:#8a949c}.products-table[_ngcontent-%COMP%]   .calculated-value.tax-value[_ngcontent-%COMP%]{background:#c9820026;color:#7d5100}.products-table[_ngcontent-%COMP%]   .calculated-value.tax-value[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{color:#c98200}.products-table[_ngcontent-%COMP%]   .calculated-value.final-value[_ngcontent-%COMP%]{background:#b9ebec;color:#007275;font-weight:600}.products-table[_ngcontent-%COMP%]   .calculated-value.final-value[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{color:#00999c}.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]{position:relative;min-width:200px}.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]   .select-group[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:6px}.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]   .select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1;z-index:10}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]   .select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]     .dropdown-menu{position:fixed!important;left:12px!important;right:12px!important;width:calc(100vw - 24px)!important;max-width:none!important;z-index:1000!important;box-shadow:0 8px 30px #00000026!important;border-radius:12px!important;max-height:50vh!important;overflow-y:auto!important}}.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]   .select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{width:34px;height:34px;padding:0;background:#fff;border:1px solid #b3bcc2;color:#003a58;flex-shrink:0}.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]   .select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:#003a58;color:#fff;border-color:#003a58}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]   .select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{width:44px;height:44px}}.products-table[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{margin:0 auto;width:32px;height:32px;padding:0}.products-table[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:disabled{opacity:.3;background:#f4f7f9;color:#b3bcc2;border-color:#d7dee2}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]{background:linear-gradient(180deg,#f4f7f9,#d7dee2)}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px 10px;border-top:2px solid #d7dee2;border-bottom:none}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .totals-label[_ngcontent-%COMP%]{text-align:right;color:#3b4248}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .totals-label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#003a58;margin-right:6px}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;padding:6px 10px;background:#fff;border-radius:6px;border:1px solid #d7dee2}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:10px;color:#8a949c;text-transform:uppercase;letter-spacing:.03em}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .total-value[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#3b4248}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .total-value.grand-total[_ngcontent-%COMP%]{background:#00999c;border-color:#00999c}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .total-value.grand-total[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#fffc}.products-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%]   .totals-row[_ngcontent-%COMP%]   .total-value.grand-total[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{color:#fff;font-size:15px}.form-control[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #b3bcc2;border-radius:6px;font-size:14px;transition:all .3s cubic-bezier(.4,0,.2,1);background:#fff;margin-bottom:0}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#003a58;box-shadow:0 0 0 3px #003a581a}@media (max-width: 768px){.form-control[_ngcontent-%COMP%]{font-size:16px;padding:12px;min-height:44px}}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:60px}.bottom-section[_ngcontent-%COMP%]{display:flex;gap:20px;margin-top:20px;padding:20px;background:#f4f7f9;border-radius:12px;border:1px solid #d7dee2;align-items:flex-end}@media (max-width: 992px){.bottom-section[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}@media (max-width: 768px){.bottom-section[_ngcontent-%COMP%]{padding:12px;margin-top:12px;gap:16px}}.remarks-wrapper[_ngcontent-%COMP%]{flex:1}.remarks-wrapper[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin:0}.remarks-wrapper[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-bottom:6px;color:#3b4248;font-weight:500;font-size:13px}.remarks-wrapper[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#003a58;font-size:13px}.summary-actions-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}@media (max-width: 768px){.summary-actions-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:16px}}.order-summary-inline[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:12px 20px;background:linear-gradient(135deg,#003a58,#00263a);border-radius:8px;color:#fff}.order-summary-inline[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.order-summary-inline[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;color:#ffffffb3}.order-summary-inline[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{font-size:12px;color:#fffc}.order-summary-inline[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#fff}.order-summary-inline[_ngcontent-%COMP%]   .summary-item.highlight[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#26b3b5}.order-summary-inline[_ngcontent-%COMP%]   .summary-item.highlight[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{color:#6bcfd1}.order-summary-inline[_ngcontent-%COMP%]   .summary-divider[_ngcontent-%COMP%]{width:1px;height:30px;background:#fff3}@media (max-width: 768px){.order-summary-inline[_ngcontent-%COMP%]{justify-content:space-between;padding:12px 16px}.order-summary-inline[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-size:16px}}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.form-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#f4f7f9;color:#3b4248;border:1px solid #d7dee2}.form-actions[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#d7dee2;border-color:#b3bcc2}.form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{min-width:140px;padding:12px 24px;font-size:14px;font-weight:600;background:#00999c}.form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#007275;box-shadow:0 4px 20px #00999c66}@media (max-width: 768px){.form-actions[_ngcontent-%COMP%]{width:100%}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1;justify-content:center}.form-actions[_ngcontent-%COMP%]   .submit-btn[_ngcontent-%COMP%]{min-width:auto}}@media (max-width: 768px){.dealer-quotation-container[_ngcontent-%COMP%]{overflow-x:hidden;touch-action:pan-y}.products-table[_ngcontent-%COMP%]{font-size:12px;min-width:750px}.products-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:10px 8px;font-size:10px}.products-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 8px}.products-table[_ngcontent-%COMP%]   .calculated-value[_ngcontent-%COMP%]{padding:5px 8px;font-size:12px}.products-table[_ngcontent-%COMP%]   .calculated-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:12px}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:8px}.products-table[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   .product-col[_ngcontent-%COMP%]{min-width:180px}.products-table[_ngcontent-%COMP%]   .qty-col[_ngcontent-%COMP%]{min-width:80px;width:85px}.products-table[_ngcontent-%COMP%]   .price-col[_ngcontent-%COMP%]{min-width:95px;width:100px}.products-table[_ngcontent-%COMP%]   .remarks-col[_ngcontent-%COMP%]{min-width:110px;width:120px}.products-table[_ngcontent-%COMP%]   .calc-col[_ngcontent-%COMP%]{min-width:95px;width:100px}.products-table[_ngcontent-%COMP%]   .action-col[_ngcontent-%COMP%]{min-width:55px;width:55px}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.product-row[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .3s ease-out}@media (prefers-contrast: high){.form-control[_ngcontent-%COMP%], .btn[_ngcontent-%COMP%]{border-width:2px}}@media (prefers-reduced-motion: reduce){*[_ngcontent-%COMP%], *[_ngcontent-%COMP%]:before, *[_ngcontent-%COMP%]:after{animation-duration:.01ms!important;transition-duration:.01ms!important}}"]})}}return c})();function un(c,b){c&1&&(o(0,"div",18),a(1," Packaging and forwarding charges is required "),r())}function pn(c,b){c&1&&(o(0,"div",18),a(1," Charges must be 0 or greater "),r())}function mn(c,b){if(c&1){let t=x();o(0,"div",1),g("click",function(){h(t);let e=p();return _(e.onCancel())}),o(1,"div",2),g("click",function(e){return h(t),_(e.stopPropagation())}),o(2,"div",3)(3,"h3"),d(4,"i",4),a(5," Packaging & Forwarding Charges"),r()(),o(6,"form",5),g("ngSubmit",function(){h(t);let e=p();return _(e.onSubmit())}),o(7,"div",6)(8,"div",7)(9,"label",8),d(10,"i",9),a(11," Packaging & Forwarding Charges "),o(12,"span",10),a(13,"*"),r()(),d(14,"input",11),M(15,un,2,0,"div",12)(16,pn,2,0,"div",12),r()(),o(17,"div",13)(18,"button",14),g("click",function(){h(t);let e=p();return _(e.onCancel())}),d(19,"i",15),a(20," Cancel "),r(),o(21,"button",16),d(22,"i",17),a(23),r()()()()()}if(c&2){let t,n,e,i=p();s(),u("@modalAnimation",void 0),s(5),u("formGroup",i.chargesForm),s(8),k("is-invalid",((t=i.chargesForm.get("packagingAndForwadingCharges"))==null?null:t.invalid)&&((t=i.chargesForm.get("packagingAndForwadingCharges"))==null?null:t.touched)),s(),u("ngIf",(n=i.chargesForm.get("packagingAndForwadingCharges"))==null||n.errors==null?null:n.errors.required),s(),u("ngIf",(e=i.chargesForm.get("packagingAndForwadingCharges"))==null||e.errors==null?null:e.errors.min),s(5),u("disabled",i.chargesForm.invalid||i.isLoading),s(),u("ngClass",i.isLoading?"fa-spinner fa-spin":"fa-check"),s(),w(" ",i.isLoading?"Creating...":"Create Sale"," ")}}var Oe=(()=>{class c{constructor(t){this.fb=t,this.show=!1,this.defaultCharges=0,this.confirm=new ee,this.cancel=new ee,this.isLoading=!1,this.chargesForm=this.fb.group({packagingAndForwadingCharges:[0,[P.required,P.min(0)]]})}ngOnChanges(){this.show&&this.defaultCharges!==void 0&&this.chargesForm.patchValue({packagingAndForwadingCharges:this.defaultCharges||0})}onCancel(){this.cancel.emit()}onSubmit(){if(this.chargesForm.valid){let t=Number(this.chargesForm.get("packagingAndForwadingCharges")?.value||0);this.confirm.emit(t)}else this.chargesForm.markAllAsTouched()}static{this.\u0275fac=function(n){return new(n||c)(C(Y))}}static{this.\u0275cmp=V({type:c,selectors:[["app-packaging-charges-modal"]],inputs:{show:"show",defaultCharges:"defaultCharges"},outputs:{confirm:"confirm",cancel:"cancel"},standalone:!0,features:[le,L],decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"fas","fa-box"],[3,"ngSubmit","formGroup"],[1,"modal-body"],[1,"form-group"],["for","packagingAndForwadingCharges"],[1,"fas","fa-rupee-sign"],[1,"required"],["type","number","id","packagingAndForwadingCharges","formControlName","packagingAndForwadingCharges","min","0","step","0.01","placeholder","Enter packaging and forwarding charges",1,"form-control"],["class","invalid-feedback",4,"ngIf"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"fas",3,"ngClass"],[1,"invalid-feedback"]],template:function(n,e){n&1&&M(0,mn,24,9,"div",0),n&2&&u("ngIf",e.show)},dependencies:[D,z,$,K,U,Z,dt,j,R,ut,B,G],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;width:90%;max-width:500px;box-shadow:0 4px 6px #0000001a;animation:_ngcontent-%COMP%_modalIn .2s ease-out}.modal-header[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-bottom:1px solid #dee2e6;background-color:var(--secondary, #17a3df);color:#fff;border-radius:8px 8px 0 0}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:.5rem;font-size:1.25rem;font-weight:600}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.modal-body[_ngcontent-%COMP%]{padding:1.5rem}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:var(--text-primary, #2c3e50);font-weight:500;font-size:14px}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:6px;color:var(--primary, #145881)}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc3545}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid var(--supporting, #90a4ae);border-radius:4px;font-size:14px;transition:all .3s ease;box-sizing:border-box}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary, #145881);box-shadow:0 0 0 3px #1458811a}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.modal-body[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%]{color:#dc3545;font-size:12px;margin-top:4px;display:block}.modal-actions[_ngcontent-%COMP%]{padding:1rem 1.5rem;border-top:1px solid #dee2e6;display:flex;justify-content:flex-end;gap:1rem}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;font-weight:500;display:flex;align-items:center;gap:6px;transition:all .3s ease;font-size:14px}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background-color:var(--secondary, #17a3df);color:#fff}.modal-actions[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1281b1}.modal-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background-color:var(--primary, #145881);color:#fff}.modal-actions[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0d3a55}@keyframes _ngcontent-%COMP%_modalIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 576px){.modal-content[_ngcontent-%COMP%]{width:95%;max-width:95%}}"],data:{animation:[pe("modalAnimation",[re(":enter",[$t({opacity:0,transform:"translateY(-20px)"}),ie("200ms ease-out",$t({opacity:1,transform:"translateY(0)"}))]),re(":leave",[ie("150ms ease-in",$t({opacity:0,transform:"translateY(-20px)"}))])])]}})}}return c})();function gn(c,b){if(c&1){let t=x();o(0,"button",57),g("click",function(){h(t);let e=p();return _(e.createDispatchSlip())}),d(1,"i",58),a(2," Create Dispatch Slip "),r()}}function hn(c,b){if(c&1){let t=x();o(0,"button",59),g("click",function(){h(t);let e=p();return _(e.createSaleFromSelected())}),d(1,"i",60),a(2," Create Sale "),r()}}function _n(c,b){if(c&1){let t=x();ne(0),o(1,"input",70),g("change",function(e){h(t);let i=p(2).index,l=p();return _(l.toggleSelection(i,e))}),r(),oe()}if(c&2){let t=p(2).index,n=p();s(),u("checked",n.isSelected(t))}}function fn(c,b){if(c&1&&(o(0,"div")(1,"label",63),a(2,"Sale:"),r(),M(3,_n,2,1,"ng-container",55),r()),c&2){let t,n=p().index,e=p();s(3),u("ngIf",((t=e.itemsFormArray.at(n).get("quotationItemStatus"))==null?null:t.value)!="B")}}function Cn(c,b){if(c&1){let t=x();ne(0),o(1,"select",71),g("focus",function(){h(t);let e=p().index,i=p();return _(i.onStatusFocus(e))})("change",function(e){h(t);let i=p().index,l=p();return _(l.onStatusChange(i,e))}),o(2,"option",72),a(3,"Open"),r(),o(4,"option",73),a(5,"In progress"),r(),o(6,"option",74),a(7,"Completed"),r(),o(8,"option",75),a(9,"Billed"),r()(),oe()}if(c&2){let t,n=p().index,e=p();s(),u("disabled",((t=e.itemsFormArray.at(n).get("isDispatch"))==null?null:t.value)===!0)}}function bn(c,b){if(c&1){let t=x();o(0,"tr",61)(1,"td")(2,"div",62),M(3,fn,4,1,"div",55),o(4,"div")(5,"label",63),a(6,"Dispatch:"),r(),o(7,"input",64),g("change",function(e){let i=h(t).index,l=p();return _(l.toggleDispatchSelection(i,e))}),r()()()(),o(8,"td")(9,"div",65),a(10),r()(),o(11,"td")(12,"input",66),g("focus",function(){let e=h(t).index,i=p();return _(i.onQuantityFocus(e))})("change",function(e){let i=h(t).index,l=p();return _(l.onQuantityChange(i,e))})("input",function(){let e=h(t).index,i=p();return _(i.onQuantityEdit(e))}),r()(),o(13,"td"),d(14,"input",67),r(),o(15,"td")(16,"input",68),g("change",function(){let e=h(t).index,i=p();return _(i.onDispatchToggle(e))}),r()(),o(17,"td",43),M(18,Cn,10,1,"ng-container",55),r(),o(19,"td")(20,"input",69),g("focus",function(){let e=h(t).index,i=p();return _(i.onCreatedRollFocus(e))})("change",function(e){let i=h(t).index,l=p();return _(l.onCreatedRollChange(i,e))}),r()()()}if(c&2){let t,n,e,i,l,m=b.index,O=p();k("dispatched-row",((t=O.itemsFormArray.at(m).get("isDispatch"))==null?null:t.value)===!0),u("formGroupName",m),s(3),u("ngIf",O.canSeeSaleOption),s(4),u("checked",O.isDispatchSelected(m)),s(3),w(" ",(n=O.itemsFormArray.at(m).get("productName"))==null?null:n.value," "),s(2),u("readonly",((e=O.itemsFormArray.at(m).get("quotationItemStatus"))==null?null:e.value)=="B"||((e=O.itemsFormArray.at(m).get("isDispatch"))==null?null:e.value)===!0),s(6),u("ngIf",((i=O.itemsFormArray.at(m).get("isProduction"))==null?null:i.value)===!0||((i=O.itemsFormArray.at(m).get("quotationItemStatus"))==null?null:i.value)==="B"),s(2),u("readonly",((l=O.itemsFormArray.at(m).get("isDispatch"))==null?null:l.value)===!0)}}function Pn(c,b){c&1&&d(0,"app-loader")}var Me=(()=>{class c{get itemsFormArray(){return this.quotationForm.get("items")}constructor(t,n,e,i,l,m,O,S,v,I,E,at){this.fb=t,this.quotationService=n,this.productService=e,this.customerService=i,this.transportService=l,this.snackbar=m,this.encryptionService=O,this.router=S,this.dialog=v,this.cdr=I,this.saleService=E,this.authService=at,this.products=[],this.customers=[],this.transports=[],this.loading=!1,this.isLoadingProducts=!1,this.isLoadingCustomers=!1,this.isLoadingTransports=!1,this.destroy$=new W,this.isLoading=!1,this.isEdit=!1,this.itemSubscriptions=[],this.lastStatusByIndex={},this.lastCreatedRollByIndex={},this.lastQuantityByIndex={},this.selectedQuotationItemIds=new Set,this.selectedDispatchItemIds=new Set,this.canSeeSaleOption=!1,this.showPackagingChargesModal=!1;let ye=new Date;this.minValidUntilDate=F(ye,"yyyy-MM-dd","en"),this.initForm(),this.canSeeSaleOption=this.authService.hasAnyRole([pt.ADMIN,pt.STAFF_ADMIN,pt.SALES_AND_MARKETING])}ngOnInit(){this.loadProducts(),this.loadCustomers(),this.loadTransports(),this.setupCustomerNameSync(),this.setupItemSubscriptions()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.itemSubscriptions.forEach(t=>t?.unsubscribe()),this.itemSubscriptions=[],this.lastStatusByIndex={},this.lastCreatedRollByIndex={},this.lastQuantityByIndex={},this.selectedQuotationItemIds.clear(),this.selectedDispatchItemIds.clear(),this.products=[],this.customers=[],this.transports=[]}initForm(){let t=new Date,n=new Date;n.setDate(t.getDate()+7),this.quotationForm=this.fb.group({customerId:[""],customerName:["",P.required],referenceName:[""],contactNumber:["",P.required],quoteDate:[F(t,"yyyy-MM-dd","en")],validUntil:[F(n,"yyyy-MM-dd","en"),[P.required]],remarks:[""],termsConditions:[""],items:this.fb.array([]),address:[""],isProduction:[!1],transportMasterId:[null,P.required],caseNumber:[""],packagingAndForwadingCharges:[0,[P.required,P.min(0)]]}),this.addItem(!0)}get isCustomerIdSelected(){return this.quotationForm?.get("customerId")?.value}setupCustomerNameSync(){this.quotationForm.get("customerId")?.valueChanges.pipe(f(this.destroy$)).subscribe(t=>{if(t){let n=this.customers.find(e=>e.id===t);n&&(this.quotationForm.patchValue({customerName:n.name}),this.quotationForm.patchValue({address:n.address}),this.quotationForm.patchValue({contactNumber:n.mobile}),this.quotationForm.patchValue({referenceName:n.referenceName}))}})}addItem(t=!1){let n=this.fb.group({productId:["",P.required],productName:[""],productType:[""],quantity:[0,[P.required,P.min(0)]],unitPrice:[0,[P.required,P.min(.01)]],isQuantityManual:[!1],remarks:[""],isDispatch:[!1],isProduction:[!1],id:[null],quotationItemStatus:["O",P.required],createdRoll:[null,[P.min(0)]],price:[0],taxPercentage:[0],taxAmount:[0],finalPrice:[0],quotationDiscountAmount:[0],calculations:[[]]});this.itemsFormArray.push(n);let e=this.itemsFormArray.length-1;this.setupItemCalculations(n,e),this.subscribeToItemChanges(this.itemsFormArray.at(e),e),this.calculateItemPrice(e,t),this.loadProducts(),this.loadCustomers(),this.loadTransports(),this.setupCustomerNameSync(),this.checkForEdit(),this.setupItemSubscriptions()}removeItem(t){this.itemSubscriptions[t]&&(this.itemSubscriptions[t].unsubscribe(),this.itemSubscriptions.splice(t,1)),this.itemsFormArray.removeAt(t),this.itemsFormArray.controls.forEach((n,e)=>{this.itemSubscriptions[e]&&this.itemSubscriptions[e].unsubscribe(),this.subscribeToItemChanges(n,e)}),this.cdr.detectChanges()}setupItemCalculations(t,n){t.get("productId")?.valueChanges.pipe(f(this.destroy$),bt(e=>!!e),A(100),Pt()).subscribe(e=>{let i=this.products.find(l=>l.id===e);i&&(t.patchValue({productType:i.type,productName:i.name,taxPercentage:i.tax_percentage??0,quantity:i.quantity||1},{emitEvent:!1}),t.patchValue({unitPrice:i.sale_amount||0},{emitEvent:!0}))}),t.get("quantity")?.valueChanges.pipe(f(this.destroy$),A(50)).subscribe(()=>this.markQuantityManual(n))}markQuantityManual(t){let n=this.itemsFormArray.at(t);n&&(n.get("isQuantityManual")?.value||n.patchValue({isQuantityManual:!0},{emitEvent:!1}))}onQuantityEdit(t){this.markQuantityManual(t),this.calculateItemPrice(t)}onQuantityFocus(t){let n=this.itemsFormArray.at(t),e=Number(n.get("quantity")?.value||0);this.lastQuantityByIndex[t]=e}onQuantityChange(t,n){let e=this.itemsFormArray.at(t);if(e.get("isDispatch")?.value===!0){let v=this.lastQuantityByIndex[t]??Number(e.get("quantity")?.value||0);e.patchValue({quantity:v},{emitEvent:!1}),this.cdr.detectChanges();return}let i=e.get("id")?.value,l=e.get("quotationItemStatus")?.value,m=n.target,O=Number(Number(m.value).toFixed(3)),S=this.lastQuantityByIndex[t]??Number(e.get("quantity")?.value||0);if(l==="B"){e.patchValue({quantity:S},{emitEvent:!1}),this.cdr.detectChanges();return}if(Number.isNaN(O)||O<0){this.snackbar.error("Invalid value for Quantity"),e.patchValue({quantity:S},{emitEvent:!1}),this.cdr.detectChanges();return}if(!i){this.lastQuantityByIndex[t]=O,this.onQuantityEdit(t);return}O!==S&&this.quotationService.updateQuotationItemQuantity(i,O).pipe(f(this.destroy$)).subscribe({next:v=>{v?.success?(this.snackbar.success(v?.message||"Quantity updated successfully"),this.lastQuantityByIndex[t]=O,this.onQuantityEdit(t)):(this.snackbar.error(v?.message||"Failed to update quantity"),e.patchValue({quantity:S},{emitEvent:!1}),this.cdr.detectChanges())},error:v=>{this.snackbar.error(v?.error?.message||"Failed to update quantity"),e.patchValue({quantity:S},{emitEvent:!1}),this.cdr.detectChanges()}})}calculateItemPrice(t,n=!1){let e=this.itemsFormArray.at(t),i=Number(Number(e.get("quantity")?.value||0).toFixed(3)),l=Number(Number(e.get("unitPrice")?.value||0).toFixed(2)),m=Number((i*l).toFixed(2));e.patchValue({price:m,taxAmount:0,finalPrice:m,quotationDiscountAmount:0},{emitEvent:!1}),n||this.cdr.detectChanges()}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data),this.isLoadingProducts=!1},error:()=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data,this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1},error:()=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1}})}loadTransports(){this.isLoadingTransports=!0,this.transportService.getTransports({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t?.success!==!1&&(this.transports=t.data||t.transports||[]),this.isLoadingTransports=!1},error:()=>{this.snackbar.error("Failed to load transports"),this.isLoadingTransports=!1}})}refreshTransports(){this.isLoadingTransports=!0,this.transportService.refreshTransports().pipe(f(this.destroy$)).subscribe({next:t=>{t?.success!==!1&&(this.transports=t.data||t.transports||[],this.snackbar.success("Transports refreshed successfully")),this.isLoadingTransports=!1},error:()=>{this.snackbar.error("Failed to refresh transports"),this.isLoadingTransports=!1}})}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data),this.isLoadingCustomers=!1},error:()=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:()=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}})}onProductSelect(t,n){let e=this.products.find(m=>m.id===n.value);if(!e)return;let i=this.itemsFormArray.at(t),l=this.itemSubscriptions[t];l&&(l.unsubscribe(),this.itemSubscriptions[t]=new Ct),i.patchValue({productId:e.id},{emitEvent:!0}),this.itemSubscriptions[t]||this.subscribeToItemChanges(i,t)}checkForEdit(){let t=localStorage.getItem("editQuotationId");if(t)try{let n=this.encryptionService.decrypt(t);if(!n){localStorage.removeItem("editQuotationId");return}this.isLoading=!0,this.quotationService.getQuotationDetail(parseInt(n)).pipe(f(this.destroy$)).subscribe({next:e=>{e&&(this.quotationId=parseInt(n),this.isEdit=!0,this.populateForm(e.data)),this.isLoading=!1},error:()=>{this.snackbar.error("Failed to load quotation details"),this.isLoading=!1,localStorage.removeItem("editQuotationId")}})}catch{localStorage.removeItem("editQuotationId")}}populateForm(t){return Dt(this,null,function*(){if(t){for(this.itemSubscriptions.forEach(n=>n?.unsubscribe()),this.itemSubscriptions=[];this.itemsFormArray.length;)this.itemsFormArray.removeAt(0);this.quotationForm.patchValue({customerName:t.customerName,customerId:t.customerId,referenceName:t.referenceName||"",quoteDate:t.quoteDate,validUntil:t.validUntil,remarks:t.remarks||"",termsConditions:t.termsConditions||"",address:t.address,contactNumber:t.contactNumber,transportMasterId:t.transportMasterId||null,caseNumber:t.caseNumber||"",packagingAndForwadingCharges:t.packagingAndForwadingCharges??0}),t.items&&Array.isArray(t.items)&&t.items.forEach((n,e)=>{let i=this.fb.group({id:[n.id||null],productId:[n.productId||"",P.required],productName:[n.productName||n.product?.name||""],productType:[n.productType||""],quantity:[n.quantity||1,[P.required,P.min(1)]],unitPrice:[n.unitPrice||0,[P.required,P.min(.01)]],remarks:[n.remarks||""],isProduction:[n.isProduction??!1],isDispatch:[n.isDispatch??!1],quotationItemStatus:[n.quotationItemStatus??"O",P.required],createdRoll:[n.createdRoll??null,[P.min(0)]],price:[n.price||0],taxPercentage:[n.taxPercentage??0],taxAmount:[n.taxAmount||0],finalPrice:[n.finalPrice||0],quotationDiscountAmount:[n.quotationDiscountAmount||0],calculations:[n.calculations||[]]});this.setupItemCalculations(i,this.itemsFormArray.length),this.itemsFormArray.push(i),this.subscribeToItemChanges(i,this.itemsFormArray.length-1)}),this.itemsFormArray.controls.forEach((n,e)=>{this.calculateItemPrice(e)}),this.cdr.detectChanges()}})}onSubmit(){if(this.quotationForm.valid){this.isLoading=!0;let t=this.prepareFormData();(this.isEdit?this.quotationService.updateQuotation(this.quotationId,t):this.quotationService.createQuotation(t)).pipe(f(this.destroy$)).subscribe({next:e=>{e.success&&(this.snackbar.success(`Quotation ${this.isEdit?"updated":"created"} successfully`),this.quotationForm.reset(),this.router.navigate(["/quotation"])),this.isLoading=!1},error:e=>{this.snackbar.error(e?.error?.message||`Failed to ${this.isEdit?"update":"create"} quotation`),this.isLoading=!1}})}}prepareFormData(){let t=this.quotationForm.value,n=this.itemsFormArray.controls.map(i=>({id:i.get("id")?.value,productId:i.get("productId")?.value,productName:i.get("productName")?.value,productType:i.get("productType")?.value,quantity:i.get("quantity")?.value,unitPrice:i.get("unitPrice")?.value,remarks:i.get("remarks")?.value,isProduction:i.get("isProduction")?.value,isDispatch:i.get("isDispatch")?.value,quotationItemStatus:i.get("quotationItemStatus")?.value,createdRoll:i.get("createdRoll")?.value,price:i.get("price")?.value,taxPercentage:i.get("taxPercentage")?.value,taxAmount:i.get("taxAmount")?.value,finalPrice:i.get("finalPrice")?.value,quotationDiscountAmount:i.get("quotationDiscountAmount")?.value,calculations:i.get("calculations")?.value||[]}));return{customerId:t.customerId,customerName:t.customerName,referenceName:t.referenceName,contactNumber:t.contactNumber,quoteDate:F(t.quoteDate,"yyyy-MM-dd","en"),validUntil:F(t.validUntil,"yyyy-MM-dd","en"),remarks:t.remarks,termsConditions:t.termsConditions,address:t.address,transportMasterId:t.transportMasterId,caseNumber:t.caseNumber,packagingAndForwadingCharges:Number(t.packagingAndForwadingCharges||0),items:n}}setupItemSubscriptions(){this.itemsFormArray.controls.forEach((t,n)=>{this.subscribeToItemChanges(t,n)})}subscribeToItemChanges(t,n){this.itemSubscriptions[n]&&this.itemSubscriptions[n].unsubscribe();let e=t.valueChanges.pipe(f(this.destroy$),A(100)).subscribe(()=>{this.calculateItemPrice(n)});this.itemSubscriptions[n]=e}onStatusChange(t,n){let e=this.itemsFormArray.at(t),i=e.get("id")?.value;if(!i)return;let m=n.target.value,O=this.lastStatusByIndex[t]??e.get("quotationItemStatus")?.value;if(O===m)return;if(!["O","IP","C","B"].includes(m)){this.snackbar.error("Invalid status value"),e.patchValue({quotationItemStatus:O},{emitEvent:!1}),this.cdr.detectChanges();return}if(O==="IP"&&m==="O"||O==="C"&&(m==="O"||m==="IP")||O==="B"&&(m==="O"||m==="IP"||m==="C")){this.snackbar.error("Invalid transition. Status can only move forward."),e.patchValue({quotationItemStatus:O},{emitEvent:!1}),this.cdr.detectChanges();return}this.quotationService.updateQuotationItemStatus(i,m).pipe(f(this.destroy$)).subscribe({next:I=>{I?.success?(this.snackbar.success("Status updated successfully"),this.lastStatusByIndex[t]=m):(this.snackbar.error(I?.message||"Failed to update status"),e.patchValue({quotationItemStatus:O},{emitEvent:!1}),this.cdr.detectChanges())},error:I=>{this.snackbar.error(I?.error?.message||"Failed to update status"),e.patchValue({quotationItemStatus:O},{emitEvent:!1}),this.cdr.detectChanges()}})}onStatusFocus(t){let e=this.itemsFormArray.at(t).get("quotationItemStatus")?.value;this.lastStatusByIndex[t]=e}onCreatedRollFocus(t){let e=this.itemsFormArray.at(t).get("createdRoll")?.value,i=e===null||e===""?null:Number(e);this.lastCreatedRollByIndex[t]=i}onCreatedRollChange(t,n){let e=this.itemsFormArray.at(t),l=(()=>{let E=this.lastCreatedRollByIndex[t];if(E!==void 0)return E;let at=e.get("createdRoll")?.value;return at===null||at===""?null:Number(at)})();if(e.get("isDispatch")?.value===!0){e.patchValue({createdRoll:l},{emitEvent:!1}),this.cdr.detectChanges();return}let m=e.get("id")?.value;if(!m)return;let S=n.target.value,v=S===""?null:Number(S);if(v!==null&&(Number.isNaN(v)||v<0)){this.snackbar.error("Invalid value for Created Roll"),e.patchValue({createdRoll:l},{emitEvent:!1}),this.cdr.detectChanges();return}let I=Number(e.get("quantity")?.value||0);if(v!==null&&v>I){this.snackbar.error("Send quantity cannot be greater than Quantity"),e.patchValue({createdRoll:l},{emitEvent:!1}),this.cdr.detectChanges();return}v!==l&&this.quotationService.updateQuotationItemCreatedRoll(m,v).pipe(f(this.destroy$)).subscribe({next:E=>{E?.status==="success"||E?.success?(this.snackbar.success("Created roll updated successfully"),this.lastCreatedRollByIndex[t]=v):(this.snackbar.error(E?.message||"Failed to update created roll"),e.patchValue({createdRoll:l},{emitEvent:!1}),this.cdr.detectChanges())},error:E=>{this.snackbar.error(E?.error?.message||"Failed to update created roll"),e.patchValue({createdRoll:l},{emitEvent:!1}),this.cdr.detectChanges()}})}onProductionClick(t,n){let i=this.itemsFormArray.at(t).get("quotationItemStatus")?.value;if(i==null||i===""||i!=="O")return n.preventDefault(),n.stopPropagation(),this.snackbar.error("Allowed only when status is Open"),!1}onProductionToggle(t){let n=this.itemsFormArray.at(t),e=n.get("quotationItemStatus")?.value;if(e==null||e===""||e!=="O"){let m=!!n.get("isProduction")?.value;n.patchValue({isProduction:!m},{emitEvent:!1});return}let i=n.get("id")?.value,l=!!n.get("isProduction")?.value;i&&this.quotationService.updateQuotationItemProductionStatus(i,l).pipe(f(this.destroy$)).subscribe({next:m=>{this.snackbar.success("Production status updated")},error:()=>{this.snackbar.error("Failed to update production status"),n.patchValue({isProduction:!l},{emitEvent:!1}),this.cdr.detectChanges()}})}onDispatchToggle(t){let n=this.itemsFormArray.at(t),e=n.get("id")?.value;if(!e)return;let i=!!n.get("isDispatch")?.value;this.quotationService.updateQuotationItemDispatch(e,i).pipe(f(this.destroy$)).subscribe({next:l=>{this.snackbar.success("Dispatch status updated")},error:()=>{this.snackbar.error("Failed to update dispatch status"),n.patchValue({isDispatch:!i},{emitEvent:!1}),this.cdr.detectChanges()}})}getQuotationItemIdByIndex(t){let e=this.itemsFormArray.at(t)?.get("id")?.value;return typeof e=="number"?e:null}isSelectable(t){let e=this.itemsFormArray.at(t)?.get("quotationItemStatus")?.value;return!!this.getQuotationItemIdByIndex(t)&&e!=="B"}isSelected(t){let n=this.getQuotationItemIdByIndex(t);return n?this.selectedQuotationItemIds.has(n):!1}toggleSelection(t,n){let e=this.getQuotationItemIdByIndex(t);if(!e)return;n.target.checked?this.selectedQuotationItemIds.add(e):this.selectedQuotationItemIds.delete(e)}hasSelection(){return this.selectedQuotationItemIds.size>0}hasDispatchSelection(){return this.selectedDispatchItemIds.size>0}isDispatchSelected(t){let n=this.getQuotationItemIdByIndex(t);return n?this.selectedDispatchItemIds.has(n):!1}toggleDispatchSelection(t,n){let e=this.getQuotationItemIdByIndex(t);if(!e)return;n.target.checked?this.selectedDispatchItemIds.add(e):this.selectedDispatchItemIds.delete(e)}createDispatchSlip(){let t=Array.from(this.selectedDispatchItemIds);if(!t.length){this.snackbar.error("Please select at least one item for dispatch");return}if(!this.quotationId){this.snackbar.error("Quotation ID not found");return}this.isLoading=!0,this.quotationService.generateDispatchPdf(this.quotationId,t).pipe(f(this.destroy$)).subscribe({next:n=>{let e=window.URL.createObjectURL(n.blob),i=document.createElement("a");i.href=e,i.download=n.filename,i.click(),window.URL.revokeObjectURL(e),this.snackbar.success("Dispatch slip generated successfully"),this.isLoading=!1},error:n=>{this.snackbar.error(n?.error?.message||"Failed to generate dispatch slip"),this.isLoading=!1}})}createSaleFromSelected(){if(!Array.from(this.selectedQuotationItemIds).length){this.snackbar.error("Please select at least one item");return}this.showPackagingChargesModal=!0}onPackagingChargesConfirm(t){this.showPackagingChargesModal=!1;let n=Array.from(this.selectedQuotationItemIds);this.isLoading=!0,this.saleService.createFromQuotationItems(n,t).pipe(f(this.destroy$)).subscribe({next:e=>{e?.success?(this.snackbar.success(e?.message||"Sale created successfully"),this.selectedQuotationItemIds.clear()):this.snackbar.error(e?.message||"Failed to create sale"),this.isLoading=!1,this.initForm(),this.cdr.detectChanges()},error:e=>{this.snackbar.error(e?.error?.message||"Failed to create sale"),this.isLoading=!1,this.cdr.detectChanges()}})}onPackagingChargesCancel(){this.showPackagingChargesModal=!1}static{this.\u0275fac=function(n){return new(n||c)(C(Y),C(nt),C(ct),C(rt),C(Wt),C(tt),C(it),C(J),C(Bt),C(Ot),C(Ce),C(mt))}}static{this.\u0275cmp=V({type:c,selectors:[["app-dispatch-quotation"]],standalone:!0,features:[L],decls:121,vars:25,consts:[[1,"add-quotation-container"],["routerLink","/quotation/dispatch-list",1,"btn","btn-sm","btn-secondary","back-btn"],[1,"fas","fa-arrow-left"],[1,"form-card"],[1,"card-header"],[1,"form-title"],[1,"fas",3,"ngClass"],[1,"quotation-form",3,"ngSubmit","keydown.enter","formGroup"],[1,"create-quotation-section"],[1,"create-quotation-header"],[1,"fa-solid","fa-receipt"],[1,"header-section"],[1,"form-row"],[1,"form-group"],[1,"fas","fa-user"],[1,"select-group"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","placeholder","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],[1,"fas","fa-user-tag"],[1,"required"],["type","text","formControlName","customerName","placeholder","Enter customer name",1,"form-control",3,"readonly"],[1,"fas","fa-id-card"],["type","text","formControlName","referenceName","placeholder","Optional reference name",1,"form-control"],[1,"fa-solid","fa-phone"],["type","text","formControlName","contactNumber","placeholder","Enter contact number",1,"form-control"],[1,"fa-solid","fa-location-dot"],["formControlName","address","rows","3","placeholder","Write customer address details...",1,"form-control"],[1,"fas","fa-calendar"],["type","date","formControlName","quoteDate","readonly","",1,"form-control"],[1,"fas","fa-calendar-check"],["type","date","formControlName","validUntil",1,"form-control",3,"min"],[1,"fas","fa-truck"],["formControlName","transportMasterId","labelKey","name","valueKey","id",3,"options","placeholder","searchPlaceholder"],["type","button","title","Refresh Transports",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],[1,"fas","fa-briefcase"],["type","text","formControlName","caseNumber","placeholder","Enter case number",1,"form-control"],["formArrayName","items",1,"products-section"],[1,"products-header"],[1,"fas","fa-boxes"],["type","button","class","btn btn-info me-2",3,"click",4,"ngIf"],["type","button","class","btn btn-success me-2",3,"click",4,"ngIf"],[1,"table-responsive"],[1,"table","products-table"],[1,"status-col"],[1,"created-roll-col"],[3,"formGroupName","dispatched-row",4,"ngFor","ngForOf"],[1,"d-flex","mt-3","align-items-end","justify-content-between"],[1,"form-group","w-50"],[1,"fas","fa-comment"],["formControlName","remarks","rows","3","placeholder","Optional remarks",1,"form-control"],[1,"fas","fa-file-contract"],["formControlName","termsConditions","rows","3","placeholder","Optional terms and conditions",1,"form-control"],[1,"d-flex","mt-3"],[1,"fas","fa-box"],["type","number","formControlName","packagingAndForwadingCharges","min","0","step","0.01",1,"form-control"],[4,"ngIf"],[3,"confirm","cancel","show","defaultCharges"],["type","button",1,"btn","btn-info","me-2",3,"click"],[1,"fa-solid","fa-file-pdf"],["type","button",1,"btn","btn-success","me-2",3,"click"],[1,"fa-solid","fa-cart-plus"],[3,"formGroupName"],[1,"d-flex","flex-column","gap-2"],[1,"small","text-muted"],["type","checkbox","title","Select for dispatch slip",3,"change","checked"],[1,"form-field-container"],["type","number","formControlName","quantity","min","0","step","0.001",1,"form-control",3,"focus","change","input","readonly"],["type","text","formControlName","remarks","placeholder","Remarks",1,"form-control"],["type","checkbox","formControlName","isDispatch",3,"change"],["type","number","formControlName","createdRoll","min","0","step","1",1,"form-control",3,"focus","change","readonly"],["type","checkbox","title","Select for sale creation",3,"change","checked"],["formControlName","quotationItemStatus",1,"form-control",3,"focus","change","disabled"],["value","O"],["value","I"],["value","C"],["value","B"]],template:function(n,e){if(n&1&&(o(0,"div",0)(1,"button",1),d(2,"i",2),a(3," Back to Quotations "),r(),o(4,"div",3)(5,"div",4)(6,"h2",5),d(7,"i",6),a(8),r()(),o(9,"form",7),g("ngSubmit",function(){return e.onSubmit()})("keydown.enter",function(l){return l.preventDefault()}),o(10,"div",8)(11,"div",9)(12,"h3"),d(13,"i",10),a(14," Dispatch Quotation "),r()(),o(15,"div",11)(16,"div",12)(17,"div",13)(18,"label"),d(19,"i",14),a(20," Select Customer"),r(),o(21,"div",15),d(22,"app-searchable-select",16),o(23,"button",17),g("click",function(){return e.refreshCustomers()}),d(24,"i",6),r()()(),o(25,"div",13)(26,"label"),d(27,"i",18),a(28," Customer Name "),o(29,"span",19),a(30,"*"),r()(),d(31,"input",20),r(),o(32,"div",13)(33,"label"),d(34,"i",21),a(35," Reference Name"),r(),d(36,"input",22),r(),o(37,"div",13)(38,"label"),d(39,"i",23),a(40," Contact Number "),o(41,"span",19),a(42,"*"),r()(),d(43,"input",24),r(),o(44,"div",13)(45,"label"),d(46,"i",25),a(47," Address"),r(),d(48,"textarea",26),r(),o(49,"div",13)(50,"label"),d(51,"i",27),a(52," Quote Date"),r(),d(53,"input",28),r(),o(54,"div",13)(55,"label"),d(56,"i",29),a(57," Valid Until "),o(58,"span",19),a(59,"*"),r()(),d(60,"input",30),r(),o(61,"div",13)(62,"label"),d(63,"i",31),a(64," Transport"),r(),o(65,"div",15),d(66,"app-searchable-select",32),o(67,"button",33),g("click",function(){return e.refreshTransports()}),d(68,"i",6),r()()(),o(69,"div",13)(70,"label"),d(71,"i",34),a(72," Case Number"),r(),d(73,"input",35),r()()()(),o(74,"div",36)(75,"div",37)(76,"h3"),d(77,"i",38),a(78," Products"),r(),o(79,"div"),M(80,gn,3,0,"button",39)(81,hn,3,0,"button",40),r()(),o(82,"div",41)(83,"table",42)(84,"thead")(85,"tr")(86,"th"),a(87,"Sale/dispatch"),r(),o(88,"th"),a(89,"Product"),r(),o(90,"th"),a(91,"Quantity"),r(),o(92,"th"),a(93,"Remarks"),r(),o(94,"th"),a(95,"Dispatch"),r(),o(96,"th",43),a(97,"Status"),r(),o(98,"th",44),a(99,"Send quantity"),r()()(),o(100,"tbody"),M(101,bn,21,9,"tr",45),r()()()(),o(102,"div",46)(103,"div",47)(104,"label"),d(105,"i",48),a(106," Remarks"),r(),d(107,"textarea",49),r(),o(108,"div",47)(109,"label"),d(110,"i",50),a(111," Terms & Conditions"),r(),d(112,"textarea",51),r()(),o(113,"div",52)(114,"div",47)(115,"label"),d(116,"i",53),a(117," Packaging & Forwarding Charges"),r(),d(118,"input",54),r()()()()(),M(119,Pn,1,0,"app-loader",55),o(120,"app-packaging-charges-modal",56),g("confirm",function(l){return e.onPackagingChargesConfirm(l)})("cancel",function(){return e.onPackagingChargesCancel()}),r()),n&2){let i,l;s(7),u("ngClass",e.isEdit?"fa-edit":"fa-truck-loading"),s(),w(" ",e.isEdit?"Edit":"Dispatch"," Quotation "),s(),u("formGroup",e.quotationForm),s(13),u("options",e.customers)("placeholder","Select Customer")("searchPlaceholder","Search customers..."),s(),u("disabled",e.isLoadingCustomers),s(),u("ngClass",e.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt"),s(7),k("is-invalid",(i=e.quotationForm.get("customerName"))==null?null:i.invalid),u("readonly",e.isCustomerIdSelected),s(12),k("is-invalid",(l=e.quotationForm.get("contactNumber"))==null?null:l.invalid),s(17),u("min",e.minValidUntilDate),s(6),u("options",e.transports)("placeholder","Select Transport")("searchPlaceholder","Search transports..."),s(),u("disabled",e.isLoadingTransports),s(),u("ngClass",e.isLoadingTransports?"fa-spinner fa-spin":"fa-sync-alt"),s(12),u("ngIf",e.hasDispatchSelection()),s(),u("ngIf",e.canSeeSaleOption&&e.hasSelection()),s(20),u("ngForOf",e.itemsFormArray.controls),s(18),u("ngIf",e.loading),s(),u("show",e.showPackagingChargesModal)("defaultCharges",0)}},dependencies:[et,D,z,H,$,K,U,jt,Rt,Z,dt,me,he,j,R,ut,B,G,Mt,xt,ot,Q,vt,gt,st,Oe],styles:[".btn[_ngcontent-%COMP%]{padding:8px;border:none;border-radius:4px;cursor:pointer;transition:all .3s ease;font-weight:500;touch-action:manipulation}@media (max-width: 768px){.btn[_ngcontent-%COMP%]{min-height:44px;min-width:44px}}.add-quotation-container[_ngcontent-%COMP%]{padding:2rem;margin:0 auto;-webkit-overflow-scrolling:touch;touch-action:pan-y}@media (max-width: 768px){.add-quotation-container[_ngcontent-%COMP%]{padding:1rem;overflow-x:hidden}}.back-btn[_ngcontent-%COMP%]{margin-bottom:1rem}.form-card[_ngcontent-%COMP%]{background:#fff;border-radius:var(--border-radius);box-shadow:var(--card-shadow);overflow:hidden}.card-header[_ngcontent-%COMP%]{background-color:var(--primary);padding:1.5rem}.card-header[_ngcontent-%COMP%]   .form-title[_ngcontent-%COMP%]{color:#fff;margin:0;font-size:1.5rem;font-weight:500;display:flex;align-items:center;gap:.5rem}.quotation-form[_ngcontent-%COMP%]{padding:2rem}@media (max-width: 768px){.quotation-form[_ngcontent-%COMP%]{padding:1rem}}.header-section[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);margin-bottom:2rem}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:0px 10px}@media (max-width: 768px){.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}.quotation-row[_ngcontent-%COMP%]{display:flex}.quotation-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{width:60%;height:90px;margin-bottom:0}.quotation-row[_ngcontent-%COMP%]   .product-delete-btn[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.quotation-product[_ngcontent-%COMP%]{border:1px solid var(--primary);padding:20px}.dialog-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);z-index:1000}.dialog[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border-radius:12px;min-width:400px;max-width:90%;width:900px;z-index:1001;box-shadow:0 8px 32px #0000001a;margin:1rem}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1rem 1.5rem;border-bottom:1px solid var(--border-color, #e0e0e0);background-color:var(--background);border-radius:12px 12px 0 0}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;color:var(--text-primary);display:flex;align-items:center;gap:.5rem}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary);font-size:1.1em}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-secondary);font-size:1.5rem;width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;padding:0;margin:-.5rem -.5rem -.5rem 0}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:hover{background-color:#0000000d;color:var(--text-primary)}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]:active{background-color:#0000001a}.table-container[_ngcontent-%COMP%]{width:90%;margin:30px auto;padding:20px;background-color:#f0f8ff;border-radius:10px;box-shadow:0 4px 8px #0000001a}.custom-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border:1px solid #ddd}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:center;border:1px solid #ddd}.custom-table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:85%}.custom-table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button, .custom-table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.custom-table[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield;appearance:textfield}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#09c;color:#fff;font-size:1.1rem;font-weight:700}.custom-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#e6f7ff}.custom-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#fff}.form-input[_ngcontent-%COMP%]{width:100%;padding:8px;border-radius:5px;border:1px solid #ccc;text-align:center}@media (max-width: 768px){.table-container[_ngcontent-%COMP%]{width:95%}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:.9rem}}.create-quotation-section[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]{background-color:#fff;border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;border:1px solid var(--primary)}.create-quotation-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%], .create-quotation-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.create-quotation-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .create-quotation-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.25rem;display:flex;align-items:center;gap:.5rem}.create-quotation-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .create-quotation-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .create-quotation-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .products-section[_ngcontent-%COMP%]   .products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.product-item[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-bottom:1rem;position:relative}.product-item[_ngcontent-%COMP%]   .product-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr 1fr 1fr 1fr 1fr auto;gap:1rem;align-items:start}@media (max-width: 1200px){.product-item[_ngcontent-%COMP%]   .product-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}}@media (max-width: 768px){.product-item[_ngcontent-%COMP%]   .product-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]{background-color:var(--danger-light);color:var(--danger);border:none;width:36px;height:36px;border-radius:var(--border-radius);display:flex;align-items:center;justify-content:center;transition:all .3s ease}.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--danger);color:#fff;transform:translateY(-1px)}.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}@media (max-width: 768px){.product-item[_ngcontent-%COMP%]   .remove-product[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem}}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem;color:var(--text-primary);font-weight:500}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:var(--danger);margin-left:4px}.input-group[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:wrap;align-items:stretch;width:100%}.input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.375rem .75rem;font-size:1rem;font-weight:400;line-height:1.5;color:#495057;text-align:center;white-space:nowrap;background-color:#e9ecef;border:1px solid #ced4da;border-radius:0 .25rem .25rem 0;border-left:none}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{position:relative;flex:1 1 auto;width:1%;min-width:0;margin-bottom:0}.input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:not(:last-child){border-top-right-radius:0;border-bottom-right-radius:0}.quotation-summary[_ngcontent-%COMP%]{background-color:var(--background-light);border-radius:var(--border-radius);padding:1.5rem;margin-top:2rem;display:flex;justify-content:flex-end;gap:2rem;flex-wrap:wrap}.quotation-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.quotation-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.quotation-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-primary);font-size:1.25rem;font-weight:600}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}@media (max-width: 576px){.form-actions[_ngcontent-%COMP%]{flex-direction:column}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}.table-responsive[_ngcontent-%COMP%]{margin:0 -1.5rem;padding:0 1.5rem;overflow-x:auto;min-height:500px;-webkit-overflow-scrolling:touch;touch-action:pan-x}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar{height:8px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:4px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}.table-responsive[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@media (max-width: 768px){.table-responsive[_ngcontent-%COMP%]{margin:0 -1rem;padding:0 1rem}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]{font-size:.875rem}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.5rem .25rem;min-width:80px}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:.875rem;padding:.25rem}}.products-table[_ngcontent-%COMP%]{width:100%;margin-bottom:0;background:#fff;border-collapse:separate;border-spacing:0}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--background-light);color:var(--text-primary);font-weight:200;padding:1rem;white-space:nowrap;border-bottom:2px solid var(--border-color)}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10;background-color:var(--background-light);padding:.75rem .5rem;font-size:.8rem}}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;vertical-align:middle;border-bottom:1px solid var(--border-color)}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{min-height:40px;font-size:16px}}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:38px}.products-table[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex-wrap:nowrap}.products-table[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{margin:0 auto}@media (max-width: 768px){.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.5rem .25rem}}.form-field-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;min-width:250px}.form-field-container[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%], .form-field-container[_ngcontent-%COMP%]   .input-group.is-invalid[_ngcontent-%COMP%]{border-color:var(--danger);background-image:url(data:image/svg+xml,...)}.form-field-container-brand[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;min-width:200px}.form-field-container-brand[_ngcontent-%COMP%]   .form-control.is-invalid[_ngcontent-%COMP%], .form-field-container-brand[_ngcontent-%COMP%]   .input-group.is-invalid[_ngcontent-%COMP%]{border-color:var(--danger);background-image:url(data:image/svg+xml,...)}.calc-type-col[_ngcontent-%COMP%], .dropdown[_ngcontent-%COMP%]{min-width:130px}.products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-bottom:1.5rem;vertical-align:top}.invalid-feedback[_ngcontent-%COMP%]{color:var(--danger);font-size:.75rem;margin-top:.25rem;animation:_ngcontent-%COMP%_fadeIn .3s ease-in}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}.select-group[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:.5rem;width:100%;position:relative}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1;z-index:100}@media (max-width: 768px){.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{position:relative}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]     .dropdown-menu{position:fixed!important;top:auto!important;left:1rem!important;right:1rem!important;width:calc(100vw - 2rem)!important;max-width:none!important;z-index:1000!important;box-shadow:0 4px 20px #00000026!important;border-radius:8px!important;max-height:50vh!important;overflow-y:auto!important}}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{padding:.75rem;height:35px;width:35px;display:flex;align-items:center;justify-content:center;border:1px solid var(--supporting);border-radius:8px;background:#fff;transition:all .3s ease;color:var(--primary);touch-action:manipulation}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary);color:#fff}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}@media (max-width: 768px){.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{height:44px;width:44px}}.select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.totals-row[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:700}.totals-row[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:2px solid #dee2e6}.totals-row[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:#fff}.search-input[_ngcontent-%COMP%]{height:43px!important}.products-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);font-size:1.25rem;display:flex;align-items:center;gap:.5rem}.products-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:var(--primary)}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:1rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]{margin-bottom:0}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;white-space:nowrap}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{display:flex;align-items:center}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{height:38px;min-width:80px}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   .input-group-text[_ngcontent-%COMP%]{height:38px;display:flex;align-items:center;background-color:var(--background-light);border-color:var(--border-color)}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]   .invalid-feedback[_ngcontent-%COMP%]{position:absolute;font-size:.75rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:38px;display:flex;align-items:center;justify-content:center;gap:.5rem;white-space:nowrap}@media (max-width: 768px){.products-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]{width:100%;margin-top:.75rem;flex-direction:column;align-items:stretch}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-group[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap;min-width:100px}}.quotation-discount-wrapper[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:15px;flex-wrap:wrap}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{min-width:150px;margin-bottom:0}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.9rem;margin-bottom:3px;color:#555;font-weight:500}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]{flex-wrap:nowrap}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-align:right;width:100px}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap;padding:.5rem}@media (max-width: 768px){.quotation-discount-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{margin-bottom:10px}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}}@media (max-width: 768px){.products-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]{width:100%;margin-top:.75rem;flex-direction:column;align-items:stretch}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:16px;height:44px}.products-header[_ngcontent-%COMP%]   .quotation-discount-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;height:44px;font-size:16px}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{white-space:nowrap;min-width:80px;font-size:.875rem}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1), .table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(1){min-width:150px}.table-responsive[_ngcontent-%COMP%]   .products-table[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-size:16px!important;padding:.5rem!important;min-height:40px!important}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px!important;min-height:44px!important;padding:.75rem!important}.form-actions[_ngcontent-%COMP%]{gap:.75rem}.form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{height:44px;font-size:16px}}@media (max-width: 768px){.quotation-discount-wrapper[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]{margin-bottom:10px}.quotation-discount-wrapper[_ngcontent-%COMP%]   .quotation-discount-field[_ngcontent-%COMP%]   .input-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;font-size:16px;height:44px}.add-quotation-container[_ngcontent-%COMP%]{overflow-x:hidden;touch-action:pan-y}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{gap:1rem}.header-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1rem}}.card-header[_ngcontent-%COMP%]{background-image:linear-gradient(135deg,var(--primary) 0%,#1d976c 100%)}.products-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.form-field-container[_ngcontent-%COMP%]{position:relative;margin-bottom:1rem;min-width:100px!important}.select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{width:120px!important}.products-table[_ngcontent-%COMP%]   tr.dispatched-row[_ngcontent-%COMP%]{background-color:#c5c6c7}.products-table[_ngcontent-%COMP%]   td.status-col[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   th.status-col[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   th.status-col[_ngcontent-%COMP%], .products-table[_ngcontent-%COMP%]   td.status-col[_ngcontent-%COMP%]{min-width:85px}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto}"]})}}return c})();var On=()=>({label:"All Customers",value:""}),Mn=()=>({label:"All Status",value:""});function xn(c,b){if(c&1){let t=x();o(0,"button",36),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.toggleStatusDropdown(e))}),d(1,"i",37),r()}if(c&2){let t=p().$implicit;u("disabled",t.isUpdating)}}function vn(c,b){if(c&1){let t=x();o(0,"div",40),g("click",function(){let e=h(t).$implicit,i=p(2).$implicit,l=p();return _(l.updateStatus(i,e.value))}),d(1,"i",10),a(2),r()}if(c&2){let t=b.$implicit,n=p(3);k("disabled",t.disabled),s(),u("ngClass",n.getStatusIcon(t.value)),s(),w(" ",t.label," ")}}function yn(c,b){if(c&1&&(o(0,"div",38),M(1,vn,3,4,"div",39),r()),c&2){let t=p().$implicit,n=p();s(),u("ngForOf",n.getAvailableStatusOptions(t.status))}}function wn(c,b){if(c&1){let t=x();o(0,"button",41),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.editQuotation(e.id))}),d(1,"i",42),r()}}function Sn(c,b){if(c&1){let t=x();o(0,"button",43),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.printQuotationPdf(e.id,e))}),d(1,"i",44),r()}}function kn(c,b){if(c&1){let t=x();o(0,"button",45),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.dispatchQuotation(e.id))}),d(1,"i",46),r()}}function In(c,b){if(c&1){let t=x();o(0,"button",47),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.generatePdf(e.id,e))}),d(1,"i",10),r()}if(c&2){let t=p().$implicit;u("disabled",t.isPrinting),s(),u("ngClass",t.isPrinting?"fa-spinner fa-spin":"fa-print")}}function qn(c,b){if(c&1){let t=x();o(0,"button",48),g("click",function(){h(t);let e=p().$implicit,i=p();return _(i.deleteQuotation(e.id))}),d(1,"i",49),r()}}function Fn(c,b){if(c&1){let t=x();o(0,"tr")(1,"td"),a(2),r(),o(3,"td"),a(4),r(),o(5,"td"),a(6),o(7,"button",24),g("click",function(){let e=h(t).$implicit,i=p();return _(i.openWhatsApp(e.contactNumber))}),d(8,"i",25),r()(),o(9,"td"),a(10),N(11,"date"),r(),o(12,"td"),a(13),N(14,"date"),r(),o(15,"td")(16,"div",26)(17,"span",27),d(18,"i",10),a(19),r(),M(20,xn,2,1,"button",28)(21,yn,2,1,"div",29),r()(),o(22,"td",30),M(23,wn,2,0,"button",31)(24,Sn,2,0,"button",32)(25,kn,2,0,"button",33)(26,In,2,2,"button",34)(27,qn,2,0,"button",35),r()()}if(c&2){let t=b.$implicit,n=b.index,e=p();s(2),y(e.startIndex+n+1),s(2),y(t.quoteNumber),s(2),w("",t.customerName," "),s(4),y(T(11,15,t.quoteDate,"dd-MM-yyyy")),s(3),y(T(14,18,t.validUntil,"dd-MM-yyyy")),s(4),u("ngClass",e.getStatusClass(t.status)),s(),u("ngClass",e.getStatusIcon(t.status)),s(),w(" ",e.getStatusLabel(t.status)," "),s(),u("ngIf",e.canChangeStatus(t.status)),s(),u("ngIf",t.showStatusDropdown),s(2),u("ngIf",e.canEditQuotation()&&(t.status=="D"||t.status=="Q"||t.status=="A"||t.status=="C"||t.status=="PC")),s(),u("ngIf",e.canDispatchQuotation()),s(),u("ngIf",e.canDispatchQuotation()),s(),u("ngIf",e.canEditQuotation()),s(),u("ngIf",e.canEditQuotation()&&(t.status=="D"||t.status=="Q"||t.status=="A"||t.status=="C"||t.status=="PC"))}}function En(c,b){if(c&1){let t=x();o(0,"app-pagination",50),g("pageChange",function(e){h(t);let i=p();return _(i.onPageChange(e))})("pageSizeChange",function(e){h(t);let i=p();return _(i.onPageSizeChange(e))}),r()}if(c&2){let t=p();u("currentPage",t.currentPage)("pageSize",t.pageSize)("totalElements",t.totalElements)("pageSizeOptions",t.pageSizeOptions)}}var xe=(()=>{class c{constructor(t,n,e,i,l,m,O,S,v,I){this.quotationService=t,this.customerService=n,this.fb=e,this.snackbar=i,this.dialog=l,this.modalService=m,this.dateUtils=O,this.encryptionService=S,this.router=v,this.authService=I,this.quotations=[],this.isLoading=!1,this.statusOptions=[],this.currentPage=0,this.pageSize=10,this.pageSizeOptions=[5,10,25,50,100],this.totalPages=0,this.totalElements=0,this.startIndex=0,this.endIndex=0,this.selectedQuotation=null,this.products=[],this.isLoadingProducts=!1,this.customers=[],this.isLoadingCustomers=!1,this.destroy$=new W,this.initializeForm(),this.statusOptions=Object.entries(q).map(([E,at])=>({label:at,value:E})),this.setupClickOutsideListener()}ngOnInit(){this.loadQuotations(),this.loadCustomers()}initializeForm(){this.searchForm=this.fb.group({search:[""],customerId:[""],startDate:[""],endDate:[""],quotationStatus:[["A","P","PC","C"]]})}loadQuotations(){this.isLoading=!0;let t=ft({currentPage:this.currentPage,perPageRecord:this.pageSize,startDate:this.searchForm.value.startDate?this.dateUtils.formatDate(this.searchForm.value.startDate):"",endDate:this.searchForm.value.endDate?this.dateUtils.formatDate(this.searchForm.value.endDate):""},this.searchForm.value);this.quotationService.searchQuotations(t).pipe(f(this.destroy$)).subscribe({next:n=>{this.quotations=n.content.map(e=>Et(ft({},e),{showStatusDropdown:!1})),this.totalPages=n.totalPages,this.totalElements=n.totalElements,this.startIndex=this.currentPage*this.pageSize,this.endIndex=Math.min((this.currentPage+1)*this.pageSize,this.totalElements),this.isLoading=!1},error:n=>{this.snackbar.error(n.message||"Failed to load quotations"),this.isLoading=!1}})}onSearch(){this.currentPage=0,this.loadQuotations()}onPageChange(t){this.currentPage=t,this.loadQuotations()}onPageSizeChange(t){this.pageSize=t,this.currentPage=0,this.loadQuotations()}openSaleModal(t){this.selectedQuotation=t,this.modalService.open("sale")}deleteQuotation(t){confirm("Are you sure you want to delete this quotation? This action cannot be undone.")&&(this.isLoading=!0,this.quotationService.deleteQuotation(t).pipe(f(this.destroy$)).subscribe({next:()=>{this.snackbar.success("Quotation deleted successfully"),this.loadQuotations()},error:n=>{this.snackbar.error(n?.error?.message||"Failed to delete quotation"),this.isLoading=!1}}))}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}})}resetForm(){this.searchForm.reset(),this.currentPage=0,this.loadQuotations()}getStatusLabel(t){return q[t]||t}getStatusClass(t){return{Q:"status-quote",A:"status-accepted",D:"status-declined",R:"status-ready",P:"status-processing",PC:"status-packaging",C:"status-completed",I:"status-invoiced"}[t]||"status-default"}generatePdf(t,n){n&&(n.isPrinting=!0,this.quotationService.generatePdf(t).pipe(f(this.destroy$)).subscribe({next:e=>{let i=window.URL.createObjectURL(e.blob),l=document.createElement("a");l.href=i,l.download="quotation-"+n.customerName+".pdf",l.click(),window.URL.revokeObjectURL(i),n.isPrinting=!1},error:()=>{this.snackbar.error("Failed to generate PDF"),n.isPrinting=!1}}))}generateDispatchPdf(t,n){n&&(n.isPrinting=!0,this.quotationService.generateDispatchPdf(t,null).pipe(f(this.destroy$)).subscribe({next:e=>{let i=window.URL.createObjectURL(e.blob),l=document.createElement("a");l.href=i,l.download="dispatch-slip.pdf",l.click(),window.URL.revokeObjectURL(i),n.isPrinting=!1},error:()=>{this.snackbar.error("Failed to generate PDF"),n.isPrinting=!1}}))}getStatusIcon(t){return{Q:"fa-file-alt",A:"fa-check-circle",D:"fa-times-circle",R:"fa-clock",P:"fa-spinner fa-spin",PC:"fa-spinner fa-spin",C:"fa-check-double",I:"fa-file-invoice"}[t]||"fa-question-circle"}setupClickOutsideListener(){this.clickListener=t=>{document.querySelectorAll(".status-container").forEach(e=>{e.contains(t.target)||this.quotations.forEach(i=>i.showStatusDropdown=!1)})},document.addEventListener("click",this.clickListener)}toggleStatusDropdown(t){event?.stopPropagation(),this.quotations.forEach(n=>{n!==t&&(n.showStatusDropdown=!1)}),t.showStatusDropdown=!t.showStatusDropdown}canChangeStatus(t){return["D","Q","A","P","PC","C"].includes(t)}updateStatus(t,n){!t||t.isUpdating||(t.isUpdating=!0,t.showStatusDropdown=!1,this.quotationService.updateQuotationStatus(t.id,n).pipe(f(this.destroy$)).subscribe({next:()=>{t.status=n,this.snackbar.success("Status updated successfully"),t.isUpdating=!1},error:e=>{this.snackbar.error(e?.error?.message||"Failed to update status"),t.isUpdating=!1}}))}getAvailableStatusOptions(t){switch(t){case"Q":return[{label:q.A,value:"A",disabled:!1},{label:q.D,value:"D",disabled:!1}];case"A":return[{label:q.P,value:"P",disabled:!1},{label:q.D,value:"D",disabled:!1}];case"P":return[{label:q.C,value:"C",disabled:!1}];case"D":return[{label:q.A,value:"A",disabled:!1}];case"C":return[{label:q.I,value:"I",disabled:!1}];case"I":return[];default:return[]}}editQuotation(t){t&&(localStorage.setItem("editQuotationId",this.encryptionService.encrypt(t.toString())),this.router.navigate(["/quotation/create"]))}canEditQuotation(){return this.authService.isAdmin()||this.authService.isStaffAdmin()}canDispatchQuotation(){return this.authService.isStaffAdmin()||this.authService.isAdmin()}dispatchQuotation(t){t&&(localStorage.setItem("editQuotationId",this.encryptionService.encrypt(t.toString())),this.router.navigate(["/quotation/dispatch"]))}openWhatsApp(t){let n=String(t??"").replace(/\D/g,"");if(!n)return;let i=`whatsapp://send?phone=${n.length===10?`91${n}`:n}`;try{window.location.href=i}catch{}}printQuotationPdf(t,n){if(!t){this.snackbar.error("Please select quotation");return}this.isLoading=!0,n.isPrinting=!0,this.quotationService.generatePdf(t).pipe(f(this.destroy$)).subscribe({next:e=>{let i=e.blob,l=window.URL.createObjectURL(i),m=document.createElement("iframe");m.style.display="none",m.src=l,document.body.appendChild(m),m.onload=()=>{setTimeout(()=>{try{m.contentWindow?.print(),this.isLoading=!1,n.isPrinting=!1}catch{this.snackbar.error("Failed to open print dialog"),this.isLoading=!1}},1e3),setTimeout(()=>{document.body.contains(m)&&document.body.removeChild(m),window.URL.revokeObjectURL(l)},5e3)}},error:e=>{this.snackbar.error("Failed to generate dispatch quotation"),n.isPrinting=!1,this.isLoading=!1}})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.clickListener&&(document.removeEventListener("click",this.clickListener),this.clickListener=null),this.quotations=[],this.customers=[],this.products=[],this.statusOptions=[]}static{this.\u0275fac=function(n){return new(n||c)(C(nt),C(rt),C(Y),C(tt),C(Gt),C(Yt),C(Kt),C(it),C(J),C(mt))}}static{this.\u0275cmp=V({type:c,selectors:[["app-dispatch-quotation-list"]],standalone:!0,features:[L],decls:52,vars:15,consts:[[1,"quotation-container"],[3,"show"],[1,"search-section","card"],[3,"ngSubmit","formGroup"],[1,"search-controls"],[1,"form-group"],["type","text","formControlName","search","placeholder","Search by invoice number...",1,"form-control"],[1,"product-select-group"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","disabled"],[1,"fas",3,"ngClass"],["formControlName","quotationStatus","labelKey","label","valueKey","value",3,"options","multiple","defaultOption","searchPlaceholder"],["type","date","formControlName","startDate","placeholder","Start Date",1,"form-control"],["type","date","formControlName","endDate","placeholder","End Date",1,"form-control"],[1,"button-group"],["type","submit",1,"search-btn","btn","btn-sm","btn-primary"],[1,"fas","fa-search"],["type","button",1,"search-btn","btn","btn-sm","btn-secondary",3,"click"],[1,"fas","fa-undo"],[1,"quotations-list","card"],[1,"table-responsive"],[1,"table"],[4,"ngFor","ngForOf"],[3,"currentPage","pageSize","totalElements","pageSizeOptions","pageChange","pageSizeChange",4,"ngIf"],["title","Open WhatsApp",1,"btn-icon","whatsapp",3,"click"],[1,"fab","fa-whatsapp"],[1,"status-container"],[1,"status-badge",3,"ngClass"],["class","btn-icon status-change",3,"disabled","click",4,"ngIf"],["class","status-dropdown",4,"ngIf"],[1,"actions"],["class","btn-icon edit","title","Edit quotation",3,"click",4,"ngIf"],["class","btn-icon edit","title","Dispatch quotation preview",3,"click",4,"ngIf"],["class","btn-icon edit","title","Dispatch quotation",3,"click",4,"ngIf"],["class","btn-icon print","title","Print quotation",3,"disabled","click",4,"ngIf"],["class","btn-icon delete","title","Delete quotation",3,"click",4,"ngIf"],[1,"btn-icon","status-change",3,"click","disabled"],[1,"fas","fa-chevron-down"],[1,"status-dropdown"],["class","status-option",3,"disabled","click",4,"ngFor","ngForOf"],[1,"status-option",3,"click"],["title","Edit quotation",1,"btn-icon","edit",3,"click"],[1,"fas","fa-edit"],["title","Dispatch quotation preview",1,"btn-icon","edit",3,"click"],[1,"fas","fa-eye"],["title","Dispatch quotation",1,"btn-icon","edit",3,"click"],[1,"fas","fa-truck-loading"],["title","Print quotation",1,"btn-icon","print",3,"click","disabled"],["title","Delete quotation",1,"btn-icon","delete",3,"click"],[1,"fas","fa-trash"],[3,"pageChange","pageSizeChange","currentPage","pageSize","totalElements","pageSizeOptions"]],template:function(n,e){n&1&&(o(0,"div",0),d(1,"app-loader",1),o(2,"div",2)(3,"h2"),a(4,"Search Quotation"),r(),o(5,"form",3),g("ngSubmit",function(){return e.onSearch()}),o(6,"div",4)(7,"div",5),d(8,"input",6),r(),o(9,"div",5)(10,"div",7),d(11,"app-searchable-select",8),o(12,"button",9),g("click",function(){return e.refreshCustomers()}),d(13,"i",10),r()()(),o(14,"div",5)(15,"div",7),d(16,"app-searchable-select",11),r()(),o(17,"div",5),d(18,"input",12),r(),o(19,"div",5),d(20,"input",13),r(),o(21,"div",14)(22,"button",15),d(23,"i",16),a(24," Search "),r(),o(25,"button",17),g("click",function(){return e.resetForm()}),d(26,"i",18),a(27," Reset "),r()()()()(),o(28,"div",19)(29,"h2"),a(30,"Quotations"),r(),o(31,"div",20)(32,"table",21)(33,"thead")(34,"tr")(35,"th"),a(36,"No"),r(),o(37,"th"),a(38,"Invoice No."),r(),o(39,"th"),a(40,"Customer Name"),r(),o(41,"th"),a(42,"Quotation Date"),r(),o(43,"th"),a(44,"Valid Until"),r(),o(45,"th"),a(46,"Status"),r(),o(47,"th"),a(48,"Actions"),r()()(),o(49,"tbody"),M(50,Fn,28,21,"tr",22),r()()(),M(51,En,1,4,"app-pagination",23),r()()),n&2&&(s(),u("show",e.isLoading),s(4),u("formGroup",e.searchForm),s(6),u("options",e.customers)("defaultOption",X(13,On))("searchPlaceholder","Search customers..."),s(),u("disabled",e.isLoadingCustomers),s(),u("ngClass",e.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt"),s(3),u("options",e.statusOptions)("multiple",!0)("defaultOption",X(14,Mn))("searchPlaceholder","Search status..."),s(34),u("ngForOf",e.quotations),s(),u("ngIf",e.totalPages>0))},dependencies:[D,z,H,$,Vt,K,U,Z,j,R,B,G,ot,Q,gt,st,et,Ut],styles:[".quotation-container[_ngcontent-%COMP%]{padding:2rem;position:relative;min-height:200px;background-color:var(--background)}.quotation-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fff;border-radius:0;box-shadow:0 2px 4px #0000001a;margin-bottom:20px;padding:20px}.quotation-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:20px;color:var(--text-primary);font-size:1.5rem}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;align-items:flex-start}@media (max-width: 768px){.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{grid-template-columns:1fr}}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin:0;height:100%}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{height:38px;box-sizing:border-box}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;height:100%}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1;height:38px}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]     .dropdown-btn{height:38px;box-sizing:border-box;display:flex;align-items:center}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%], .quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{width:38px;height:38px;padding:0;margin-top:0!important;display:flex;align-items:center;justify-content:center;border:1px solid var(--border-color);border-radius:var(--border-radius);background:var(--primary)}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:hover:not(:disabled), .quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--primary-dark)}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:disabled, .quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;height:100%}@media (max-width: 768px){.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{grid-column:1/-1}}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;height:38px;display:flex;align-items:center;justify-content:center;gap:.5rem}.quotation-container[_ngcontent-%COMP%]   .search-section[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{vertical-align:middle}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:inline-flex;align-items:center;justify-content:center;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]{color:#ff9800;background-color:#ff98001a}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#ff9800;color:#fff;transform:translateY(-1px)}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.quotation-container[_ngcontent-%COMP%]   .quotations-list[_ngcontent-%COMP%]   .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:var(--text-secondary);white-space:nowrap}.quotation-container[_ngcontent-%COMP%]   .table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{width:auto;min-width:80px;padding:.5rem;margin-bottom:0;height:38px}@media (max-width: 768px){.quotation-container[_ngcontent-%COMP%]{padding:1rem}.quotation-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.quotation-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .quotation-container[_ngcontent-%COMP%]   .search-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}@media (max-width: 576px){.table-controls[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:flex-start}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]{width:100%}.table-controls[_ngcontent-%COMP%]   .page-size-selector[_ngcontent-%COMP%]   select.form-control[_ngcontent-%COMP%]{flex:1}}.actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;padding-bottom:20px;justify-content:flex-start}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.actions[_ngcontent-%COMP%]   .btn-icon.sale[_ngcontent-%COMP%]{color:var(--primary);background-color:#fd78231a}.actions[_ngcontent-%COMP%]   .btn-icon.sale[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon.sale[_ngcontent-%COMP%]:disabled{color:var(--text-secondary);background-color:#0000000d;cursor:not-allowed}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]{color:#dc3545;background-color:#dc35451a}.actions[_ngcontent-%COMP%]   .btn-icon.delete[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:active{transform:translateY(0)}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{padding:6px}.actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}}  .custom-snackbar.success{background-color:var(--accent2)}  .custom-snackbar.error{background-color:#dc3545}  .custom-snackbar .snackbar-message{display:flex;align-items:center;gap:.5rem;color:#fff}  .custom-snackbar .snackbar-message i{font-size:1.2rem}.loading-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffc;display:flex;justify-content:center;align-items:center;z-index:1000}.loading-overlay[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:var(--primary)}.product-select-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:flex-start}.product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]{background-color:var(--background);color:#fff;width:42px;height:35px;border-radius:6px;transition:all .2s ease}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.product-select-group[_ngcontent-%COMP%]   .btn-icon.refresh[_ngcontent-%COMP%]:active{transform:translateY(0)}.status-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:var(--border-radius);font-size:.875rem;font-weight:600;text-align:center;display:inline-flex;align-items:center;justify-content:center;min-width:120px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease;gap:.5rem}.status-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.status-badge[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 6px #00000026}.status-badge.status-quote[_ngcontent-%COMP%]{color:var(--info);border:1px solid var(--info)}.status-badge.status-accepted[_ngcontent-%COMP%]{color:var(--success);border:1px solid var(--success)}.status-badge.status-declined[_ngcontent-%COMP%]{color:var(--danger);border:1px solid var(--danger)}.status-badge.status-ready[_ngcontent-%COMP%]{color:var(--warning);border:1px solid var(--warning)}.status-badge.status-processing[_ngcontent-%COMP%]{color:var(--primary);border:1px solid var(--primary)}.status-badge.status-completed[_ngcontent-%COMP%]{color:var(--success);border:1px solid var(--success)}.status-badge.status-default[_ngcontent-%COMP%]{color:var(--gray);border:1px solid var(--gray)}.status-container[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;gap:.5rem}.status-container[_ngcontent-%COMP%]   .status-change[_ngcontent-%COMP%]{padding:4px 8px;color:var(--text-secondary);border-radius:var(--border-radius);transition:all .2s ease;background:none;border:none;cursor:pointer;z-index:1}.status-container[_ngcontent-%COMP%]   .status-change[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--background);color:var(--text-primary)}.status-container[_ngcontent-%COMP%]   .status-change[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]{position:absolute;top:calc(100% + 5px);right:0;background:#fff;border-radius:var(--border-radius);box-shadow:0 2px 8px #00000026;z-index:1000;min-width:150px;border:1px solid var(--border-color);display:block}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]   .status-option[_ngcontent-%COMP%]{padding:.75rem 1rem;display:flex;align-items:center;gap:.75rem;cursor:pointer;transition:all .2s ease}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]   .status-option[_ngcontent-%COMP%]:hover:not(.disabled){background-color:var(--background-light)}.status-container[_ngcontent-%COMP%]   .status-dropdown[_ngcontent-%COMP%]   .status-option.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}"]})}}return c})();var Dn=()=>({label:"All Products",value:""}),An=()=>({label:"All Customers",value:""});function Nn(c,b){if(c&1){let t=x();o(0,"div",4)(1,"label"),a(2,"Customer"),r(),o(3,"div",5),d(4,"app-searchable-select",18),o(5,"button",19),g("click",function(){h(t);let e=p();return _(e.refreshCustomers())})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(6,"i",8),r()()()}if(c&2){let t=p();s(4),u("options",t.customers)("defaultOption",X(5,An))("searchPlaceholder","Search customers..."),s(),u("disabled",t.isLoadingCustomers),s(),u("ngClass",t.isLoadingCustomers?"fa-spinner fa-spin":"fa-sync-alt")}}function Tn(c,b){if(c&1){let t=x();o(0,"div",28)(1,"button",29),g("click",function(){h(t);let e=p().$implicit,i=p(2);return _(i.openWhatsApp(e.contactNumber))})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(2,"i",30),r(),o(3,"button",31),g("click",function(){h(t);let e=p().$implicit,i=p(2);return _(i.makeCall(e.contactNumber))})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(4,"i",32),r()()}}function Qn(c,b){if(c&1){let t=x();o(0,"button",33),g("click",function(){h(t);let e=p().$implicit,i=p(2);return _(i.dispatchQuotation(e.quotationId))})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(1,"i",34),r()}}function Vn(c,b){if(c&1){let t=x();o(0,"tr"),d(1,"td",22),o(2,"td"),a(3),r(),o(4,"td"),a(5),r(),o(6,"td"),a(7),r(),o(8,"td"),M(9,Tn,5,0,"div",23),r(),o(10,"td"),a(11),r(),o(12,"td"),a(13),r(),o(14,"td"),a(15),r(),o(16,"td"),a(17),r(),o(18,"td",24)(19,"button",25),g("click",function(){let e=h(t).$implicit,i=p(2);return _(i.editQuotation(e.quotationId))})("touchstart",function(e){return h(t),_(e.preventDefault())}),d(20,"i",26),r(),M(21,Qn,2,0,"button",27),r()()}if(c&2){let t=b.$implicit,n=p(2);s(),u("innerHTML",n.sanitizeHtml(t.productName),Tt),s(2),y(t.quantity),s(2),y(t.pendingQuantity),s(2),y(t.customerName),s(2),u("ngIf",t.contactNumber),s(2),y(t.contactNumber),s(2),y(t.quoteNumber),s(2),y(t.quoteDate),s(2),y(t.remarks),s(4),u("ngIf",n.canDispatchQuotation())}}function Ln(c,b){if(c&1&&(o(0,"div",20)(1,"table")(2,"thead")(3,"tr")(4,"th"),a(5,"Product Name"),r(),o(6,"th"),a(7,"Quantity"),r(),o(8,"th"),a(9,"Pending Roll Qty"),r(),o(10,"th"),a(11,"Customer"),r(),d(12,"th"),o(13,"th"),a(14,"Contact"),r(),o(15,"th"),a(16,"Quote Number"),r(),o(17,"th"),a(18,"Quote Date"),r(),o(19,"th"),a(20,"Remarks"),r(),o(21,"th"),a(22,"Action"),r()()(),o(23,"tbody"),M(24,Vn,22,10,"tr",21),r()()()),c&2){let t=p();s(24),u("ngForOf",t.pendingItems)}}function zn(c,b){c&1&&(o(0,"div",35)(1,"p"),a(2,"Loading pending items..."),r()())}function $n(c,b){c&1&&(o(0,"div",36)(1,"p"),a(2,"No pending items found."),r()())}function jn(c,b){if(c&1){let t=x();o(0,"button",42),g("click",function(){let e=h(t).$implicit,i=p(2);return _(i.onPageChange(e))})("touchstart",function(e){return h(t),_(e.preventDefault())}),a(1),r()}if(c&2){let t=b.$implicit,n=p(2);k("active",t===n.currentPage),s(),w(" ",t+1," ")}}function Rn(c,b){if(c&1){let t=x();o(0,"div",37)(1,"div",38),a(2),r(),o(3,"div",39)(4,"button",40),g("click",function(){h(t);let e=p();return _(e.onPageChange(e.currentPage-1))})("touchstart",function(e){return h(t),_(e.preventDefault())}),a(5," Previous "),r(),M(6,jn,2,3,"button",41),o(7,"button",40),g("click",function(){h(t);let e=p();return _(e.onPageChange(e.currentPage+1))})("touchstart",function(e){return h(t),_(e.preventDefault())}),a(8," Next "),r()()()}if(c&2){let t=p();s(2),Qt(" Showing ",t.currentPage+1," of ",t.totalPages," pages (",t.totalItems," total items) "),s(2),u("disabled",t.currentPage===0),s(2),u("ngForOf",t.getPageNumbers()),s(),u("disabled",t.currentPage===t.totalPages-1)}}var te=(()=>{class c{constructor(t,n,e,i,l,m,O,S,v){this.fb=t,this.quotationService=n,this.customerService=e,this.productService=i,this.encryptionService=l,this.snackbar=m,this.router=O,this.sanitizer=S,this.authService=v,this.pendingItems=[],this.currentPage=0,this.totalPages=0,this.totalItems=0,this.perPageRecord=10,this.loading=!1,this.customers=[],this.isLoadingCustomers=!1,this.products=[],this.isLoadingProducts=!1,this.isDealerUser=!1,this.destroy$=new W,this.searchForm=this.fb.group({productId:[""],customerId:[""]})}ngOnInit(){this.isDealerUser=this.authService.hasRole(pt.DEALER),this.loadPendingItems(),this.loadProducts(),this.isDealerUser||this.loadCustomers()}loadPendingItems(t=0){this.loading=!0,this.currentPage=t;let n=this.searchForm.value,e={customerId:n.customerId?Number(n.customerId):void 0,productId:n.productId?Number(n.productId):void 0,page:t,size:this.perPageRecord,sortBy:"id",sortDir:"desc"};this.quotationService.searchPendingItems(e).pipe(f(this.destroy$)).subscribe({next:i=>{i.success&&i.data?(this.pendingItems=i.data.content,this.totalPages=i.data.totalPages,this.totalItems=i.data.totalElements):(this.snackbar.error(i.message||"Failed to load pending items"),this.pendingItems=[]),this.loading=!1},error:i=>{console.error("Error loading pending items:",i),this.snackbar.error("Failed to load pending items"),this.loading=!1,this.pendingItems=[]}})}loadCustomers(){this.isLoadingCustomers=!0,this.customerService.getCustomers({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to load customers"),this.isLoadingCustomers=!1}})}loadProducts(){this.isLoadingProducts=!0,this.productService.getProducts({status:"A"}).pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data),this.isLoadingProducts=!1},error:t=>{this.snackbar.error("Failed to load products"),this.isLoadingProducts=!1}})}refreshCustomers(){this.isLoadingCustomers=!0,this.customerService.refreshCustomers().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.customers=t.data,this.snackbar.success("Customers refreshed successfully")),this.isLoadingCustomers=!1},error:t=>{this.snackbar.error("Failed to refresh customers"),this.isLoadingCustomers=!1}})}refreshProducts(){this.isLoadingProducts=!0,this.productService.refreshProducts().pipe(f(this.destroy$)).subscribe({next:t=>{t.success&&(this.products=t.data,this.snackbar.success("Products refreshed successfully")),this.isLoadingProducts=!1},error:t=>{this.snackbar.error("Failed to refresh products"),this.isLoadingProducts=!1}})}onSubmit(t){t&&(t.preventDefault(),t.stopPropagation()),this.loadPendingItems(0)}resetForm(){this.searchForm.reset({productId:"",customerId:""}),this.loadPendingItems(0)}onPageChange(t){this.loadPendingItems(t)}editQuotation(t){if(!t)return;let n=this.encryptionService.encrypt(t.toString());this.router.navigate(["/quotation/edit",n])}canDispatchQuotation(){return this.authService.isAdmin()||this.authService.isStaffAdmin()}dispatchQuotation(t){t&&(localStorage.setItem("editQuotationId",this.encryptionService.encrypt(t.toString())),this.router.navigate(["/quotation/dispatch"]))}getPageNumbers(){let t=[];if(this.totalPages<=5)for(let e=0;e<this.totalPages;e++)t.push(e);else{let e=Math.max(0,Math.min(this.currentPage-2,this.totalPages-5)),i=Math.min(this.totalPages,e+5);for(let l=e;l<i;l++)t.push(l)}return t}openWhatsApp(t){let n=String(t??"").replace(/\D/g,"");if(!n)return;let i=`whatsapp://send?phone=${n.length===10?`91${n}`:n}`;try{window.location.href=i}catch{}}makeCall(t){let n=String(t??"").replace(/\D/g,"");if(!n)return;let e=`tel:+91${n}`;try{window.location.href=e}catch{}}sanitizeHtml(t){return this.sanitizer.bypassSecurityTrustHtml(t)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.pendingItems=[],this.customers=[],this.products=[]}static{this.\u0275fac=function(n){return new(n||c)(C(Y),C(nt),C(rt),C(ct),C(it),C(tt),C(J),C(zt),C(mt))}}static{this.\u0275cmp=V({type:c,selectors:[["app-pending-item"]],standalone:!0,features:[L],decls:24,vars:14,consts:[[1,"pending-item-container"],[1,"header"],[1,"search-card"],[1,"search-form",3,"ngSubmit","formGroup"],[1,"form-group"],[1,"product-select-group"],["formControlName","productId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Products",1,"btn","btn-sm","btn-primary","refresh",3,"click","touchstart","disabled"],[1,"fas",3,"ngClass"],["class","form-group",4,"ngIf"],[1,"buttons"],["type","button",1,"btn","btn-secondary",3,"click","touchstart"],["type","button",1,"btn","btn-primary",3,"click","touchstart","disabled"],[1,"results-card"],["class","table-container",4,"ngIf"],["class","loading",4,"ngIf"],["class","no-results",4,"ngIf"],["class","pagination",4,"ngIf"],["formControlName","customerId","labelKey","name","valueKey","id",3,"options","defaultOption","searchPlaceholder"],["type","button","title","Refresh Customers",1,"btn","btn-sm","btn-primary","refresh",2,"margin-top","3px",3,"click","touchstart","disabled"],[1,"table-container"],[4,"ngFor","ngForOf"],[3,"innerHTML"],["style","display: flex; gap: 0.5rem;",4,"ngIf"],[1,"action-cell"],["title","Edit quotation",1,"btn-icon","edit",3,"click","touchstart"],[1,"fas","fa-edit"],["class","btn-icon dispatch","title","Dispatch quotation",3,"click","touchstart",4,"ngIf"],[2,"display","flex","gap","0.5rem"],["title","Open WhatsApp",1,"btn-icon","whatsapp",3,"click","touchstart"],[1,"fab","fa-whatsapp"],["title","Call",1,"btn-icon","call",3,"click","touchstart"],[1,"fas","fa-phone"],["title","Dispatch quotation",1,"btn-icon","dispatch",3,"click","touchstart"],[1,"fas","fa-truck-loading"],[1,"loading"],[1,"no-results"],[1,"pagination"],[1,"page-info"],[1,"pagination-controls"],[1,"page-button",3,"click","touchstart","disabled"],["class","page-button",3,"active","click","touchstart",4,"ngFor","ngForOf"],[1,"page-button",3,"click","touchstart"]],template:function(n,e){n&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),a(3,"Pending Items"),r()(),o(4,"div",2)(5,"form",3),g("ngSubmit",function(l){return e.onSubmit(l)}),o(6,"div",4)(7,"label"),a(8,"Product"),r(),o(9,"div",5),d(10,"app-searchable-select",6),o(11,"button",7),g("click",function(){return e.refreshProducts()})("touchstart",function(l){return l.preventDefault()}),d(12,"i",8),r()()(),M(13,Nn,7,6,"div",9),r(),o(14,"div",10)(15,"button",11),g("click",function(){return e.resetForm()})("touchstart",function(l){return l.preventDefault()}),a(16,"Reset"),r(),o(17,"button",12),g("click",function(l){return e.onSubmit(l)})("touchstart",function(l){return l.preventDefault()}),a(18),r()()(),o(19,"div",13),M(20,Ln,25,1,"div",14)(21,zn,3,0,"div",15)(22,$n,3,0,"div",16)(23,Rn,9,6,"div",17),r()()),n&2&&(s(5),u("formGroup",e.searchForm),s(5),u("options",e.products)("defaultOption",X(13,Dn))("searchPlaceholder","Search products..."),s(),u("disabled",e.isLoadingProducts),s(),u("ngClass",e.isLoadingProducts?"fa-spinner fa-spin":"fa-sync-alt"),s(),u("ngIf",!e.isDealerUser),s(4),u("disabled",e.loading),s(),w(" ",e.loading?"Searching...":"Search"," "),s(2),u("ngIf",!e.loading&&e.pendingItems.length>0),s(),u("ngIf",e.loading),s(),u("ngIf",!e.loading&&e.pendingItems.length===0),s(),u("ngIf",!e.loading&&e.pendingItems.length>0&&e.totalPages>1))},dependencies:[D,z,H,$,K,U,j,R,B,G,ot,Q,et],styles:["[_ngcontent-%COMP%]:root{--primary: #003a58;--primary-light: #2a5f79;--primary-lighter: #4f7f94;--primary-lightest: #a6c0cd;--primary-dark: #00263a;--secondary: #00999c;--secondary-light: #26b3b5;--secondary-lighter: #6bcfd1;--secondary-lightest: #b9ebec;--secondary-dark: #007275;--neutral-dark: #3b4248;--neutral-medium: #8a949c;--neutral-light: #b3bcc2;--neutral-lighter: #d7dee2;--neutral-lightest: #f4f7f9;--accent: #264b55;--success: #1e9e68;--warning: #c98200;--error: #c23b3b;--info: #2aa6c2;--background: #f4f7f9;--text-primary: #3b4248;--text-secondary: #8a949c;--supporting: #b3bcc2}.pending-item-container[_ngcontent-%COMP%]{padding:20px;background-color:var(--background);min-height:100vh}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;flex-wrap:wrap;gap:10px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--primary);margin:0}.header[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;gap:10px}.search-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:20px;margin-bottom:20px}.search-form[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:15px;margin-bottom:20px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-bottom:5px;font-weight:500;color:var(--text-primary)}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px;border:1px solid var(--supporting);border-radius:4px;font-size:14px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--primary)}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .checkbox-group[_ngcontent-%COMP%]   .checkbox-item[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:auto}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]{display:flex;gap:8px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   app-searchable-select[_ngcontent-%COMP%]{flex:1}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{width:33px;height:33px;display:flex;justify-content:center;align-items:center;padding:0;min-width:auto}.buttons[_ngcontent-%COMP%]{display:flex;gap:10px;justify-content:flex-end}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:4px;cursor:pointer;transition:all .3s ease;font-weight:500;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#001825}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.buttons[_ngcontent-%COMP%]   .btn.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]{background-color:var(--secondary);color:#fff}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#006769}.buttons[_ngcontent-%COMP%]   .btn.btn-secondary[_ngcontent-%COMP%]:active:not(:disabled){transform:scale(.98)}.results-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:20px;overflow-x:auto}.table-container[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1rem;background-color:#fff;box-shadow:0 2px 4px #0000001a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid var(--supporting)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{background:none;border:none;padding:8px;cursor:pointer;border-radius:6px;transition:all .2s ease;display:inline-flex;align-items:center;justify-content:center;touch-action:manipulation;-webkit-tap-highlight-color:transparent}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]{color:#25d366;background-color:#25d3661a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:hover:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#25d366;color:#fff;transform:translateY(-1px)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:active:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.whatsapp[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]{color:#007bff;background-color:#007bff1a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:hover:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#007bff;color:#fff;transform:translateY(-1px)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:active:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.call[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]{color:var(--primary);background-color:#1458811a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:hover:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:hover:not(:disabled){background-color:var(--primary);color:#fff;transform:translateY(-1px)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:active:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]{color:#ff9800;background-color:#ff98001a}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:hover:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#ff9800;color:#fff;transform:translateY(-1px)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:active:not(:disabled), table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.dispatch[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@media (max-width: 768px){table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:14px}}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:var(--secondary);color:#fff;font-weight:600;position:sticky;top:0;z-index:10}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#aec6cf1a}table[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:4px;font-size:12px;font-weight:500;display:inline-block}table[_ngcontent-%COMP%]   .status-badge.status-o[_ngcontent-%COMP%]{background-color:#ffecb3;color:#ff9800}table[_ngcontent-%COMP%]   .status-badge.status-ip[_ngcontent-%COMP%]{background-color:#bbdefb;color:#2196f3}table[_ngcontent-%COMP%]   .status-badge.status-c[_ngcontent-%COMP%]{background-color:#c8e6c9;color:#4caf50}table[_ngcontent-%COMP%]   .status-badge.status-b[_ngcontent-%COMP%]{background-color:#e1bee7;color:#9c27b0}table[_ngcontent-%COMP%]   .action-cell[_ngcontent-%COMP%]{white-space:nowrap;display:flex;gap:.5rem;align-items:center}table[_ngcontent-%COMP%]   .action-cell[_ngcontent-%COMP%]   .edit-link[_ngcontent-%COMP%]{color:var(--primary);text-decoration:none;font-weight:500;cursor:pointer}table[_ngcontent-%COMP%]   .action-cell[_ngcontent-%COMP%]   .edit-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:10px;margin-top:20px;flex-wrap:wrap}.pagination[_ngcontent-%COMP%]   .page-info[_ngcontent-%COMP%]{font-size:14px;color:var(--text-secondary)}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]{display:flex;gap:5px;flex-wrap:wrap}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid var(--supporting);background-color:#fff;border-radius:4px;cursor:pointer;transition:all .3s ease;touch-action:manipulation;-webkit-tap-highlight-color:transparent}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button[_ngcontent-%COMP%]:hover:not(.disabled):not(.active){background-color:var(--primary);color:#fff}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button.active[_ngcontent-%COMP%]{background-color:var(--primary);color:#fff}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button.disabled[_ngcontent-%COMP%]{opacity:.5;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   .pagination-controls[_ngcontent-%COMP%]   .page-button[_ngcontent-%COMP%]:active:not(.disabled){transform:scale(.95)}.loading[_ngcontent-%COMP%]{text-align:center;padding:20px;color:var(--text-secondary)}.no-results[_ngcontent-%COMP%]{text-align:center;padding:40px 20px;color:var(--text-secondary)}.no-results[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}@media (max-width: 768px){.pending-item-container[_ngcontent-%COMP%]{padding:15px}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-card[_ngcontent-%COMP%]{padding:15px}.buttons[_ngcontent-%COMP%]{flex-direction:column}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}.results-card[_ngcontent-%COMP%]{padding:15px}.table-container[_ngcontent-%COMP%]{font-size:14px;overflow-x:auto;-webkit-overflow-scrolling:touch}table[_ngcontent-%COMP%]{min-width:800px}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 5px;white-space:nowrap}.pagination[_ngcontent-%COMP%]{flex-direction:column;gap:15px}}@media (max-width: 576px){.search-form[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-group[_ngcontent-%COMP%]{margin-bottom:10px}.product-select-group[_ngcontent-%COMP%]{flex-direction:column}.product-select-group[_ngcontent-%COMP%]   .refresh[_ngcontent-%COMP%]{align-self:flex-start}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px;padding:6px 4px}}@media (hover: none) and (pointer: coarse){.btn[_ngcontent-%COMP%], .btn-icon[_ngcontent-%COMP%], .page-button[_ngcontent-%COMP%]{min-height:44px;min-width:44px}.search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .search-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{font-size:16px}}"]})}}return c})();var Un=[{path:"",component:Xt},{path:"create",component:Ft},{path:"edit/:id",component:Ft},{path:"dealer-order",component:Jt},{path:"order",component:Zt},{path:"dispatch",component:Me},{path:"dispatch-list",component:xe},{path:"pending-item",component:te}],ve=(()=>{class c{static{this.\u0275fac=function(n){return new(n||c)}}static{this.\u0275mod=Nt({type:c})}static{this.\u0275inj=At({imports:[Q.forChild(Un),Q]})}}return c})();var Gi=(()=>{class c{static{this.\u0275fac=function(n){return new(n||c)}}static{this.\u0275mod=Nt({type:c})}static{this.\u0275inj=At({imports:[D,ve,Xt,Ft,Jt,Zt,te]})}}return c})();export{Gi as QuotationModule};
